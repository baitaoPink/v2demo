import{ap as a,r as e,aq as t,ar as s,as as l,at as o,au as r,av as u,aw as i,w as c,_ as n,d,p as m,h as f,n as p,o as v,f as _,a1 as h,a2 as k,i as g,t as y,v as x,e as w,A as j,F as C,s as b,K as q,L as $,Z as S,$ as V,E as H}from"./index-B2xpwpwA.js";import{_ as I}from"./qt-stock-search-bar.CL6EF3yH.js";import{a as L,r as T}from"./uni-app.es.DSnRb9Bl.js";import{_ as U}from"./wd-icon.av9Pe6hJ.js";import{_ as W,Q as A}from"./qt-stock-item.B3abyoHJ.js";import{_ as E}from"./wd-gap.BTJcE1Vl.js";import{_ as F}from"./wd-popup.DoF1ewYn.js";import{_ as K}from"./wd-config-provider.vue_vue_type_script_setup_true_lang.Y-Vfny-m.js";import{_ as M}from"./qt-empty.BsLSxMD7.js";import{s as N}from"./stock.u3bnR5-q.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./wd-search.4Oc0qSW8.js";import"./props.3mmIwxF7.js";import"./useTranslate.CisUcI6B.js";import"./search.Dmwp9ldp.js";import"./tick.DzZJUBoq.js";const Q=a("stockSearchHistory",(()=>{const a=e(t(s)||[]);return{searchHistory:a,add:function(e){const t=a.value;e&&-1===t.findIndex((a=>a.code===e.code))&&(8===a.value.length&&a.value.pop(),a.value.unshift(e),l(s,a.value))},clear:function(){l(s,a.value=[])}}})),Y=P({__name:"market-search",setup(a){const t=Q(),s=e(!1),l=e(!1),P=e([]),Y=e(0),Z=e([]),z=e(""),B="historyShow",D="loadingShow",G="dataShow",J=e(B);async function O(){if(!s.value){s.value=!0,setTimeout((()=>{s.value=!1}),500);const a=z.value;if(!a)return void(J.value=B);J.value=D,await S({title:"Loading..."});const e=await N({search:a,region:P.value[Y.value].market_type});Z.value=e.India,V()}}function R(){t.clear()}return o((()=>{r(),u((function(){r()})),i((function(){console.log("WebSocket 已关闭！")}))})),c(z,(()=>{Z.value=[],O()})),c(Y,(()=>{O(),l.value=!1})),L((()=>{n({}).then((a=>{P.value=a.data}))})),(a,e)=>{const s=T(d("qt-stock-search-bar"),I),o=T(d("wd-icon"),U),r=p,u=H,i=T(d("qt-icon-tick"),W),c=T(d("wd-gap"),E),n=T(d("wd-popup"),F),S=T(d("wd-config-provider"),K),V=T(d("qt-empty"),M);return v(),m(r,{class:"plr-32 pt-20"},{default:f((()=>[_(s,{onClickSuffix:e[0]||(e[0]=a=>l.value=!0),"suffix-text":P.value[Y.value]?P.value[Y.value].name:"","suffix-icon-rotate":l.value,focus:!0,modelValue:z.value,"onUpdate:modelValue":e[1]||(e[1]=a=>z.value=a)},null,8,["suffix-text","suffix-icon-rotate","modelValue"]),h(_(r,{class:"search-history"},{default:f((()=>[_(r,{class:"search-history-title"},{default:f((()=>[y(x(a.$t("recent.search"))+" ",1),_(o,{name:"clear",onClick:R})])),_:1}),_(r,{class:"search-history-content"},{default:f((()=>[(v(!0),w(C,null,j(g(t).searchHistory,(a=>(v(),m(r,{class:"search-history-item",key:a,onClick:e=>g(q)(a)},{default:f((()=>[_(r,{class:"text-white-12 ellipsis-1"},{default:f((()=>[y(x(a.name),1)])),_:2},1024),_(r,{class:"text-gray-12 mt-6"},{default:f((()=>[y(x(a.code),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},512),[[k,J.value===B&&g(t).searchHistory.length]]),h(_(r,null,{default:f((()=>[_(r,{class:"flex items-center text-gray-12 mt-23 mb-50 mt-44"},{default:f((()=>[_(r,{class:"flex-grow"},{default:f((()=>[y(x(a.$t("stock.name")),1)])),_:1}),_(r,null,{default:f((()=>[y(x(a.$t("stock.latestPrice")),1)])),_:1}),_(r,{style:{width:"140rpx","margin-left":"50rpx","text-align":"right"}},{default:f((()=>[y(x(a.$t("stock.priceChange")),1)])),_:1})])),_:1})])),_:1},512),[[k,J.value===D||J.value===G]]),(v(!0),w(C,null,j(Z.value,(a=>(v(),m(A,{class:$({"mb-50":!0}),key:a.code,data:a,onClick:e=>function(a){const e={code:a.code,name:a.name,region:a.region};t.add(e),q(e)}(a)},null,8,["data","onClick"])))),128)),_(S,{theme:"dark"},{default:f((()=>[_(n,{position:"bottom",modelValue:l.value,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value=a)},{default:f((()=>[(v(!0),w(C,null,j(P.value,((e,t)=>(v(),w(C,{key:e.label},[_(r,{class:"options-item",onClick:a=>Y.value=t},{default:f((()=>[_(r,{class:"text-white-14"},{default:f((()=>[y(x(e.name)+" ",1),Y.value===t?(v(),m(u,{key:0},{default:f((()=>[y("("+x(a.$t("transfer.default"))+")",1)])),_:1})):b("",!0)])),_:2},1024),Y.value===t?(v(),m(i,{key:0,class:"ml-auto"})):b("",!0)])),_:2},1032,["onClick"]),_(c,{"bg-color":"#262627",height:"1rpx"})],64)))),128))])),_:1},8,["modelValue"])])),_:1}),0==Z.value.length?(v(),m(V,{key:0,class:"mt-100"})):b("",!0)])),_:1})}}},[["__scopeId","data-v-83824775"]]);export{Y as default};
