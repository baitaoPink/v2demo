import{r as a,aA as e,aw as s,at as t,di as l,d as o,p as c,h as n,n as u,o as r,f as i,t as d,v as p,e as f,A as g,F as m,s as _,D as h,i as v,K as k,Q as j,R as y,X as $,E as x}from"./index-B2xpwpwA.js";import{_ as b}from"./wd-search.4Oc0qSW8.js";import{d as w,r as R}from"./uni-app.es.DSnRb9Bl.js";import{_ as C}from"./qt-pages-empty.DkxAzhff.js";import{_ as I}from"./search.Dmwp9ldp.js";import{s as N}from"./websocket.DmqA3gwv.js";import{j as S}from"./stock.u3bnR5-q.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./wd-icon.av9Pe6hJ.js";import"./props.3mmIwxF7.js";import"./useTranslate.CisUcI6B.js";const A=U({__name:"stock-collection",setup(U){const A=window.__RUNTIME_CONFIG__.avatarURL,M=a(1),V=a(20),q=a(""),E=a(""),F=a([]);function G({value:a}){E.value="",M.value=1,F.value=[],H(a)}function H(a){l({name:a,page:M.value,limit:V.value}).then((a=>{var e;a.data.length&&(E.value?E.value=E.value+","+a.data.map((a=>a.stock_code)).join(","):E.value=a.data.map((a=>a.stock_code)).join(","),a.data.length>0&&(S({Code:E.value}).then((a=>{1===M.value?F.value=a:F.value=[...F.value,...a]})),e=E.value,N.sendMessage(e,(a=>{const e=JSON.parse(a.data);for(let s=0;s<F.value.length;s++)F.value[s].code===e.code&&(e.latest&&(F.value[s].latest=e.latest),e.changeRatio&&(F.value[s].changeRatio=e.changeRatio))}))))}))}return w((()=>{M.value=M.value+1,H(q.value)})),e((()=>{console.log(`${A}ping-an.svg`)})),s((function(){console.log("WebSocket 已关闭！")})),t((()=>{})),H(""),(a,e)=>{const s=h,t=R(o("wd-search"),b),l=u,w=x,N=R(o("qt-pages-empty"),C);return r(),c(l,null,{default:n((()=>[i(l,{class:"search"},{default:n((()=>[i(t,{"custom-class":"search-wrapper",modelValue:q.value,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value=a),onChange:G,"hide-cancel":!0,placeholder:a.$t("search.stocks"),"placeholder-left":""},{prefix:n((()=>[i(s,{src:I,alt:"",class:"search-icon"})])),suffix:n((()=>[])),_:1},8,["modelValue","placeholder"])])),_:1}),i(l,{class:"title"},{default:n((()=>[i(l,{class:"title-left"},{default:n((()=>[d(p(a.$t("stock.name")),1)])),_:1}),i(l,{class:"title-center"},{default:n((()=>[d(p(a.$t("stock.latestPrice")),1)])),_:1}),i(l,{class:"title-right"},{default:n((()=>[d(p(a.$t("stock.priceChange")),1)])),_:1})])),_:1}),i(l,{class:"list"},{default:n((()=>[(r(!0),f(m,null,g(F.value,((e,t)=>(r(),c(l,{class:"list-content",key:t,onClick:a=>v(k)({code:e.code,name:e.name,region:e.region})},{default:n((()=>[i(l,{class:"list-left"},{default:n((()=>[i(s,{src:`${v(A)}${e.logoId}.svg`},null,8,["src"]),i(l,{class:"box"},{default:n((()=>[i(w,null,{default:n((()=>[d(p(e.name),1)])),_:2},1024),i(w,{class:"name"},{default:n((()=>[d(p(e.code),1)])),_:2},1024)])),_:2},1024),""===e.region?(r(),c(l,{key:0,class:"box-right"},{default:n((()=>[d(p(a.$t("page.global")),1)])),_:1})):"CHN"===e.region?(r(),c(l,{key:1,class:"box-right"},{default:n((()=>[d(p(a.$t("stock.a")),1)])),_:1})):"USA"===e.region?(r(),c(l,{key:2,class:"box-right"},{default:n((()=>[d(p(a.$t("stock.us")),1)])),_:1})):"HKG"===e.region?(r(),c(l,{key:3,class:"box-right"},{default:n((()=>[d(p(a.$t("stock.hk")),1)])),_:1})):_("",!0)])),_:2},1024),i(l,{class:"text-28",style:j({color:v(y)(e.changeRatio<0?"down":"up")})},{default:n((()=>[d(p(e.latest),1)])),_:2},1032,["style"]),i(l,{class:"change",style:j({"background-color":v(y)(e.changeRatio<0?"down":"up")})},{default:n((()=>[d(p(v($)(e.changeRatio)),1)])),_:2},1032,["style"])])),_:2},1032,["onClick"])))),128))])),_:1}),0===F.value.length?(r(),c(N,{key:0,status:"empty"})):_("",!0)])),_:1})}}},[["__scopeId","data-v-40bf09dd"]]);export{A as default};
