import{aI as e,r as t,w as a,o as s,p as n,h as o,f as l,L as i,Q as c,t as u,v as d,s as p,e as r,F as m,A as _,T as f,n as h,bi as y,D as g,Y as w,cf as I,u as k,d as b,cg as v,ch as C,ae as A}from"./index-B2xpwpwA.js";import{_ as x}from"./wd-popup.DoF1ewYn.js";import{_ as S}from"./wd-icon.av9Pe6hJ.js";import{w as T}from"./wd-loading.COtG1mNE.js";import{b as E,m as N,d as R,u as O,c as L,p as P,D as B}from"./props.3mmIwxF7.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as U}from"./uni-app.es.DSnRb9Bl.js";const j=D(e({name:"wd-action-sheet",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...E,customHeaderClass:N(""),modelValue:{...R(!1),...O(Boolean)},actions:L(),panels:L(),title:String,cancelText:String,closeOnClickAction:R(!0),closeOnClickModal:R(!0),duration:P(200),zIndex:P(10),lazyRender:R(!0),safeAreaInsetBottom:R(!0)},emits:["select","click-modal","cancel","closed","close","open","opened","update:modelValue"],setup(e,{emit:w}){const I=e,k=w,b=t([]),v=t(!1);function C(){return I.panels.length&&!B(I.panels[0])}function A(e,t,a){if("action"===t){if(I.actions[e].disabled||I.actions[e].loading)return;k("select",{item:I.actions[e],index:e})}else C()?k("select",{item:I.panels[Number(a)],index:a}):k("select",{item:I.panels[e][Number(a)],rowIndex:e,colIndex:a});R()}function E(){k("click-modal")}function N(){k("cancel"),R()}function R(){k("update:modelValue",!1),k("close")}function O(){k("open")}function L(){k("opened")}function P(){k("closed")}return a((()=>I.panels),(function(){b.value=C()?[I.panels]:I.panels}),{deep:!0,immediate:!0}),a((()=>I.modelValue),(e=>{v.value=e}),{deep:!0,immediate:!0}),(e,t)=>{const a=h,w=y,I=g;return s(),n(a,null,{default:o((()=>[l(x,{"custom-class":"wd-action-sheet__popup","custom-style":""+(e.actions&&e.actions.length||e.panels&&e.panels.length?"background: transparent;":""),modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e),duration:e.duration,position:"bottom","close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"lazy-render":e.lazyRender,onEnter:O,onClose:R,onAfterEnter:L,onAfterLeave:P,onClickModal:E,"z-index":e.zIndex},{default:o((()=>[l(a,{class:i(`wd-action-sheet ${e.customClass}`),style:c(`${e.actions&&e.actions.length||e.panels&&e.panels.length?"margin: 0 10px calc(var(--window-bottom) + 10px) 10px; border-radius: 16px;":"margin-bottom: var(--window-bottom);"} ${e.customStyle}`)},{default:o((()=>[e.title?(s(),n(a,{key:0,class:i(`wd-action-sheet__header ${e.customHeaderClass}`)},{default:o((()=>[u(d(e.title)+" ",1),l(S,{"custom-class":"wd-action-sheet__close",name:"add",onClick:R})])),_:1},8,["class"])):p("",!0),e.actions&&e.actions.length?(s(),n(a,{key:1,class:"wd-action-sheet__actions"},{default:o((()=>[(s(!0),r(m,null,_(e.actions,((e,t)=>(s(),n(w,{key:t,class:i(`wd-action-sheet__action ${e.disabled?"wd-action-sheet__action--disabled":""}  ${e.loading?"wd-action-sheet__action--loading":""}`),style:c(`color: ${e.color}`),onClick:e=>A(t,"action")},{default:o((()=>[e.loading?(s(),n(T,{key:0,"custom-class":"`wd-action-sheet__action-loading"})):(s(),n(a,{key:1,class:"wd-action-sheet__name"},{default:o((()=>[u(d(e.name),1)])),_:2},1024)),!e.loading&&e.subname?(s(),n(a,{key:2,class:"wd-action-sheet__subname"},{default:o((()=>[u(d(e.subname),1)])),_:2},1024)):p("",!0)])),_:2},1032,["class","style","onClick"])))),128))])),_:1})):p("",!0),b.value&&b.value.length?(s(),n(a,{key:2},{default:o((()=>[(s(!0),r(m,null,_(b.value,((e,t)=>(s(),n(a,{key:t,class:"wd-action-sheet__panels"},{default:o((()=>[l(a,{class:"wd-action-sheet__panels-content"},{default:o((()=>[(s(!0),r(m,null,_(e,((e,i)=>(s(),n(a,{key:i,class:"wd-action-sheet__panel",onClick:e=>A(t,"panels",i)},{default:o((()=>[l(I,{class:"wd-action-sheet__panel-img",src:e.iconUrl},null,8,["src"]),l(a,{class:"wd-action-sheet__panel-title"},{default:o((()=>[u(d(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})):p("",!0),f(e.$slots,"default",{},void 0,!0),e.cancelText?(s(),n(w,{key:3,class:"wd-action-sheet__cancel",onClick:N},{default:o((()=>[u(d(e.cancelText),1)])),_:1})):p("",!0)])),_:3},8,["class","style"])])),_:3},8,["custom-style","modelValue","duration","close-on-click-modal","safe-area-inset-bottom","lazy-render","z-index"])])),_:3})}}}),[["__scopeId","data-v-fad7cd3c"]]);const V=D({name:"auth-popup",props:{animation:{type:Boolean,default:!0},type:{type:String,default:"top"},show:{type:Boolean,default:!0},isNativeHead:{type:Boolean,default:!0},permissionID:{type:[String,Number],default:""},showPopupBox:{type:Boolean,default:!0}},data:()=>({ani:"",showPopup:!1,StatusBar:"",refuseNum:"",authList:{WRITE_EXTERNAL_STORAGE:{title:w("auth.album_tip"),content:w("auth.album_content")},ACCESS_FINE_LOCATION:{title:w("auth.location_tip"),content:w("auth.location_content")},CAMERA:{title:w("auth.camera_tip"),content:w("auth.camera_content")},RECORD_AUDIO:{title:w("auth.audio_tip"),content:w("auth.audio_content")},CALL_PHONE:{title:w("auth.phone_tip"),content:w("auth.phone_content")}}}),created(){},methods:{getSystemInfo(){let e=this;I({success:function(t){e.StatusBar=t.statusBarHeight+"px"}})},open(){this.requestPermissions(this.permissionID)},close(){this.ani="",this.$nextTick((()=>{setTimeout((()=>{this.showPopup=!1}),300)}))},requestPermissions(e){},goSetting(){if("iOS"==plus.os.name){var e=plus.ios.import("UIApplication").sharedApplication(),t=plus.ios.import("NSURL"),a=t.URLWithString("app-settings:");e.openURL(a),plus.ios.deleteObject(a),plus.ios.deleteObject(t),plus.ios.deleteObject(e)}else{var s=plus.android.importClass("android.content.Intent"),n=plus.android.importClass("android.provider.Settings"),o=plus.android.importClass("android.net.Uri"),l=plus.android.runtimeMainActivity(),i=new s;i.setAction(n.ACTION_APPLICATION_DETAILS_SETTINGS);var c=o.fromParts("package",l.getPackageName(),null);i.setData(c),l.startActivity(i)}}}},[["render",function(e,t,a,r,m,_){const f=h;return m.showPopup&&a.showPopupBox?(s(),n(f,{key:0,class:"uni-popup",style:c({top:a.isNativeHead?"":m.StatusBar})},{default:o((()=>[l(f,{class:i([[a.type,m.ani,a.animation?"ani":""],"uni-custom uni-popup__wrapper"]),onClick:t[0]||(t[0]=e=>_.close(!0))},{default:o((()=>[l(f,{class:"uni-popup__wrapper-box"},{default:o((()=>[l(f,{class:"title"},{default:o((()=>[u(d(m.authList[a.permissionID].title),1)])),_:1}),l(f,{class:"content"},{default:o((()=>[u(d(m.authList[a.permissionID].content),1)])),_:1})])),_:1})])),_:1},8,["class"])])),_:1},8,["style"])):p("",!0)}],["__scopeId","data-v-7f427917"]]),$={__name:"qt-upload",emits:["uploadImg"],setup(e,{expose:a,emit:i}){const c=window.__RUNTIME_CONFIG__.baseURL,{t:u}=k(),d=t(c),p=t(!1),r=t(null),m=t(null),_=t([{name:u("auth.album")},{name:u("auth.camera")},{name:u("auth.cancel")}]),f=i;function y(e){p.value=!1}function g(e){v({sourceType:e,success:e=>{const t=e.tempFilePaths;C({url:d.value+"/system/config/upload",filePath:t[0],name:"file",formData:{user:"test"},success:e=>{let t=JSON.parse(e.data);t.data&&t.data.url?f("uploadImg",t.data):A({title:t.msg,icon:"none"})}})}})}return a({uploading:function(){g(["album"])}}),(e,t)=>{const a=U(b("wd-action-sheet"),j),i=h;return s(),n(i,null,{default:o((()=>[l(V,{"is-native-head":"",ref_key:"cameraRef",ref:r,type:"top",onChangeAuth:t[0]||(t[0]=e=>g(["camera"])),permissionID:"CAMERA"},null,512),l(V,{"is-native-head":"",ref_key:"albumRef",ref:m,type:"top",onChangeAuth:t[1]||(t[1]=e=>g(["album"])),permissionID:"WRITE_EXTERNAL_STORAGE"},null,512),l(a,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),actions:_.value,onSelect:y},null,8,["modelValue","actions"])])),_:1})}}};export{$ as _};
