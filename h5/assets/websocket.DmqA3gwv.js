import{aq as o,bT as e,bU as n,av as s,bV as c,aw as t,bW as l,bX as a,au as i}from"./index-B2xpwpwA.js";const r=window.__RUNTIME_CONFIG__.devStockBaseURL;let u=o(e),b=encodeURIComponent(u),f=null,k=!1,d=[];function g(o,e){f=n({url:`${r}stock/tick?token=${b}`}),s((function(){console.log("WebSocket连接已打开！"),k=!0,S(d)})),c((function(o){e&&e(o)})),t((()=>{console.log("WebSocket 已关闭"),f=null})),l((o=>{console.error("WebSocket 错误",o)}))}function S(o,e){if(!k)return console.error("WebSocket 未连接"),d=o,void g();var n={event:"bulk-subscribe",data:o};n=JSON.stringify(n),a({data:n,success:()=>{console.log("参数发送成功")},fail:o=>{console.error("参数发送失败",o)}}),c((function(o){e&&e(o)}))}const W={begin:g,send:function(o,e=!0){a({data:e?JSON.stringify(o):o,fail:()=>{console.log("fail 发送失败")}})},close:function(){f?i({success:()=>{console.log("WebSocket 关闭成功"),f=null},fail:o=>{console.error("WebSocket 关闭失败",o)}}):console.log("WebSocket 连接已关闭或不存在")},sendMessage:S};export{W as s};
