import{_ as X}from"./modal-form.vue_vue_type_script_setup_true_lang-Cjcae1c8.js";import{_ as J}from"./search-header-Y2BEBubG.js";import{_ as Z}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CHhYnPru.js";import{a0 as A,d as ee,O as te,r as l,V as ae,o as le,b as ne,f as a,w as r,h as c,B as b,g as p,W as T,a2 as D,a8 as z,Y as oe,N as re}from"./index-B8uXi1CT.js";import{g as ie}from"./mentor-management-COWomH2s.js";import{u as se,N as F}from"./custom-table-CIoqtwR0.js";import{_ as N}from"./Flex-Dd7uI-X0.js";import{_ as ue}from"./DataTable-JXNMHbFE.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-BZrBw3Pt.js";import"./custom-upload-TU2i3RYC.js";import"./Grid-8XO9VEVU.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-BkyFAWg2.js";import"./Spin-CPPIHThd.js";import"./DatePicker-BJOmBFQz.js";import"./TimePicker-qmmZBHrw.js";import"./Forward-zlCbBpdq.js";import"./RadioGroup-CyWpGGc2.js";import"./Space-BomAnmEk.js";function de(u){return A({url:"/follow/follow_order_additional",params:u})}function me(u){return A({url:`/follow/follow_order_additional?id=${u==null?void 0:u.id}`,method:"put",data:u})}const Be=ee({name:"documentation-management_additional-amount",__name:"index",setup(u){const{pagination:i,renderCell:U}=se(),f=te(),g=l(!1),C=l([]),_=l({user_type:"1"}),k=l(),M=l(""),y=l([{type:"Input",valueName:"order_no",label:"订单"},{type:"Input",valueName:"account",label:"账号/姓名"},{type:"Remote Select",valueName:"trader_id",label:"导师",selectLabelField:"name",selectValueField:"value",remoteSelectLoading:!1},{type:"Select",valueName:"user_type",label:"用户类型",defaultOption:[{value:"1",label:"正式用户"},{value:"2",label:"试玩用户"}]},{type:"Select",valueName:"order_type",label:"订单分类",defaultOption:[{label:"单日跟单",value:1},{label:"多日跟单",value:2}]},{type:"Datetime",datetimeType:"datetimerange",valueName:"create_time",label:"创建时间（开始~结束）"}]),w=l(!1);async function m(){var s;g.value=!0;const e=Array.isArray((s=_.value)==null?void 0:s.create_time)&&_.value.create_time.length?_.value.create_time.map(d=>D(d==null?void 0:d.valueOf()).format("YYYY/MM/DD")):"",{data:t}=await de({..._.value,create_time:void 0,start_create_time:e?e[0]:void 0,end_create_time:e?e[1]:void 0,page:i.page,limit:i.pageSize});C.value=t.list,i.itemCount=t.count,g.value=!1}const v=l(!1),h=l(1),Y=[{type:"selection"},{title:"ID",key:"id",align:"center",width:"50"},{title:"账号/姓名",key:"account",align:"center",width:"150",render:e=>a(N,null,{default:()=>[a("p",{class:"w-full text-center"},[e.account]),a("p",null,[e.user_nickname])]})},{title:"正式用户",key:"is_trial",align:"center",width:"100",render:e=>a(z,{type:e.is_trial===1?"error":"success"},{default:()=>[e.is_trial===1?"否":"是"]})},{title:"追加单号",key:"order_no",align:"center",width:"240",render:e=>a("div",null,[e.order_no||""])},{title:"订单分类",key:"order_type_text",align:"center",width:"100",render:e=>a("div",null,[e.order_type_text||""])},{title:"跟单订单号",key:"follow_order_no",align:"center",width:"240"},{title:"追加金额",key:"money",align:"center",width:"100"},{title:"市场",key:"market_type_name",align:"center",width:"120",render:e=>a("div",null,[e.market_type_name||""])},{title:"币种",key:"money_type_name",align:"center",width:"100"},{title:"导师姓名",key:"trader_name",align:"center",width:"100",render:e=>a("div",null,[e.trader_name||""])},{title:"状态",key:"status",align:"center",width:"100",render:e=>a(z,null,{default:()=>[e.status_text||""]})},{title:"追加时间",key:"update_time",align:"center",width:"200",render:e=>a("span",null,[e.update_time?D(e.update_time).format("YYYY-MM-DD HH:mm:ss"):""])},{title:"审核时间",key:"audit_time",align:"center",width:"200",render:e=>a("span",null,[e.apply_time?D(e.apply_time).format("YYYY-MM-DD HH:mm:ss"):""])},{title:"操作",key:"action",align:"center",width:160,fixed:"right",render:e=>a(N,{justify:"center"},{default:()=>[T(a("view",null,[a(F,{negativeText:"拒绝","on-negative-click":()=>{e.status===3?(k.value=e.id,v.value=!0,h.value=2):f.error("只可审核待审核的数据")},positiveText:"通过","onPositive-click":()=>{e.status===3?(k.value=e.id,S({remark:null}),h.value=1):f.error("只可审核待审核的数据")}},{default:()=>[p("确定审核订单吗？")],trigger:()=>a(b,{type:"success",size:"small"},{default:()=>[p("审核")]})})]),[[oe,e.status===3]])]})}],o=l([]),x=l([]),L=l([{type:"Input",valueName:"remark",label:"备注"}]),R={remark:[{required:!0,message:"请输入备注",trigger:["blur"]}]},H=l(!1);function $(e){_.value=e,i.page=1,m()}function I(e,t){o.value=e,x.value=t}function P(e){i.page=e,m()}function V(e){i.page=1,i.pageSize=e,m()}async function S(e){const t=o.value.length?o.value.join(","):`${k.value}`,s={status:h.value,remark:e.remark??""},{response:d}=await me({...s,id:t});o.value=[],x.value=[],d.data.status===200&&(f.success("提交成功"),v.value=!1,m())}async function O(){y.value[2].remoteSelectLoading=!0;const{data:e}=await ie({name:M.value});y.value[2].defaultOption=e,y.value[2].remoteSelectLoading=!1}function j(e){e.keyName==="trader_id"&&(M.value=e.value,O())}function B(e){if(w.value=!1,!o.value.length){f.error("请选择要审核订单的数据");return}let t=!1;for(const s of x.value)if(s.status!==3){t=!0;break}if(t){f.error("只能选择待审核的数据");return}h.value=e,e===2?v.value=!0:S({remark:null})}O();const E=l(Y.reduce((e,t)=>Number(e)+Number(t.width),0));return m(),(e,t)=>{const s=N,d=Z,q=J,K=ue,G=re,Q=X,W=ae("resize");return le(),ne("div",null,[a(G,{title:"追加金额列表"},{"header-extra":r(()=>[a(d,{"refresh-button-loading":g.value,"onUpdate:refreshButtonLoading":t[3]||(t[3]=n=>g.value=n),"export-selected-disabled":o.value.length,"onUpdate:exportSelectedDisabled":t[4]||(t[4]=n=>o.value.length=n),"batch-delete-disabled":o.value.length,"onUpdate:batchDeleteDisabled":t[5]||(t[5]=n=>o.value.length=n),"slot-name":"audit","is-add":!1,"is-batch-delete":!0,"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,onRefresh:m},{audit:r(()=>[a(s,{justify:"center"},{default:r(()=>[a(c(F),{show:w.value,"onUpdate:show":t[2]||(t[2]=n=>w.value=n)},{trigger:r(()=>[a(c(b),{type:"info",size:"small",ghost:"",disabled:!o.value.length},{default:r(()=>t[7]||(t[7]=[p("批量审核")])),_:1},8,["disabled"])]),action:r(()=>[a(c(b),{size:"small",onClick:t[0]||(t[0]=n=>B(2))},{default:r(()=>t[8]||(t[8]=[p("拒绝")])),_:1}),a(c(b),{size:"small",type:"primary",onClick:t[1]||(t[1]=n=>B(1))},{default:r(()=>t[9]||(t[9]=[p("通过")])),_:1})]),default:r(()=>[t[10]||(t[10]=p(" 确定批量审核订单吗？ "))]),_:1},8,["show"])]),_:1})]),_:1},8,["refresh-button-loading","export-selected-disabled","batch-delete-disabled"])]),default:r(()=>[a(q,{"search-config":y.value,onOnSearch:$,onOnRemoteSelectSearch:j},null,8,["search-config"]),T(a(K,{remote:"",columns:Y,data:C.value,loading:g.value,bordered:!1,style:{height:"560px"},"flex-height":"","scroll-x":E.value,pagination:c(i),"row-key":n=>n.id,"render-cell":c(U),"checked-row-keys":o.value,"onUpdate:checkedRowKeys":I,"onUpdate:page":P,"onUpdate:pageSize":V},null,8,["data","loading","scroll-x","pagination","row-key","render-cell","checked-row-keys"]),[[W]])]),_:1}),a(Q,{"show-form-modal":v.value,"onUpdate:showFormModal":t[6]||(t[6]=n=>v.value=n),title:"备注","form-rules":R,loading:H.value,"modal-form-config":L.value,onOnSubmit:S},null,8,["show-form-modal","loading","modal-form-config"])])}}});export{Be as default};
