import{_ as Ie}from"./modal-form.vue_vue_type_script_setup_true_lang-BJ69RLGj.js";import{_ as qe}from"./search-header-BxwkGrv3.js";import{_ as Ve}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CEWz-Loh.js";import{d as Le,O as Ae,r as u,U as ie,V as Pe,o as s,b as h,f as o,w as t,h as k,a1 as Q,W as Oe,S,ac as C,$ as w,B as de,N as $e,bp as Be,Z as je,c as U,y as ze,bq as Re,x as Te}from"./index-DrEzliHY.js";import{F as ce,G as Ge,H as He,I as Ke,J as Je,K as Qe}from"./user-manage-BW6Zf-JT.js";import{u as We,N as Ze}from"./custom-table-YBGLKz8r.js";import{u as Xe}from"./exportExcel-DmIPdUnp.js";import{_ as Ye}from"./Flex-DkQB4X0g.js";import{_ as ea}from"./DataTable-BLC5kPHF.js";import{_ as aa}from"./Space-B3V6_u3T.js";import{a as la,_ as na}from"./FormItem-D43XudUj.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-CddQKb4h.js";import"./custom-upload-xESAwsug.js";import"./Grid-ppKVTCkg.js";import"./get-slot-Bk_rJcZu.js";import"./Spin-4EGh_M6p.js";import"./DatePicker-B2ToGdru.js";import"./TimePicker-CbQV1d7H.js";import"./Forward-RZ68qXfC.js";import"./RadioGroup-DfynhpqT.js";function ve(L){return typeof L=="function"||Object.prototype.toString.call(L)==="[object Object]"&&!je(L)}const W="Svip列表.xlsx",Sa=Le({name:"user-manage_svip-manage",__name:"index",setup(L){const{pagination:x,renderCell:fe}=We(),g=Ae(),{exportExcel:H,exportLoading:b}=Xe(),N=u(!1),K=u([]),Z=u({}),pe=u([{type:"Input",valueName:"name",label:"名称",placeholder:"请输入名称"},{type:"Input Number",valueName:"lv",label:"等级",placeholder:"请输入等级"}]),A=u(0),P=u(!1),X=u(!0),M=u(!1),D=u(!0),me=u({}),O=u(!1),Y=u(!0),F=u(!1),E=u(!0),ee=u([{type:"Input",valueName:"name",label:"名称",i18n:!0},{type:"Input",valueName:"lv",label:"等级"},{type:"Input Number",valueName:"price",label:"申请金额"},{type:"Slot",valueName:"up_where",label:"升级条件",slotName:"up_where"},{type:"Slot",valueName:"upgradeCondition",slotName:"upgradeCondition"}]),ae=[{label:"购买金额",key:"0"},{label:"累计充值",key:"1"},{label:"邀请人数",key:"2"}],c=u({0:{name:"购买金额"},1:{name:"累计充值"},2:{name:"邀请人数"}}),i=u({0:{name:"购买金额"},1:{name:"累计充值"},2:{name:"邀请人数"}}),le=[{label:"VIP理财产品数量",key:"0"},{label:"费率(%)",key:"1"},{label:"利率(%)",key:"2"},{label:"优惠券数量",key:"3"}],p=u({0:{name:"VIP理财产品数量",type:"number"},1:{name:"费率(%)"},2:{name:"利率(%)"},3:{name:"优惠券数量",type:"number"}}),d=u({0:{name:"VIP理财产品数量",type:"number"},1:{name:"费率(%)"},2:{name:"利率(%)"},3:{name:"优惠券数量",type:"number"}}),y=u([]),v=u([]),I=u([]),f=u([]),ne=u([]),q=u([]),oe={name:[{required:!0,message:"请输入名称",trigger:["blur"]}],lv:[{required:!0,message:"请输入等级",trigger:["blur"]}],price:[{type:"number",required:!0,message:"请输入申请金额",trigger:["blur"]}],up_where:[{type:"array",required:!0,message:"请选择升级条件",trigger:["blur"],validator:()=>A.value?v.value.length?!0:new Error("请选择升级条件"):y.value.length?!0:new Error("请选择升级条件")}]};function ue(n){const e=[];return n.split(",").forEach(r=>{switch(r){case"0":e.push("购买金额");break;case"1":e.push("累计充值");break;case"2":e.push("邀请人数");break}}),e.length?e.join("、"):"/"}async function _(){N.value=!0;const{data:n}=await ce({page:x.page,limit:x.pageSize,...Z.value});K.value=n.list,x.itemCount=n.count,N.value=!1}function ge(n){x.page=n,_()}function be(n){x.page=1,x.pageSize=n,_()}async function ye(n){N.value=!0;const{response:e}=await Je(n);e.data.status===200&&(_(),g.success(w("common.deleteSuccess")))}async function _e(n){A.value=n;const{data:e}=await Qe(n);me.value=e,q.value[0].defaultValue=e.name,q.value[1].defaultValue=e.lv||e.lv===0?`${e.lv}`:"",q.value[2].defaultValue=Number(e.price),q.value[0].i18n&&(q.value[0].i18nValue=e.tplang_name),v.value=e.up_where.split(","),i.value={0:{name:"购买金额"},1:{name:"累计充值"},2:{name:"邀请人数"}},v.value.length&&v.value.forEach(r=>{switch(r){case"0":i.value[r].config=e.buy;break;case"1":i.value[r].config=e.recharge;break;case"2":i.value[r].config=e.invite;break}}),d.value={0:{name:"VIP理财产品数量",type:"number"},1:{name:"费率(%)"},2:{name:"利率(%)"},3:{name:"优惠券数量",type:"number"}},f.value=[],e.product_number&&(f.value.push("0"),d.value[0].config=e.product_number),e.product_number&&(f.value.push("1"),d.value[1].config=e.rate),e.product_number&&(f.value.push("2"),d.value[2].config=e.interest_rate),e.product_number&&(f.value.push("3"),d.value[3].config=e.coupon_number),O.value=!0}const $=[{type:"selection"},{title:"等级",key:"lv",align:"center"},{title:"名称",key:"name",align:"center"},{title:"升级条件",key:"up_where",align:"center",render:n=>ue(n.up_where)},{title:"创建时间",key:"create_time",align:"center"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:n=>{let e;return o(Ye,{justify:"center"},{default:()=>[o(de,{type:"success",size:"small",onClick:_e.bind(null,n.id)},ve(e=w("common.modify"))?e:{default:()=>[e]}),o(Ze,{"onPositive-click":ye.bind(null,n.id)},{default:()=>[w("common.confirmDelete")],trigger:()=>{let r;return o(de,{type:"error",size:"small"},ve(r=w("common.delete"))?r:{default:()=>[r]})}})]})}}];async function he(){const{data:n}=await ce();H({tableColumns:$,tableData:J(n.list),fileName:W})}function J(n){const e=n;return e.forEach(r=>{r.up_where&&(r.up_where=ue(r.up_where))}),e}const V=u([]),te=u([]);function ke(n){Z.value=n,x.page=1,_()}function we(n,e){V.value=n,te.value=e}function xe(){P.value=!0}async function Se(){N.value=!0;const{response:n}=await Ge({id:V.value.join(",")});n.data.status===200&&(_(),V.value=[],g.success(w("common.deleteSuccess")))}async function Ce(n){M.value=!0;const e={};if(y.value.length){for(const l of y.value)switch(l){case"0":if(c.value[l].config!==null&&c.value[l].config!==void 0)e.buy=c.value[l].config,D.value=!0;else{g.error("请输入购买金额"),D.value=!1,M.value=!1;return}break;case"1":if(c.value[l].config!==null&&c.value[l].config!==void 0)e.recharge=c.value[l].config,D.value=!0;else{g.error("请输入累计充值"),D.value=!1,M.value=!1;return}break;case"2":if(c.value[l].config!==null&&c.value[l].config!==void 0)e.invite=c.value[l].config,D.value=!0;else{g.error("请输入邀请人数"),D.value=!1,M.value=!1;return}break}e.up_where=y.value.join(",")}if(!D.value)return;I.value.length&&I.value.forEach(l=>{switch(l){case"0":e.product_number=p.value[l].config;break;case"1":e.rate=p.value[l].config;break;case"2":e.interest_rate=p.value[l].config;break;case"3":e.coupon_number=p.value[l].config;break}});const{response:r}=await He({...n,...e});r.data.status===200&&(_(),g.success(w("common.addSuccess")),P.value=!1),M.value=!1}function Ue(){y.value=[],I.value=[],c.value={0:{name:"购买金额"},1:{name:"累计充值"},2:{name:"邀请人数"}},p.value={0:{name:"VIP理财产品数量",type:"number"},1:{name:"费率(%)"},2:{name:"利率(%)"},3:{name:"优惠券数量",type:"number"}}}async function Ne(n){F.value=!0;const e={};if(v.value.length){for(const l of v.value)switch(l){case"0":if(i.value[l].config!==null&&i.value[l].config!==void 0)e.buy=i.value[l].config,E.value=!0;else{g.error("请输入购买金额"),E.value=!1,F.value=!1;return}break;case"1":if(i.value[l].config!==null&&i.value[l].config!==void 0)e.recharge=i.value[l].config,E.value=!0;else{g.error("请输入累计充值"),E.value=!1,F.value=!1;return}break;case"2":if(i.value[l].config!==null&&i.value[l].config!==void 0)e.invite=i.value[l].config,E.value=!0;else{g.error("请输入邀请人数"),E.value=!1,F.value=!1;return}break}e.up_where=v.value.join(",")}if(!E.value)return;f.value.length&&f.value.forEach(l=>{switch(l){case"0":e.product_number=d.value[l].config;break;case"1":e.rate=d.value[l].config;break;case"2":e.interest_rate=d.value[l].config;break;case"3":e.coupon_number=d.value[l].config;break}});const{response:r}=await Ke(A.value,{...n,...e});r.data.status===200&&(_(),g.success(w("common.modifySuccess")),O.value=!1),F.value=!1}function Me(){A.value=0,v.value=[],f.value=[]}return _(),ne.value=ie(ee.value),q.value=ie(ee.value),(n,e)=>{const r=Ve,l=qe,De=ea,Fe=$e,B=ze,j=aa,z=Be,R=Re,T=na,G=la,re=Te,se=Ie,Ee=Pe("resize");return s(),h("div",null,[o(Fe,{title:"Svip列表"},{"header-extra":t(()=>[o(r,{"export-all-loading":k(b),"onUpdate:exportAllLoading":e[0]||(e[0]=a=>Q(b)?b.value=a:null),"refresh-button-loading":N.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=a=>N.value=a),"export-selected-disabled":V.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=a=>V.value.length=a),"batch-delete-disabled":V.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=a=>V.value.length=a),"export-filter-loading":k(b),"onUpdate:exportFilterLoading":e[4]||(e[4]=a=>Q(b)?b.value=a:null),"export-selected-loading":k(b),"onUpdate:exportSelectedLoading":e[5]||(e[5]=a=>Q(b)?b.value=a:null),onExportAll:he,onExportFilter:e[6]||(e[6]=a=>k(H)({tableColumns:$,tableData:J(K.value),fileName:W})),onExportSelected:e[7]||(e[7]=a=>k(H)({tableColumns:$,tableData:J(te.value),fileName:W})),onAdd:xe,onBatchDelete:Se,onRefresh:_},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:t(()=>[o(l,{"search-config":pe.value,onOnSearch:ke},null,8,["search-config"]),Oe(o(De,{remote:"",columns:$,data:K.value,loading:N.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":1e3,pagination:k(x),"row-key":a=>a.id,"render-cell":k(fe),"onUpdate:checkedRowKeys":we,"onUpdate:page":ge,"onUpdate:pageSize":be},null,8,["data","loading","pagination","row-key","render-cell"]),[[Ee]])]),_:1}),o(se,{"show-form-modal":P.value,"onUpdate:showFormModal":e[10]||(e[10]=a=>P.value=a),"is-async-shut-down":X.value,"onUpdate:isAsyncShutDown":e[11]||(e[11]=a=>X.value=a),"is-show-modal-loading":M.value,"onUpdate:isShowModalLoading":e[12]||(e[12]=a=>M.value=a),"is-show-modal-form-i18n":!0,"modal-title":k(w)("common.add"),"modal-form-config":ne.value,"form-rules":oe,onOnSubmit:Ce,onOnClose:Ue},{up_where:t(()=>[o(z,{value:y.value,"onUpdate:value":e[8]||(e[8]=a=>y.value=a)},{default:t(()=>[o(j,{"item-style":"display: flex;"},{default:t(()=>[(s(),h(S,null,C(ae,a=>o(B,{key:a.key,value:a.key,label:a.label},null,8,["value","label"])),64))]),_:1})]),_:1},8,["value"])]),upgradeCondition:t(()=>[o(G,{model:y.value},{default:t(()=>[(s(!0),h(S,null,C(y.value,a=>(s(),U(T,{key:a,label:c.value[a].name},{default:t(()=>[o(R,{value:c.value[a].config,"onUpdate:value":m=>c.value[a].config=m,clearable:""},null,8,["value","onUpdate:value"])]),_:2},1032,["label"]))),128))]),_:1},8,["model"])]),equity:t(()=>[o(z,{value:I.value,"onUpdate:value":e[9]||(e[9]=a=>I.value=a)},{default:t(()=>[o(j,{"item-style":"display: flex;"},{default:t(()=>[(s(),h(S,null,C(le,a=>o(B,{key:a.key,value:a.key,label:a.label},null,8,["value","label"])),64))]),_:1})]),_:1},8,["value"])]),equityConfig:t(()=>[o(G,{model:I.value},{default:t(()=>[(s(!0),h(S,null,C(I.value,a=>(s(),U(T,{key:a,label:p.value[a].name},{default:t(()=>[p.value[a].type==="number"?(s(),U(R,{key:0,value:p.value[a].config,"onUpdate:value":m=>p.value[a].config=m,clearable:""},null,8,["value","onUpdate:value"])):(s(),U(re,{key:1,value:p.value[a].config,"onUpdate:value":m=>p.value[a].config=m,clearable:""},null,8,["value","onUpdate:value"]))]),_:2},1032,["label"]))),128))]),_:1},8,["model"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),o(se,{"show-form-modal":O.value,"onUpdate:showFormModal":e[15]||(e[15]=a=>O.value=a),"is-async-shut-down":Y.value,"onUpdate:isAsyncShutDown":e[16]||(e[16]=a=>Y.value=a),"is-show-modal-loading":F.value,"onUpdate:isShowModalLoading":e[17]||(e[17]=a=>F.value=a),"is-show-modal-form-i18n":!0,"modal-title":k(w)("common.modify"),"modal-form-config":q.value,"form-rules":oe,onOnSubmit:Ne,onOnClose:Me},{up_where:t(()=>[o(z,{value:v.value,"onUpdate:value":e[13]||(e[13]=a=>v.value=a)},{default:t(()=>[o(j,{"item-style":"display: flex;"},{default:t(()=>[(s(),h(S,null,C(ae,a=>o(B,{key:a.key,value:a.key,label:a.label},null,8,["value","label"])),64))]),_:1})]),_:1},8,["value"])]),upgradeCondition:t(()=>[o(G,{model:v.value},{default:t(()=>[(s(!0),h(S,null,C(v.value,a=>(s(),U(T,{key:a,label:i.value[a].name},{default:t(()=>[o(R,{value:i.value[a].config,"onUpdate:value":m=>i.value[a].config=m,clearable:""},null,8,["value","onUpdate:value"])]),_:2},1032,["label"]))),128))]),_:1},8,["model"])]),equity:t(()=>[o(z,{value:f.value,"onUpdate:value":e[14]||(e[14]=a=>f.value=a)},{default:t(()=>[o(j,{"item-style":"display: flex;"},{default:t(()=>[(s(),h(S,null,C(le,a=>o(B,{key:a.key,value:a.key,label:a.label},null,8,["value","label"])),64))]),_:1})]),_:1},8,["value"])]),equityConfig:t(()=>[o(G,{model:f.value},{default:t(()=>[(s(!0),h(S,null,C(f.value,a=>(s(),U(T,{key:a,label:d.value[a].name},{default:t(()=>[d.value[a].type==="number"?(s(),U(R,{key:0,value:d.value[a].config,"onUpdate:value":m=>d.value[a].config=m,clearable:""},null,8,["value","onUpdate:value"])):(s(),U(re,{key:1,value:d.value[a].config,"onUpdate:value":m=>d.value[a].config=m,clearable:""},null,8,["value","onUpdate:value"]))]),_:2},1032,["label"]))),128))]),_:1},8,["model"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{Sa as default};
