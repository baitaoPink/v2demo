import{a as _e,_ as ie}from"./multi-language-form.vue_vue_type_script_setup_true_lang-D4ifp7HF.js";import{d as re,r,l as ce,O as ve,o as _,c,w as s,f as d,b as T,ac as R,S as j,W as de,Y as me,e as F,g as b,t as L,h as fe,$ as G,ah as ge,B as ye,N as be,a4 as m,cC as he,x as ke,bo as Ne,X as Ce,a6 as we}from"./index-DgS_gExp.js";import{p as Ue,q as $e,r as xe}from"./systen-configuration-DSYmlnfw.js";import{_ as Fe,u as Le}from"./custom-upload-DUUdPJxM.js";import{_ as Ve}from"./TimePicker-BsIq1gq9.js";import{a as Se,_ as Te}from"./FormItem-BAqcrsPW.js";import{_ as Re}from"./Spin-Bu1_C0Z0.js";import{_ as je,a as qe}from"./RadioGroup-C9MN4_Hy.js";import{_ as Be}from"./Space-CMuvGHTq.js";import{_ as ze}from"./Flex-NxzTnbAG.js";import"./Grid-BNV0w0mr.js";import"./get-slot-Bk_rJcZu.js";const Oe={class:"w-100%"},Ee={class:"font-size-12px color-#a4a4a4"},Me={class:"bottom-button"},k="zh-Hans",Ge=re({name:"system-config_parameter-settings",__name:"index",setup(He){const H=r(ce.get("languageList")),q=r(null),D=r("medium"),l=r({}),N=r({}),f=r({}),P=ve(),{handleUpload:A}=Le(),w=r(0),U=r([]),C=r({}),h=r(!1),i=r({}),B=r(""),z=r(""),O=r(""),E=r(""),V=r(!1);async function K(){h.value=!0;const{data:n}=await Ue();U.value=n.config_tab,S(U.value[0].id),w.value=Number(U.value[0].id)}function W(n){S(n),l.value={},i.value={},f.value={},N.value={}}async function S(n){h.value=!0;const{data:o}=await $e({tab_id:n});C.value=o.list.sort((a,p)=>a.sort-p.sort).filter(a=>a.status===1),C.value.forEach(a=>{if(a.need_tplang===1&&(a.tplang_value&&Object.prototype.toString.call(a.tplang_value)==="[object Object]"?i.value[a.menu_name]=a.tplang_value:a.tplang_value&&Object.prototype.toString.call(a.tplang_value)!=="[object Object]"?i.value[a.menu_name]={[k]:a.tplang_value}:i.value[a.menu_name]=null),a.type==="radio"){a.radioGroupOption=[];const p=Object.fromEntries(a.parameter.split(`
`).map(v=>v.split("=>").reverse()));for(const v in p)Reflect.has(p,v)&&a.radioGroupOption.push({label:v,value:p[v]});l.value[a.menu_name]=p[a.value]}else if(a.type==="file"){let p="";a.value&&Array.isArray(a.value)&&a.value.length>0?(p=a.value[0].filepath,f.value[a.menu_name]=a.value[0].filename):a.value&&typeof a.value=="object"&&(p=a.value.filepath||"",f.value[a.menu_name]=a.value.filename),N.value[a.menu_name]=[{id:a.menu_name,name:a.info,url:p,status:"finished"}]}else l.value[a.menu_name]=a.value}),h.value=!1}function X(n){if(n.required.split(",").includes("required:true"))return n.type==="file"?[{required:!0,message:`请上传${n.info}`,trigger:["change"],validator:()=>Reflect.has(f.value,n.menu_name)?!0:new Error(`请上传${n.info}`)}]:n.type==="switch"?[{type:"number",required:!0,message:`请选择${n.info}`,trigger:["input","blur"]}]:[{required:!0,message:`请输入${n.info}`,trigger:["input","blur"]}]}function $(n){B.value=n.type,z.value=n.keyName,O.value=n.menuValue,E.value=n.formItemType,V.value=!0}function Y(n){i.value[`${n.key}`]=n.value}async function Z({file:n,onFinish:o,onError:a,onProgress:p},v){const g=await A({file:n,onFinish:o,onError:a,onProgress:p});f.value[v]=g}function J(n){Reflect.deleteProperty(f.value,n),Reflect.deleteProperty(N.value,n)}async function Q(n){var o;n.preventDefault(),(o=q.value)==null||o.validate(async a=>{if(!a){const p={};C.value.forEach(u=>{var x;l.value[u.menu_name]!==null&&l.value[u.menu_name]!==void 0?u.need_tplang===1&&(i.value[u.menu_name]!==null&&i.value[u.menu_name]!==void 0?(i.value[u.menu_name][k]=l.value[u.menu_name],p[u.menu_name]=i.value[u.menu_name]):p[u.menu_name]={[k]:l.value[u.menu_name]}):u.type==="file"&&u.need_tplang===1&&(i.value[u.menu_name]?((x=H.value)==null||x.forEach(y=>{y.file_name===k?i.value[u.menu_name][k]=f.value[u.menu_name]:i.value[u.menu_name][y.file_name]=typeof i.value[u.menu_name][y.file_name]=="object"?i.value[u.menu_name][y.file_name].filename:i.value[u.menu_name][y.file_name]}),p[u.menu_name]=i.value[u.menu_name]):p[u.menu_name]={[k]:f.value[u.menu_name]?f.value[u.menu_name]:""})}),h.value=!0;const v={...l.value,...f.value,...p},{response:g}=await xe(v);g.data.status===200&&(S(w.value),P.success(G("common.modifySuccess"))),h.value=!1}})}return K(),(n,o)=>{const a=he,p=ge,v=ke,g=ye,u=Ne,x=ie,y=Ve,I=je,ee=Be,ae=qe,ne=Fe,ue=Ce,le=ze,te=Te,oe=Se,M=be,se=_e,pe=Re;return _(),c(pe,{show:h.value},{default:s(()=>[d(M,{title:"参数设置"},{default:s(()=>[d(p,{value:w.value,"onUpdate:value":[o[0]||(o[0]=e=>w.value=e),W],"justify-content":"space-evenly",type:"line"},{default:s(()=>[(_(!0),T(j,null,R(U.value,e=>(_(),c(a,{key:e.value,name:e.value},{default:s(()=>[F("span",null,L(e.label),1)]),_:2},1032,["name"]))),128))]),_:1},8,["value"]),d(M,{bordered:!1,class:"w-100%"},{default:s(()=>[d(oe,{ref_key:"formRef",ref:q,model:l.value,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging",size:D.value},{default:s(()=>[(_(!0),T(j,null,R(C.value,e=>(_(),c(te,{key:e.id,prop:e.menu_name,label:e.info,path:e.menu_name,"label-width":"auto",rule:X(e)},{default:s(()=>[F("div",Oe,[d(le,{justify:"start",vertical:""},{default:s(()=>[e.input_type==="input"&&e.type==="text"?(_(),c(u,{key:0},{default:s(()=>[d(v,{value:l.value[e.menu_name],"onUpdate:value":t=>l.value[e.menu_name]=t,placeholder:`请输入${e.info}`,clearable:""},null,8,["value","onUpdate:value","placeholder"]),e.need_tplang===1?(_(),c(g,{key:0,type:"primary",ghost:"",onClick:t=>$({type:"Input",keyName:e.menu_name,menuValue:l.value[e.menu_name],i18nValue:e.tplang_value})},{default:s(()=>o[2]||(o[2]=[b(" 多语言 ")])),_:2},1032,["onClick"])):m("",!0)]),_:2},1024)):m("",!0),e.input_type==="textarea"&&e.type==="textarea"?(_(),c(u,{key:1},{default:s(()=>[d(v,{value:l.value[e.menu_name],"onUpdate:value":t=>l.value[e.menu_name]=t,type:"textarea",placeholder:`请输入${e.info}`,clearable:""},null,8,["value","onUpdate:value","placeholder"]),e.need_tplang===1?(_(),c(g,{key:0,type:"primary",ghost:"",onClick:t=>$({type:"Input",keyName:e.menu_name,menuValue:l.value[e.menu_name],i18nValue:e.tplang_value,formItemType:"textarea"})},{default:s(()=>o[3]||(o[3]=[b(" 多语言 ")])),_:2},1032,["onClick"])):m("",!0)]),_:2},1024)):m("",!0),e.input_type==="editor"?(_(),c(u,{key:2},{default:s(()=>[d(x,{"editor-content":l.value[e.menu_name],"onUpdate:editorContent":t=>l.value[e.menu_name]=t},null,8,["editor-content","onUpdate:editorContent"]),e.need_tplang===1?(_(),c(g,{key:0,type:"primary",ghost:"",onClick:t=>$({type:"Rich Text",keyName:e.menu_name,menuValue:l.value[e.menu_name],i18nValue:e.tplang_value})},{default:s(()=>o[4]||(o[4]=[b(" 多语言 ")])),_:2},1032,["onClick"])):m("",!0)]),_:2},1024)):m("",!0),e.input_type==="time"?(_(),c(y,{key:3,"formatted-value":l.value[e.menu_name],"onUpdate:formattedValue":t=>l.value[e.menu_name]=t,"value-format":"HH:mm:ss",clearable:""},null,8,["formatted-value","onUpdate:formattedValue"])):m("",!0),e.input_type==="input"&&e.type==="radio"?(_(),c(ae,{key:4,value:l.value[e.menu_name],"onUpdate:value":t=>l.value[e.menu_name]=t,name:e.menu_name},{default:s(()=>[d(ee,null,{default:s(()=>[(_(!0),T(j,null,R(e.radioGroupOption,t=>(_(),c(I,{key:t.value,value:t.value},{default:s(()=>[b(L(t.label),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value","name"])):m("",!0),e.input_type==="file"&&e.type==="file"?(_(),c(u,{key:5},{default:s(()=>[d(ne,{"file-list":N.value[e.menu_name],"onUpdate:fileList":t=>N.value[e.menu_name]=t,"list-type":"image-card",max:1,accept:`${e.upload_type!==3?"image/*":void 0}`,"custom-request":t=>Z(t,e.menu_name),onRemove:t=>J(e.menu_name)},{default:s(()=>o[5]||(o[5]=[b(" 点击上传 ")])),_:2},1032,["file-list","onUpdate:fileList","accept","custom-request","onRemove"]),e.need_tplang===1?(_(),c(g,{key:0,type:"primary",ghost:"",onClick:t=>$({type:"Upload",keyName:e.menu_name,menuValue:e.value,i18nValue:e.tplang_value,formItemType:e.upload_type})},{default:s(()=>o[6]||(o[6]=[b(" 多语言 ")])),_:2},1032,["onClick"])):m("",!0)]),_:2},1024)):m("",!0),e.input_type==="switch"&&e.type==="switch"?(_(),c(ue,{key:6,value:l.value[e.menu_name],"onUpdate:value":t=>l.value[e.menu_name]=t,class:"justify-left","checked-value":1,"unchecked-value":2},null,8,["value","onUpdate:value"])):m("",!0),F("span",Ee,L(e.desc),1)]),_:2},1024)])]),_:2},1032,["prop","label","path","rule"]))),128))]),_:1},8,["model","size"]),de(F("div",Me,[d(g,{class:"w-280px!",size:"medium",type:"primary",block:"",secondary:"",strong:"",onClick:Q},{default:s(()=>[b(L(fe(G)("common.confirm")),1)]),_:1})],512),[[me,C.value.length]])]),_:1}),d(se,{"show-form-modal":V.value,"onUpdate:showFormModal":o[1]||(o[1]=e=>V.value=e),"form-item-type":B.value,"form-item-key":z.value,"subdivide-type":E.value,"zh-cn-value":O.value,"i18n-form-item-data":i.value,onOnSubmit:Y},null,8,["show-form-modal","form-item-type","form-item-key","subdivide-type","zh-cn-value","i18n-form-item-data"])]),_:1})]),_:1},8,["show"])}}}),aa=we(Ge,[["__scopeId","data-v-285af15d"]]);export{aa as default};
