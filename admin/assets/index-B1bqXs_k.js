import{_ as le}from"./modal-form.vue_vue_type_script_setup_true_lang-BuDR1X64.js";import{_ as re}from"./search-header-DC9myRJJ.js";import{_ as se}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-BqWHjY4C.js";import{a0 as f,d as ue,O as ie,r as a,U as C,V as de,o as me,b as pe,f as s,w as z,h as d,a1 as M,W as ce,$ as m,B,N as fe,Z as ge}from"./index-DgS_gExp.js";import{u as be,N as ye}from"./custom-table-M__G0njN.js";import{u as ve}from"./exportExcel-4g3fAweF.js";import{_ as he}from"./Flex-NxzTnbAG.js";import{_ as we}from"./DataTable-R-3tvq3U.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-D4ifp7HF.js";import"./custom-upload-DUUdPJxM.js";import"./Grid-BNV0w0mr.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-BAqcrsPW.js";import"./Spin-Bu1_C0Z0.js";import"./DatePicker-yC2d8YmP.js";import"./TimePicker-BsIq1gq9.js";import"./Forward-BOBl18BE.js";import"./RadioGroup-C9MN4_Hy.js";import"./Space-CMuvGHTq.js";function j(n){return f({url:"/system/user/partnerSubsidy",params:n})}function Se(n){return f({url:"/system/user/partnerSubsidy",method:"post",data:n})}function xe(n,r){return f({url:`/system/user/partnerSubsidy/${n}`,method:"put",data:r})}function _e(n){return f({url:`/system/user/partnerSubsidy/${n}`})}function De(n){return f({url:`/system/user/partnerSubsidy/${n}`,method:"delete"})}function Ne(n){return f({url:"/system/user/partnerSubsidy/batchDelete",method:"post",params:n})}function O(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!ge(n)}const U="补贴设置列表.xlsx",He=ue({name:"user-manage_subsidy-setting",__name:"index",setup(n){const{pagination:r,renderCell:P}=be(),b=ie(),{exportExcel:S,exportLoading:u}=ve(),p=a(!1),x=a([]),k=a(),R=a([{type:"Input",valueName:"number",label:"达到人数",placeholder:"请输入达到人数"},{type:"Input",valueName:"amount",label:"补贴金额",placeholder:"请输入补贴金额"}]),E=a(0),y=a(!1),A=a(!0),v=a(!1),T=a({}),h=a(!1),F=a(!0),w=a(!1),_=a([{type:"Input Number",valueName:"number",label:"达到人数"},{type:"Input Number",valueName:"amount",label:"补贴金额"}]),D=a([]),N=a([]),L={number:[{required:!0,type:"number",trigger:["blur"],validator:(t,e)=>!e&&e!==0?new Error("请输入达到人数"):!Number.isInteger(e)||e<=0?new Error("请输入正整数"):!0}],amount:[{required:!0,type:"number",trigger:["blur"],validator:(t,e)=>!e&&e!==0?new Error("请输入补贴金额"):!Number.isInteger(e)||e<=0?new Error("请输入正整数"):!0}]};async function i(){p.value=!0;const{data:t}=await j({...k.value,page:r.page,limit:r.pageSize});r.itemCount=t.count,x.value=t.list,p.value=!1}async function V(t){p.value=!0;const{response:e}=await De(t);e.data.status===200&&(i(),b.success(m("common.deleteSuccess")))}async function q(t){E.value=t;const{data:e}=await _e(t);T.value=e,N.value.forEach(l=>{l.defaultValue=Number(e[l.valueName]??0)}),h.value=!0}const g=[{type:"selection"},{title:"达到人数",key:"number",align:"center"},{title:"补贴金额",key:"amount",align:"center"},{title:"修改时间",key:"update_time",align:"center"},{title:"创建时间",key:"create_time",align:"center"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:t=>{let e;return s(he,{justify:"center"},{default:()=>[s(B,{type:"success",size:"small",onClick:q.bind(null,t.id)},O(e=m("common.modify"))?e:{default:()=>[e]}),s(ye,{"onPositive-click":V.bind(null,t.id)},{default:()=>[m("common.confirmDelete")],trigger:()=>{let l;return s(B,{type:"error",size:"small"},O(l=m("common.delete"))?l:{default:()=>[l]})}})]})}}];async function H(){const{data:t}=await j();S({tableColumns:g,tableData:t.list,fileName:U})}const c=a([]),I=a([]);function K(t){k.value=t,r.page=1,i()}function G(t,e){c.value=t,I.value=e}function Q(){D.value=C(_.value),y.value=!0}async function W(){p.value=!0;const{response:t}=await Ne({id:c.value.join(",")});t.data.status===200&&(i(),c.value=[],b.success(m("common.deleteSuccess")))}async function X(t){v.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:l}=await Se({...t,...e});l.data.status===200&&(i(),b.success(m("common.addSuccess")),y.value=!1),v.value=!1}async function Z(t){w.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:l}=await xe(E.value,{...t,...e});l.data.status===200&&(i(),b.success(m("common.modifySuccess")),h.value=!1),w.value=!1}function J(t){r.page=t,i()}function Y(t){r.page=1,r.pageSize=t,i()}i(),D.value=C(_.value),N.value=C(_.value);const ee=a(g.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const l=se,te=re,oe=we,ae=fe,$=le,ne=de("resize");return me(),pe("div",null,[s(ae,{title:"补贴设置列表"},{"header-extra":z(()=>[s(l,{"export-all-loading":d(u),"onUpdate:exportAllLoading":e[0]||(e[0]=o=>M(u)?u.value=o:null),"refresh-button-loading":p.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=o=>p.value=o),"export-selected-disabled":c.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=o=>c.value.length=o),"batch-delete-disabled":c.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=o=>c.value.length=o),"export-filter-loading":d(u),"onUpdate:exportFilterLoading":e[4]||(e[4]=o=>M(u)?u.value=o:null),"export-selected-loading":d(u),"onUpdate:exportSelectedLoading":e[5]||(e[5]=o=>M(u)?u.value=o:null),onExportAll:H,onExportFilter:e[6]||(e[6]=o=>d(S)({tableColumns:g,tableData:x.value,fileName:U})),onExportSelected:e[7]||(e[7]=o=>d(S)({tableColumns:g,tableData:I.value,fileName:U})),onAdd:Q,onBatchDelete:W,onRefresh:i},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:z(()=>[s(te,{"search-config":R.value,onOnSearch:K},null,8,["search-config"]),ce(s(oe,{remote:"",columns:g,data:x.value,loading:p.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":ee.value,pagination:d(r),"row-key":o=>o.id,"render-cell":d(P),"onUpdate:checkedRowKeys":G,"onUpdate:page":J,"onUpdate:pageSize":Y},null,8,["data","loading","scroll-x","pagination","row-key","render-cell"]),[[ne]])]),_:1}),s($,{"show-form-modal":y.value,"onUpdate:showFormModal":e[8]||(e[8]=o=>y.value=o),"is-async-shut-down":A.value,"onUpdate:isAsyncShutDown":e[9]||(e[9]=o=>A.value=o),"is-show-modal-loading":v.value,"onUpdate:isShowModalLoading":e[10]||(e[10]=o=>v.value=o),"modal-title":d(m)("common.add"),"modal-form-config":D.value,"form-rules":L,onOnSubmit:X},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),s($,{"show-form-modal":h.value,"onUpdate:showFormModal":e[11]||(e[11]=o=>h.value=o),"is-async-shut-down":F.value,"onUpdate:isAsyncShutDown":e[12]||(e[12]=o=>F.value=o),"is-show-modal-loading":w.value,"onUpdate:isShowModalLoading":e[13]||(e[13]=o=>w.value=o),"modal-title":d(m)("common.modify"),"modal-form-config":N.value,"form-rules":L,onOnSubmit:Z},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{He as default};
