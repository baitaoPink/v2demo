import{_ as Ve}from"./modal-form.vue_vue_type_script_setup_true_lang-BGpCBuuL.js";import{_ as ze}from"./search-header-DKkxeb92.js";import{_ as Be}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-Co_MiHfJ.js";import{d as je,O as Ke,r as o,U as s,V as Qe,o as Ge,b as We,f as r,w as d,h,a1 as Z,W as Xe,g as B,$ as N,K as Ze,X as Je,B as ce,N as Ye,a5 as et,Z as tt}from"./index-BGn2hxht.js";import{o as at}from"./systen-configuration-D8RMvtUQ.js";import{g as ye,b as lt,s as ot,m as nt,a as rt,d as ut,c as it}from"./payment-DdlL3R8B.js";import{u as st,N as dt}from"./custom-table-CkjRR_Ue.js";import{u as mt}from"./exportExcel-Bj9ZbbX3.js";import{_ as pt,u as ft}from"./custom-upload-BnYTuu-H.js";import{_ as vt}from"./Flex-BOUMy5Qd.js";import{_ as ct}from"./DataTable-B20boM9S.js";import{_ as yt}from"./TimePicker-B2GQNCjg.js";import{_ as gt}from"./Space-AspkDbzB.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-BLS00VyW.js";import"./Grid-D6W4PgKj.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-hAQEuGNb.js";import"./Spin-CneC0ahg.js";import"./DatePicker-ByFFtn5f.js";import"./Forward-BMPR_CvR.js";import"./RadioGroup-QgSZfQqx.js";function ge(F){return typeof F=="function"||Object.prototype.toString.call(F)==="[object Object]"&&!tt(F)}const J="支付方式管理列表.xlsx",$t=je({name:"system-config_payment-management",__name:"index",setup(F){const{pagination:x,renderCell:_e}=st(),O=Ke(),{exportExcel:j,exportLoading:c}=mt(),{handleUpload:be}=ft(),k=o(!1),K=o([]),Y=o(null),ee=o(null),te=o(null),ae=o(null),le=o(),q=[{value:1,label:"法币"},{value:2,label:"数字货币"},{value:3,label:"钱包"}],we=o([{type:"Input",valueName:"name",label:"名称",placeholder:"请输入名称"},{type:"Input",valueName:"account_information",label:"账号信息",placeholder:"请输入账号信息"},{type:"Select",valueName:"status",label:"状态",placeholder:"请选择状态",defaultOption:[{label:"显示",vlaue:"1"},{label:"隐藏",value:"0"}]},{type:"Select",valueName:"support_type",label:"支持类型",defaultOption:[{label:"充值",value:1},{value:2,label:"提现"},{value:3,label:"提现+充值"}]},{type:"Select",valueName:"pay_type",label:"支付类型",defaultOption:q,itemWidth:"240px"}]),he=["withdrawal_min_money","withdrawal_max_money","min_money","max_money","card_number"],E=o(0),S=o(!1),oe=o(!0),Q=o(!1),Ne=o({}),P=o(!1),ne=o(!0),T=o(!1),p=o(void 0),m=o(void 0),G=o([]),L=o(null),$=o(null),f=o([{type:"Slot",valueName:"pay_type",slotName:"payType",label:"支付类型"},{type:"Slot",valueName:"type",slotName:"type",label:"支付平台"},{type:"Input",valueName:"name",label:"名称",i18n:!0},{type:"Input",valueName:"account_information",label:"账号信息"},{type:"Select",valueName:"money_type_id",label:"货币",defaultOption:[],selectFilter:!0},{type:"Input Number",valueName:"withdrawal_min_money",label:"最小提现金额"},{type:"Input Number",valueName:"withdrawal_max_money",label:"最高提现金额"},{type:"Input Number",valueName:"min_money",label:"充值最小"},{type:"Input Number",valueName:"max_money",label:"充值最大"},{type:"Input",valueName:"withdrawal_exchange_rate",label:"提现手续费"},{type:"Input",valueName:"withdrawal_fee_type",label:"提现手续费类型",placeholder:"1固定 2百分比"},{type:"Select",valueName:"support_type",label:"支持类型",defaultOption:[{label:"充值",value:1},{value:2,label:"提现"},{value:3,label:"提现+充值"}]},{type:"Input Number",valueName:"sort",label:"排序"},{type:"Radio",valueName:"status",label:"状态",radioGroupOption:[{label:"显示",value:1},{value:0,label:"隐藏"}]},{type:"Slot",valueName:"logo",label:"logo",slotName:"logo"},{type:"Slot",valueName:"qrcode_url",label:"收款码",slotName:"qrcode_url"},{type:"Slot",valueName:"limit_time",label:"提现时间",slotName:"limit_time"}]),re=o([{type:"Input",valueName:"payee",label:"收款人"},{type:"Input Number",valueName:"card_number",label:"收款账号"},{type:"Input",valueName:"bank_name",label:"所属银行"}]),ue=o([{type:"Input",valueName:"address",label:"充值地址"},{type:"Input",valueName:"agreement",label:"协议"}]),ie=o([{type:"Input",valueName:"extra_key",label:"额外参数"},{type:"Input",valueName:"app_id",label:"商户号"},{type:"Input",valueName:"app_secret",label:"秘钥（或者Md5Key）"},{type:"Input",valueName:"app_public_key",label:"公钥"}]),D=o(null),R=o(null),y=o([]),i=o({}),v=o({}),g=o([]),se={logo:[{message:"请上传logo",trigger:["blur"],validator:()=>{if(i.value.logo&&i.value.logo.length)return v.value.logo?!0:new Error("请上传logo")}}],pay_type:[{required:!0,message:"请选择支付类型",trigger:["blur"],validator:()=>p.value?!0:new Error("请选择支付类型")}],type:[{message:"请选择支付平台",trigger:["blur"],validator:()=>p.value===3?m.value?!0:new Error("请选择支付平台"):!0}],name:[{required:!0,message:"请输入名称",trigger:["blur"]}],account_information:[{required:!0,message:"请输入账号信息",trigger:["blur"]}],withdrawal_min_money:[{required:!0,type:"float",trigger:["blur"],validator:(t,e)=>{var n,u;const a=S.value?(n=D.value)==null?void 0:n.formModel:(u=R.value)==null?void 0:u.formModel;return e?e<=0?new Error("请输入大于0的数"):a!=null&&a.withdrawal_max_money&&e>a.withdrawal_max_money?new Error("最小提现金额不能大于最大提现金额"):!0:new Error("请输入最小提现金额")}}],withdrawal_max_money:[{required:!0,trigger:["blur"],validator:(t,e)=>{var n,u;const a=S.value?(n=D.value)==null?void 0:n.formModel:(u=R.value)==null?void 0:u.formModel;return e?e<=0?new Error("请输入大于0的数"):a!=null&&a.withdrawal_min_money&&e<a.withdrawal_min_money?new Error("最大提现金额不能小于最小提现金额"):!0:new Error("请输入最高提现金额")}}],min_money:[{required:!0,trigger:["blur"],validator:(t,e)=>{var n,u;const a=S.value?(n=D.value)==null?void 0:n.formModel:(u=R.value)==null?void 0:u.formModel;return e?e<=0?new Error("请输入大于0的数"):a!=null&&a.min_money&&e>a.max_money?new Error("最小充值金额不能大于最大充值金额"):!0:new Error("请输入充值最小")}}],max_money:[{required:!0,trigger:["blur"],validator:(t,e)=>{var n,u;const a=S.value?(n=D.value)==null?void 0:n.formModel:(u=R.value)==null?void 0:u.formModel;return e?e<=0?new Error("请输入大于0的数"):a!=null&&a.max_money&&e<a.min_money?new Error("最大充值金额不能小于最小充值金额"):!0:new Error("请输入充值最大")}}],support_type:[{required:!0,message:"请输入支持类型",type:"number",trigger:["blur"]}],payee:[{required:!0,message:"请输入收款人",trigger:["blur"]}],card_number:[{type:"number",required:!0,message:"请输入收款账号",trigger:["blur"]}],bank_name:[{required:!0,message:"请输入所属银行",trigger:["blur"]}],address:[{required:!0,message:"请输入充值地址",trigger:["blur"]}],agreement:[{required:!0,message:"请输入协议",trigger:["blur"]}],withdrawal_exchange_rate:[{type:"float",trigger:["blur"],validator:(t,e)=>e&&e<0?new Error("不能输入小于0的数"):!0}],exchange_rate:[{trigger:["blur"],validator:(t,e)=>e&&e<0?new Error("不能输入小于0的数"):!0}]};async function _(){k.value=!0;const{data:t}=await ye({...le.value,page:x.page,limit:x.pageSize});K.value=t.list,x.itemCount=t.count,k.value=!1}async function xe(t){k.value=!0;const{response:e}=await ut(t);e.data.status===200&&(_(),O.success(N("common.deleteSuccess")))}async function Se(t){E.value=t;const{data:e}=await it(t);p.value=e.pay_type,A(e.pay_type),m.value=e.type,Ne.value=e,g.value.forEach(a=>{a.i18n&&(a.i18nValue=e[`tplang_${a.valueName}`]),he.includes(a.valueName)&&(e[a.valueName]=Number(e[a.valueName])),a.valueName==="status"&&(a.defaultValue=e.status?String(e.status):""),a.defaultValue=e[a.valueName]}),e.logo&&(i.value.logo=[{id:"logo",name:"logo",url:e.logo,status:"finished"}],v.value.logo=e.logo),e.qrcode_url&&(i.value.qrcode_url=[{id:"qrcode_url",name:"qrcode_url",url:e.qrcode_url,status:"finished"}],v.value.qrcode_url=e.qrcode_url),e.limit_time_start&&(L.value=e.limit_time_start),e.limit_time_end&&($.value=e.limit_time_end),P.value=!0}const I=[{type:"selection"},{title:"Logo",key:"logo",align:"center",width:"100",render:t=>r(Ze,{width:"100",src:t.logo},null)},{title:"名称",key:"name",align:"center",width:"100",render:t=>r("div",null,[t.name||""])},{title:"币种",key:"money_type_name",align:"center",width:"100",render:t=>r("div",null,[t.money_type_name||""])},{title:"支付类型",key:"pay_type",align:"center",width:"100",render:t=>{const e=q.find(a=>a.value===t.pay_type);return e?e==null?void 0:e.label:"/"}},{title:"账号信息",key:"account_information",align:"center",width:"100",render:t=>r("div",null,[t.account_information||""])},{title:"收款人",key:"payee",align:"center",width:"100",render:t=>r("div",null,[t.payee||""])},{title:"最小提现金额",key:"withdrawal_min_money",align:"center",width:"140",render:t=>r("div",null,[t.withdrawal_min_money||""])},{title:"最高提现金额",key:"withdrawal_max_money",align:"center",width:"140",render:t=>r("div",null,[t.withdrawal_max_money||""])},{title:"提现手续费",key:"withdrawal_exchange_rate",align:"center",width:"100",render:t=>r("div",null,[t.withdrawal_exchange_rate||""])},{title:"支持类型",key:"support_type",align:"center",width:"100",render:t=>({1:"充值",2:"提现",3:"提现+充值"})[t.support_type]},{title:"排序",key:"sort",align:"center",width:"100",render:t=>`${t.sort}`||""},{title:"状态",key:"status",align:"center",width:"100",render:t=>{const e=o(t.status===1);return r(Je,{value:e.value,"onUpdate:value":[a=>e.value=a,a=>{t.status=a?1:0,E.value=t.id,me({...t,status:a})}]},null)}},{title:"创建时间",key:"create_time",align:"center",width:"160"},{title:"更新时间",key:"create_time",align:"center",width:"160"},{title:"操作",key:"action",align:"center",width:200,fixed:"right",render:t=>{let e;return r(vt,{justify:"center"},{default:()=>[r(ce,{type:"success",size:"small",onClick:Se.bind(null,t.id)},ge(e=N("common.modify"))?e:{default:()=>[e]}),r(dt,{"onPositive-click":xe.bind(null,t.id)},{default:()=>[N("common.confirmDelete")],trigger:()=>{let a;return r(ce,{type:"error",size:"small"},ge(a=N("common.delete"))?a:{default:()=>[a]})}})]})}}];async function Me(){const{data:t}=await ye(),e={1:"充值",2:"提现",3:"提现+充值"},a=t.list.map(n=>{const u=q.find(M=>M.value===n.pay_type);return{...n,pay_type:u?u==null?void 0:u.label:"/",status:n.status===1?"显示":"隐藏",support_type:e[n.support_type]}});j({tableColumns:I,tableData:a??[],fileName:J})}const C=o([]),de=o([]);function ke(t){le.value=t,x.page=1,_()}async function qe(){const{data:t}=await at(),e=t.map(a=>({label:a.money_type,value:a.id}));y.value.forEach((a,n)=>{a.valueName==="money_type_id"&&(f.value[n].defaultOption=e,y.value[n].defaultOption=e,g.value[n].defaultOption=e)})}qe();async function H({file:t,onFinish:e,onError:a,onProgress:n},u){const M=await be({file:t,onFinish:e,onError:a,onProgress:n});v.value[u]=M}function U(t){Reflect.deleteProperty(v.value,t),Reflect.deleteProperty(i.value,t)}function Ce(t,e){C.value=t,de.value=e}function Ue(){S.value=!0}async function Ee(){k.value=!0;const{response:t}=await lt({id:C.value.join(",")});t.data.status===200&&(_(),C.value=[],O.success(N("common.deleteSuccess")))}async function De(t){const e={};m.value&&(e.type=m.value);const{response:a}=await ot({...t,...e,pay_type:p.value,status:t.status?1:0,...v.value});a.data.status===200&&(_(),O.success(N("common.addSuccess")),S.value=!1),Q.value=!1}function Re(){i.value={},v.value={},p.value=void 0,m.value=void 0,A(null)}async function me(t){T.value=!0;const e={};m.value?e.type=m.value:e.type=null;const{response:a}=await nt(E.value,{...t,...e,pay_type:p.value,status:t.status?1:0,...v.value,limit_time_start:L.value,limit_time_end:$.value});a.data.status===200&&(_(),O.success(N("common.modifySuccess")),P.value=!1),T.value=!1}function Ie(){E.value=0,i.value={},v.value={},p.value=void 0,m.value=void 0}function Fe(t){x.page=t,_()}function Oe(t){x.page=1,x.pageSize=t,_()}function A(t){if(E.value)switch(m.value=void 0,t){case 1:g.value=[...s(f.value),...s(re.value)];break;case 2:g.value=[...s(f.value),...s(ue.value)];break;case 3:g.value=[...s(f.value),...s(ie.value)],g.value[1].disabled=!1;break;default:g.value=s(f.value);break}else switch(m.value=void 0,t){case 1:y.value=[...s(f.value),...s(re.value)];break;case 2:y.value=[...s(f.value),...s(ue.value)];break;case 3:y.value=[...s(f.value),...s(ie.value)],y.value[1].disabled=!1;break;default:y.value=s(f.value);break}}function pe(t,e){var a,n,u,M;t?(i.value.logo=[{id:"logo",name:"logo",url:e.icon.filepath,status:"finished"}],v.value.logo=e.icon.filename):(U("logo"),U("qrcode_url"),(a=Y.value)==null||a.clear(),(n=ee.value)==null||n.clear(),(u=te.value)==null||u.clear(),(M=ae.value)==null||M.clear())}async function Pe(){const{data:t}=await rt();G.value=t}async function Te(t){const e=new Date(t),a=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),u=`${a}:${n}`;L.value=u}async function Le(t){const e=new Date(t),a=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),u=`${a}:${n}`;$.value=u}_(),y.value=s(f.value),g.value=s(f.value),Pe();const $e=o(I.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const a=Be,n=ze,u=ct,M=Ye,V=et,z=pt,fe=Ve,ve=yt,He=gt,Ae=Qe("resize");return Ge(),We("div",null,[r(M,{title:"支付方式管理列表"},{"header-extra":d(()=>[r(a,{"export-all-loading":h(c),"onUpdate:exportAllLoading":e[0]||(e[0]=l=>Z(c)?c.value=l:null),"refresh-button-loading":k.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=l=>k.value=l),"export-selected-disabled":C.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=l=>C.value.length=l),"batch-delete-disabled":C.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=l=>C.value.length=l),"export-filter-loading":h(c),"onUpdate:exportFilterLoading":e[4]||(e[4]=l=>Z(c)?c.value=l:null),"export-selected-loading":h(c),"onUpdate:exportSelectedLoading":e[5]||(e[5]=l=>Z(c)?c.value=l:null),onExportAll:Me,onExportFilter:e[6]||(e[6]=l=>{h(j)({tableColumns:I,tableData:K.value.map(b=>{const W={1:"充值",2:"提现",3:"提现+充值"},w=q.find(X=>X.value===b.pay_type);return{...b,pay_type:w?w==null?void 0:w.label:"/",status:b.status===1?"显示":"隐藏",support_type:W[b.support_type]}}),fileName:J})}),onExportSelected:e[7]||(e[7]=l=>{h(j)({tableColumns:I,tableData:de.value.map(b=>{const W={1:"充值",2:"提现",3:"提现+充值"},w=q.find(X=>X.value===b.pay_type);return{...b,pay_type:w?w==null?void 0:w.label:"/",status:b.status===1?"显示":"隐藏",support_type:W[b.support_type]}}),fileName:J})}),onAdd:Ue,onBatchDelete:Ee,onRefresh:_},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:d(()=>[r(n,{"search-config":we.value,onOnSearch:ke},null,8,["search-config"]),Xe(r(u,{remote:"",columns:I,data:K.value,loading:k.value,bordered:!1,class:"h-600px","flex-height":"","scroll-x":$e.value,pagination:h(x),"row-key":l=>l.id,"render-cell":h(_e),"onUpdate:checkedRowKeys":Ce,"onUpdate:page":Fe,"onUpdate:pageSize":Oe},null,8,["data","loading","scroll-x","pagination","row-key","render-cell"]),[[Ae]])]),_:1}),r(fe,{ref_key:"addModalFormRef",ref:D,"show-form-modal":S.value,"onUpdate:showFormModal":e[14]||(e[14]=l=>S.value=l),"is-async-shut-down":oe.value,"onUpdate:isAsyncShutDown":e[15]||(e[15]=l=>oe.value=l),"is-show-modal-loading":Q.value,"onUpdate:isShowModalLoading":e[16]||(e[16]=l=>Q.value=l),"is-show-modal-form-i18n":!0,"modal-title":h(N)("common.add"),"width-class":"w-1200px","grid-gi-span":12,"modal-form-config":y.value,"form-rules":se,onOnSubmit:De,onOnClose:Re},{payType:d(()=>[r(V,{value:p.value,"onUpdate:value":[e[8]||(e[8]=l=>p.value=l),A],filterable:"",clearable:"",placeholder:"请选择支付类型",options:q},null,8,["value"])]),type:d(()=>[r(V,{value:m.value,"onUpdate:value":[e[9]||(e[9]=l=>m.value=l),pe],filterable:"",clearable:"","label-field":"name","value-field":"value",disabled:p.value!==3,placeholder:"请选择支付平台",options:G.value},null,8,["value","disabled","options"])]),logo:d(()=>[r(z,{ref_key:"uploadRef",ref:Y,"file-list":i.value.logo,"onUpdate:fileList":e[10]||(e[10]=l=>i.value.logo=l),"list-type":"image-card",max:1,accept:"image/*","custom-request":l=>H(l,"logo"),onRemove:e[11]||(e[11]=l=>U("logo"))},{default:d(()=>e[26]||(e[26]=[B(" 点击上传 ")])),_:1},8,["file-list","custom-request"])]),qrcode_url:d(()=>[r(z,{ref_key:"qrCodeUrlUploadRef",ref:te,"file-list":i.value.qrcode_url,"onUpdate:fileList":e[12]||(e[12]=l=>i.value.qrcode_url=l),"custom-request":l=>H(l,"qrcode_url"),"list-type":"image-card",max:1,accept:"image/*",onRemove:e[13]||(e[13]=l=>U("qrcode_url"))},{default:d(()=>e[27]||(e[27]=[B(" 点击上传 ")])),_:1},8,["file-list","custom-request"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),r(fe,{ref_key:"modifyModalFormRef",ref:R,"show-form-modal":P.value,"onUpdate:showFormModal":e[23]||(e[23]=l=>P.value=l),"is-async-shut-down":ne.value,"onUpdate:isAsyncShutDown":e[24]||(e[24]=l=>ne.value=l),"is-show-modal-loading":T.value,"onUpdate:isShowModalLoading":e[25]||(e[25]=l=>T.value=l),"is-show-modal-form-i18n":!0,"modal-title":h(N)("common.modify"),"width-class":"w-1200px","grid-gi-span":12,"modal-form-config":g.value,"form-rules":se,onOnSubmit:me,onOnClose:Ie},{payType:d(()=>[r(V,{value:p.value,"onUpdate:value":[e[17]||(e[17]=l=>p.value=l),A],filterable:"",clearable:"",placeholder:"请选择支付类型",options:q},null,8,["value"])]),type:d(()=>[r(V,{value:m.value,"onUpdate:value":[e[18]||(e[18]=l=>m.value=l),pe],filterable:"",clearable:"","label-field":"name","value-field":"value",disabled:p.value!==3,placeholder:"请选择支付平台",options:G.value},null,8,["value","disabled","options"])]),logo:d(()=>[r(z,{ref_key:"editUploadRef",ref:ee,"file-list":i.value.logo,"onUpdate:fileList":e[19]||(e[19]=l=>i.value.logo=l),"custom-request":l=>H(l,"logo"),"list-type":"image-card",max:1,accept:"image/*",onRemove:e[20]||(e[20]=l=>U("logo"))},{default:d(()=>e[28]||(e[28]=[B(" 点击上传 ")])),_:1},8,["file-list","custom-request"])]),qrcode_url:d(()=>[r(z,{ref_key:"editQrCodeUrlUploadRef",ref:ae,"file-list":i.value.qrcode_url,"onUpdate:fileList":e[21]||(e[21]=l=>i.value.qrcode_url=l),"custom-request":l=>H(l,"qrcode_url"),"list-type":"image-card",max:1,accept:"image/*",onRemove:e[22]||(e[22]=l=>U("qrcode_url"))},{default:d(()=>e[29]||(e[29]=[B(" 点击上传 ")])),_:1},8,["file-list","custom-request"])]),limit_time:d(()=>[r(He,null,{default:d(()=>[r(ve,{format:"HH:mm","value-format":"HH:mm","default-formatted-value":L.value??"",onConfirm:Te},null,8,["default-formatted-value"]),r(ve,{format:"HH:mm","value-format":"HH:mm","default-formatted-value":$.value??"",onConfirm:Le},null,8,["default-formatted-value"])]),_:1})]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{$t as default};
