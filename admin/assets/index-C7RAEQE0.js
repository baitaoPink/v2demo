import{_ as ve}from"./modal-form.vue_vue_type_script_setup_true_lang-DoZbWwaq.js";import{_ as ye}from"./search-header-BMTtF8l_.js";import{_ as be}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-B0-DchGJ.js";import{d as we,O as he,r as o,U as G,V as _e,o as xe,b as Se,f as n,w,h as r,a1 as E,W as ke,g as X,$ as d,a3 as Ne,K as De,X as Ce,B as Q,N as Ue,Z as Le}from"./index-CArBg04O.js";import{g as W,b as Me,s as Fe,m as Oe,a as Ee,d as Be,c as Ae}from"./home-banner-dlDWc72E.js";import{u as Re,N as Te}from"./custom-table-BTjOT39P.js";import{u as qe}from"./exportExcel-CBd_t5dx.js";import{_ as Ie,u as $e}from"./custom-upload-syTh6Ivv.js";import{_ as ze}from"./Flex-BI-XPGW2.js";import{_ as He}from"./DataTable-D8kk90MM.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-CILu7-Hi.js";import"./Grid-BKCm7cA2.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-DG8tpaDc.js";import"./Spin-DJsdEB-2.js";import"./DatePicker-CL3JbrfR.js";import"./TimePicker-C51DBHeq.js";import"./Forward-DBdOiGc7.js";import"./RadioGroup-CUdlQrr4.js";import"./Space-BcPIDW0k.js";function Z(k){return typeof k=="function"||Object.prototype.toString.call(k)==="[object Object]"&&!Le(k)}const B="首页轮播.xlsx",rt=we({name:"article-manage_home-banner",__name:"index",setup(k){const{pagination:m,renderCell:J}=Re(),N=he(),{handleUpload:Y}=$e(),{exportExcel:U,exportLoading:i}=qe(),c=o(!1),L=o([]),A=o({}),R=o([{type:"Select",valueName:"type",label:"类型"}]),D=o(0),h=o(!1),T=o(!0),v=o(!1),ee=o({}),_=o(!1),q=o(!0),y=o(!1),I=o([{type:"Input",valueName:"title",label:"文章标题"},{type:"Slot",valueName:"image",label:"图片",slotName:"image"},{type:"Select",valueName:"lang_code",label:"语言",defaultOption:[]},{type:"Select",valueName:"type",label:"类型",defaultOption:[]},{type:"Select",valueName:"link_type",label:"链接类型",defaultOption:[{label:"文章",value:"0"},{label:"产品",value:"1"},{label:"自定义链接",value:"2"}]},{type:"Input",valueName:"link",label:"链接"},{type:"Radio",valueName:"status",label:"状态",radioGroupOption:[{label:"显示",value:1},{value:0,label:"隐藏"}]}]),f=o({}),M=o([]),F=o([]),b=o([]),x=o([]),$=o([]),z={title:[{required:!0,message:"请输入文章标题",trigger:["blur"]}],image:[{message:"请上传图片",trigger:["blur"],validator:()=>f.value.image?!0:new Error("请上传图片")}],category_id:[{required:!0,message:"请选择文章分类",trigger:["blur"]}],lang_code:[{required:!0,message:"请选择语言",trigger:["blur"]}],sub_title:[{required:!0,message:"请输入简略标题",trigger:["blur"]}],describe:[{required:!0,message:"请输入摘要",trigger:["blur"]}],content:[{required:!0,message:"请输入内容",trigger:["blur"]}]};async function u(){c.value=!0;const{data:t}=await W({...A.value,page:m.page,limit:m.pageSize});L.value=t.list,m.itemCount=t.count,c.value=!1}async function te(t){c.value=!0;const{response:e}=await Be(t);e.data.status===200&&(u(),N.success(d("common.deleteSuccess")))}async function ae(t){D.value=t;const{data:e}=await Ae(t);ee.value=e,x.value.forEach(a=>{const s=["link_type"];a.defaultValue=s.includes(a.valueName)?`${e[a.valueName]}`:e[a.valueName]}),F.value=[{id:"image",name:"image",url:e.image,status:"finished"}],f.value.image=e.image,_.value=!0}async function le(){var a;const{data:t}=await Ne(),e=(a=t.list)==null?void 0:a.map(s=>({value:s.file_name,label:s.language_name}));b.value.forEach((s,g)=>{s.valueName==="lang_code"&&(b.value[g].defaultOption=e,x.value[g].defaultOption=e)})}le();const S=[{type:"selection"},{title:"Id",key:"id",align:"center",width:"80"},{title:"图片",key:"image",align:"center",width:"100",render:t=>n(De,{width:"100",src:t.image},null)},{title:"语言",key:"lang_code",align:"center",width:"100"},{title:"类型",key:"type",align:"center",width:"100",render:t=>{const e=$.value.filter(a=>a.value===t.type);return e.length?e[0].label:""}},{title:"标题",key:"title",align:"center",width:"200"},{title:"链接类型",key:"link_type",align:"center",width:"200",render:t=>({0:"文章",1:"产品",2:"自定义链接"})[t.link_type]},{title:"链接",key:"link",align:"center",width:"200"},{title:"状态",key:"up_where",align:"center",width:"100",render:t=>{const e=o(t.status===1);return n(Ce,{value:e.value,"onUpdate:value":[a=>e.value=a,a=>{t.status=a?1:0,D.value=t.id,j({...t,status:a})}]},null)}},{title:"创建时间",key:"create_time",align:"center",width:"180"},{title:"操作",key:"action",align:"center",width:200,fixed:"right",render:t=>{let e;return n(ze,{justify:"center"},{default:()=>[n(Q,{type:"success",size:"small",onClick:ae.bind(null,t.id)},Z(e=d("common.modify"))?e:{default:()=>[e]}),n(Te,{"onPositive-click":te.bind(null,t.id)},{default:()=>[d("common.confirmDelete")],trigger:()=>{let a;return n(Q,{type:"error",size:"small"},Z(a=d("common.delete"))?a:{default:()=>[a]})}})]})}}];async function oe(){const{data:t}=await W();U({tableColumns:S,tableData:O(t),fileName:B})}function O(t){const e=t;return e.forEach(a=>{a.up_where}),e}async function H({file:t,onFinish:e,onError:a,onProgress:s}){v.value=h.value,y.value=_.value;const g=await Y({file:t,onFinish:e,onError:a,onProgress:s});g&&(f.value.image=g),v.value=!1,y.value=!1}function C(t){D.value,Reflect.deleteProperty(f.value,t)}const p=o([]),P=o([]);function ne(t,e){p.value=t,P.value=e}function se(){h.value=!0}async function ie(){c.value=!0;const{response:t}=await Me({id:p.value.join(",")});t.data.status===200&&(u(),p.value=[],N.success(d("common.deleteSuccess")))}async function ue(t){v.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:a}=await Fe({...t,...e,status:t.status?1:0,...f.value});a.data.status===200&&(u(),N.success(d("common.addSuccess")),h.value=!1,M.value=[]),C("image"),v.value=!1}async function j(t){y.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:a}=await Oe(D.value,{...t,...e,status:t.status?1:0,...f.value});a.data.status===200&&(u(),N.success(d("common.modifySuccess")),_.value=!1),y.value=!1,C("image")}function re(t){m.page=t,u()}function de(t){m.page=1,m.pageSize=t,u()}async function me(){const{data:t}=await Ee(),e=t.map(a=>({label:a.name,value:a.value}));$.value=e,b.value.forEach((a,s)=>{a.valueName==="type"&&(b.value[s].defaultOption=e,x.value[s].defaultOption=e)}),R.value[0].defaultOption=e}function pe(t){A.value=t,m.page=1,u()}me(),u(),b.value=G(I.value),x.value=G(I.value);const ce=o(S.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const a=be,s=ye,g=He,fe=Ue,V=Ie,K=ve,ge=_e("resize");return xe(),Se("div",null,[n(fe,{title:"首页轮播列表"},{"header-extra":w(()=>[n(a,{"export-all-loading":r(i),"onUpdate:exportAllLoading":e[0]||(e[0]=l=>E(i)?i.value=l:null),"refresh-button-loading":c.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=l=>c.value=l),"export-selected-disabled":p.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=l=>p.value.length=l),"batch-delete-disabled":p.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=l=>p.value.length=l),"export-filter-loading":r(i),"onUpdate:exportFilterLoading":e[4]||(e[4]=l=>E(i)?i.value=l:null),"export-selected-loading":r(i),"onUpdate:exportSelectedLoading":e[5]||(e[5]=l=>E(i)?i.value=l:null),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,onExportAll:oe,onExportFilter:e[6]||(e[6]=l=>r(U)({tableColumns:S,tableData:O(L.value),fileName:B})),onExportSelected:e[7]||(e[7]=l=>r(U)({tableColumns:S,tableData:O(P.value),fileName:B})),onAdd:se,onBatchDelete:ie,onRefresh:u},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:w(()=>[n(s,{"search-config":R.value,onOnSearch:pe},null,8,["search-config"]),ke(n(g,{remote:"",columns:S,data:L.value,loading:c.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":ce.value,pagination:r(m),"row-key":l=>l.id,"checked-row-keys":p.value,"render-cell":r(J),"onUpdate:checkedRowKeys":ne,"onUpdate:page":re,"onUpdate:pageSize":de},null,8,["data","loading","scroll-x","pagination","row-key","checked-row-keys","render-cell"]),[[ge]])]),_:1}),n(K,{"show-form-modal":h.value,"onUpdate:showFormModal":e[10]||(e[10]=l=>h.value=l),"is-async-shut-down":T.value,"onUpdate:isAsyncShutDown":e[11]||(e[11]=l=>T.value=l),"is-show-modal-loading":v.value,"onUpdate:isShowModalLoading":e[12]||(e[12]=l=>v.value=l),"modal-title":r(d)("common.add"),"modal-form-config":b.value,"form-rules":z,onOnSubmit:ue},{image:w(()=>[n(V,{"file-list":M.value,"onUpdate:fileList":e[8]||(e[8]=l=>M.value=l),"list-type":"image-card",max:1,"custom-request":H,onRemove:e[9]||(e[9]=l=>C("image"))},{default:w(()=>e[18]||(e[18]=[X(" 点击上传 ")])),_:1},8,["file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),n(K,{"show-form-modal":_.value,"onUpdate:showFormModal":e[15]||(e[15]=l=>_.value=l),"is-async-shut-down":q.value,"onUpdate:isAsyncShutDown":e[16]||(e[16]=l=>q.value=l),"is-show-modal-loading":y.value,"onUpdate:isShowModalLoading":e[17]||(e[17]=l=>y.value=l),"modal-title":r(d)("common.modify"),"modal-form-config":x.value,"form-rules":z,onOnSubmit:j},{image:w(()=>[n(V,{"file-list":F.value,"onUpdate:fileList":e[13]||(e[13]=l=>F.value=l),"list-type":"image-card",max:1,"custom-request":H,onRemove:e[14]||(e[14]=l=>C("image"))},{default:w(()=>e[19]||(e[19]=[X(" 点击上传 ")])),_:1},8,["file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{rt as default};
