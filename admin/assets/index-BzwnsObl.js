import{_ as Q}from"./modal-form.vue_vue_type_script_setup_true_lang-j1132KrY.js";import{_ as W}from"./search-header-DhS2HM_m.js";import{_ as X}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-76gGQ2zm.js";import{a0 as N,d as J,O as Z,r as l,V as ee,o as te,b as ae,f as a,w as r,h as c,B as h,g as p,W as O,a2 as z,a8 as le,Y as ne,N as oe}from"./index-BhZbmApS.js";import{g as ie}from"./mentor-management-bOBKdDk6.js";import{u as re,N as A}from"./custom-table-yyPRBDqX.js";import{_ as x}from"./Flex-Xt9D36M-.js";import{_ as ue}from"./DataTable-BUHP-Ae3.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-hwQCHruZ.js";import"./custom-upload-CT98ih7i.js";import"./Grid-BYDYsNmE.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-CazWVZB1.js";import"./Spin-CGYfGxVc.js";import"./DatePicker-udzJSNwE.js";import"./TimePicker-BJXcuAD9.js";import"./Forward-fZSWWEhd.js";import"./RadioGroup-BuESdM6z.js";import"./Space-DABBuydk.js";function se(s){return N({url:"/follow/follow_order/withdraw_profit",params:s})}function de(s){return N({url:"/follow/follow_order/withdraw_profit/audit",method:"post",data:s})}function me(s){return N({url:"/follow/follow_order/withdraw_profit/batch_audit",method:"post",data:s})}const Oe=J({name:"documentation-management_profit-review",__name:"index",setup(s){const{pagination:u,renderCell:F}=re(),f=Z(),g=l(!1),D=l([]),v=l({user_type:"1"}),w=l(),C=l(""),_=l([{type:"Input",valueName:"order_no",label:"订单"},{type:"Input",valueName:"account_key",label:"账号/姓名"},{type:"Remote Select",valueName:"trader_id",label:"导师",selectLabelField:"name",selectValueField:"value",remoteSelectLoading:!1},{type:"Select",valueName:"user_type",label:"用户类型",defaultOption:[{label:"正式用户",value:1},{label:"试玩用户",value:2}]},{type:"Select",valueName:"list_status",label:"状态",defaultOption:[{label:"全部",value:0},{label:"待审核",value:1},{label:"进行中",value:2},{label:"驳回",value:3}]},{type:"Datetime",datetimeType:"datetimerange",valueName:"create_time",label:"提盈时间（开始~结束）"},{type:"Datetime",datetimeType:"datetimerange",valueName:"audit_time",label:"审核时间（开始~结束）"}]);async function d(){var t;g.value=!0;const{data:e}=await se({...v.value,create_time:Array.isArray((t=v.value)==null?void 0:t.create_time)&&v.value.create_time.length?v.value.create_time.map(i=>z(i==null?void 0:i.valueOf()).format("YYYY/MM/DD")).join("-"):"",page:u.page,limit:u.pageSize});D.value=e.list,u.itemCount=e.count,g.value=!1}const m=l(!1),b=l(!1),y=l(1),T=[{type:"selection"},{title:"ID",key:"id",align:"center",width:"60"},{title:"账号/姓名",key:"account",align:"center",width:"200",render:e=>a(x,{justify:"center"},{default:()=>[a("p",{class:"w-full text-center"},[e.account]),a("p",null,[e.account_name])]})},{title:"市场",key:"market_type_name",align:"center",width:"80"},{title:"正式用户",key:"user_type",align:"center",width:"100",render:e=>a(le,{type:e.user_type===1?"success":"error"},{default:()=>[e.user_type===1?"是":"否"]})},{title:"币种",key:"money_type_name",align:"center",width:"80"},{title:"订单号",key:"order_no",align:"center",width:"200"},{title:"提盈金额",key:"money",align:"center",width:"200"},{title:"导师",key:"trader_name",align:"center",width:"100",render:e=>a("span",null,[e.trader_name||""])},{title:"审核状态",key:"audit_status_str",align:"center",width:"160"},{title:"审核时间",key:"audit_time",align:"center",width:"220",render:e=>e.audit_time?z(new Date(e.audit_time)).format("YYYY-MM-DD HH:mm:ss"):""},{title:"提盈时间",key:"create_time",align:"center",width:"220"},{title:"操作",key:"action",align:"center",width:100,fixed:"right",render:e=>a(x,{justify:"center"},{default:()=>[O(a("view",null,[a(A,{negativeText:"拒绝","on-negative-click":()=>{e.audit_status===1?(w.value=e.id,m.value=!0,y.value=3):f.error("只可审核待审核的数据")},positiveText:"通过","onPositive-click":()=>{e.audit_status===1?(w.value=e.id,m.value=!0,y.value=2):f.error("只可审核待审核的数据")}},{default:()=>[p("确定审核订单吗？")],trigger:()=>a(h,{type:"success",size:"small"},{default:()=>[p("审核")]})})]),[[ne,e.audit_status===1]])]})}],o=l([]),k=l([]),Y=l([{type:"Input",inputType:"textarea",valueName:"audit_remark",label:"备注"}]),U=l(!1);function L(e){v.value=e,u.page=1,d()}function j(e,t){o.value=e,k.value=t}function P(e){u.page=e,d()}function R(e){u.page=1,u.pageSize=e,d()}async function $(e){const t=o.value.length?o.value.join(","):`${w.value}`,i={audit_status:`${y.value}`,remarks:e.remarks??""},{response:S}=o.value.length?await me({...i,ids:t}):await de({...i,id:t});o.value=[],k.value=[],S.data.status===200&&(f.success("提交成功"),m.value=!1,d())}async function B(){_.value[2].remoteSelectLoading=!0;const{data:e}=await ie({name:C.value});_.value[2].defaultOption=e,_.value[2].remoteSelectLoading=!1}function I(e){e.keyName==="trader_id"&&(C.value=e.value,B())}function M(e){if(b.value=!1,!o.value.length){f.error("请选择要审核订单的数据");return}let t=!1;for(const i of k.value)if(i.audit_status!==1){t=!0;break}if(t){f.error("只能选择待审核的数据");return}y.value=e,m.value=!0}B(),d();const V=l(T.reduce((e,t)=>Number(e)+Number(t.width),0));return(e,t)=>{const i=x,S=X,H=W,E=ue,K=oe,q=Q,G=ee("resize");return te(),ae("div",null,[a(K,{title:"提盈审核列表"},{"header-extra":r(()=>[a(S,{"refresh-button-loading":g.value,"onUpdate:refreshButtonLoading":t[3]||(t[3]=n=>g.value=n),"export-selected-disabled":o.value.length,"onUpdate:exportSelectedDisabled":t[4]||(t[4]=n=>o.value.length=n),"batch-delete-disabled":o.value.length,"onUpdate:batchDeleteDisabled":t[5]||(t[5]=n=>o.value.length=n),"slot-name":"profityAudit","is-add":!1,"is-batch-delete":!1,"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,onRefresh:d},{profityAudit:r(()=>[a(i,{justify:"center"},{default:r(()=>[a(c(A),{show:b.value,"onUpdate:show":t[2]||(t[2]=n=>b.value=n)},{trigger:r(()=>[a(c(h),{type:"info",size:"small",ghost:""},{default:r(()=>t[7]||(t[7]=[p("批量审核")])),_:1})]),action:r(()=>[a(c(h),{size:"small",onClick:t[0]||(t[0]=n=>M(3))},{default:r(()=>t[8]||(t[8]=[p("拒绝")])),_:1}),a(c(h),{size:"small",type:"primary",onClick:t[1]||(t[1]=n=>M(2))},{default:r(()=>t[9]||(t[9]=[p("通过")])),_:1})]),default:r(()=>[t[10]||(t[10]=p(" 确定批量审核订单吗？ "))]),_:1},8,["show"])]),_:1})]),_:1},8,["refresh-button-loading","export-selected-disabled","batch-delete-disabled"])]),default:r(()=>[a(H,{"search-config":_.value,onOnSearch:L,onOnRemoteSelectSearch:I},null,8,["search-config"]),O(a(E,{remote:"",columns:T,data:D.value,loading:g.value,bordered:!1,style:{height:"560px"},"flex-height":"","scroll-x":V.value,pagination:c(u),"row-key":n=>n.id,"render-cell":c(F),"checked-row-keys":o.value,"onUpdate:checkedRowKeys":j,"onUpdate:page":P,"onUpdate:pageSize":R},null,8,["data","loading","scroll-x","pagination","row-key","render-cell","checked-row-keys"]),[[G]])]),_:1}),a(q,{"show-form-modal":m.value,"onUpdate:showFormModal":t[6]||(t[6]=n=>m.value=n),title:"审核",loading:U.value,"modal-form-config":Y.value,onOnSubmit:$},null,8,["show-form-modal","loading","modal-form-config"])])}}});export{Oe as default};
