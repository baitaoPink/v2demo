import{_ as le}from"./modal-form.vue_vue_type_script_setup_true_lang-D4rPO6tH.js";import{_ as ne}from"./search-header-BhM1flca.js";import{_ as se}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CWQZkHKX.js";import{d as ie,O as ue,r as l,U as j,o as re,b as de,f as n,w as V,h as d,a1 as M,$ as c,X as z,B as P,N as ce,Z as me}from"./index-hovKqFL_.js";import{g as R,b as pe,s as fe,e as ve,d as ge,a as be}from"./article-manage-IZRPt83T.js";import{u as ye,N as he}from"./custom-table-DDqfUiuo.js";import{u as we}from"./exportExcel-Cd1dBC53.js";import{_ as _e}from"./Flex-DFwRD2Q7.js";import{_ as xe}from"./DataTable-DU30Lwyo.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-CKLYA_yb.js";import"./custom-upload-ByeURddi.js";import"./Grid-BhltlsZc.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-_LcKmAs5.js";import"./Spin-BT5AbCHY.js";import"./DatePicker-BLT4kyC3.js";import"./TimePicker-SQv-WABn.js";import"./Forward-Cg-d91Ea.js";import"./RadioGroup-v60ZBrUm.js";import"./Space-D3aac8v1.js";function T(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!me(v)}const U="文章分类.xlsx",Ie=ie({name:"article-manage_service-class",__name:"index",setup(v){const{pagination:m,renderCell:$}=ye(),p=ue(),{exportExcel:x,exportLoading:s}=we(),i=l(!1),S=l([]),A=l({}),I=l([{type:"Input",valueName:"title",label:"分类名称",placeholder:"请输入分类名称"}]),g=l(0),b=l(!1),N=l(!0),y=l(!1),H=l({}),h=l(!1),E=l(!0),w=l(!1),F=l([{type:"Input",valueName:"name",label:"名称"},{type:"Select",valueName:"status",label:"状态",defaultOption:[{value:2,label:"开启"},{value:1,label:"关闭"}]},{type:"Select",valueName:"is_lock",label:"是否锁定",defaultOption:[{value:1,label:"锁定"},{value:2,label:"未锁定"}]}]),L=l([]),f=l([]),B={name:[{required:!0,message:"请输入名称",trigger:["blur"]}]};async function u(){i.value=!0;const{data:a}=await R({...A.value,page:m.page,limit:m.pageSize});S.value=a.list,m.itemCount=a.count,i.value=!1}async function K(a){if(a.is_lock===1){p.error("锁定状态不可删除");return}i.value=!0;const{response:e}=await ge({id:a.id});e.data.status===200&&(u(),p.success(c("common.deleteSuccess")))}async function q(a){g.value=a;const{data:e}=await be({id:a});H.value=e,f.value[0].defaultValue=e.name,f.value[1].defaultValue=e.status,f.value[2].defaultValue=e.is_lock,h.value=!0}const _=[{type:"selection"},{title:"分类名称",key:"name",align:"center"},{title:"是否锁定",key:"is_lock",align:"center",render:a=>{const e=l(a.is_lock===1);return n(z,{value:e.value,"onUpdate:value":[o=>e.value=o,o=>{a.is_lock=o?1:2,g.value=a.id,D({...a,is_lock:o?1:2})}]},null)}},{title:"状态",key:"up_where",align:"center",render:a=>{const e=l(a.status===2);return n(z,{value:e.value,"onUpdate:value":[o=>e.value=o,o=>{a.status=o?2:1,g.value=a.id,D({...a,status:o?2:1})}]},null)}},{title:"创建时间",key:"create_time",align:"center"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:a=>{let e;return n(_e,{justify:"center"},{default:()=>[n(P,{type:"success",size:"small",onClick:q.bind(null,a.id)},T(e=c("common.modify"))?e:{default:()=>[e]}),n(he,{"onPositive-click":K.bind(null,a)},{default:()=>[c("common.confirmDelete")],trigger:()=>{let o;return n(P,{type:"error",size:"small"},T(o=c("common.delete"))?o:{default:()=>[o]})}})]})}}];async function G(){const{data:a}=await R();x({tableColumns:_,tableData:k(a),fileName:U})}function k(a){const e=a;return e.forEach(o=>{o.up_where}),e}const r=l([]),C=l([]);function Q(a){A.value=a,m.page=1,u()}function X(a,e){r.value=a,C.value=e}function Z(){b.value=!0}async function J(){if(i.value=!0,r.value.length===0){p.error("请选择要删除的数据"),i.value=!1;return}if(C.value.some(e=>e.is_lock===1)){p.error("锁定状态不可删除"),i.value=!1;return}const{response:a}=await pe({id:r.value.join(",")});a.data.status===200&&(u(),r.value=[],p.success(c("common.deleteSuccess")))}async function W(a){y.value=!0;const e={};a.up_where&&(e.up_where=a.up_where.join(","));const{response:o}=await fe({...a,...e});o.data.status===200&&(u(),p.success(c("common.addSuccess")),b.value=!1),y.value=!1}async function D(a){w.value=!0;const e={};a.up_where&&(e.up_where=a.up_where.join(","));const{response:o}=await ve(g.value,{...a,...e});o.data.status===200&&(u(),p.success(c("common.modifySuccess"))),h.value=!1,w.value=!1}function Y(a){m.page=a,u()}function ee(a){m.page=1,m.pageSize=a,u()}return u(),L.value=j(F.value),f.value=j(F.value),(a,e)=>{const o=se,ae=ne,te=xe,oe=ce,O=le;return re(),de("div",null,[n(oe,{title:"文章分类"},{"header-extra":V(()=>[n(o,{"export-all-loading":d(s),"onUpdate:exportAllLoading":e[0]||(e[0]=t=>M(s)?s.value=t:null),"refresh-button-loading":i.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=t=>i.value=t),"export-selected-disabled":r.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=t=>r.value.length=t),"batch-delete-disabled":r.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=t=>r.value.length=t),"export-filter-loading":d(s),"onUpdate:exportFilterLoading":e[4]||(e[4]=t=>M(s)?s.value=t:null),"export-selected-loading":d(s),"onUpdate:exportSelectedLoading":e[5]||(e[5]=t=>M(s)?s.value=t:null),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,onExportAll:G,onExportFilter:e[6]||(e[6]=t=>d(x)({tableColumns:_,tableData:k(S.value),fileName:U})),onExportSelected:e[7]||(e[7]=t=>d(x)({tableColumns:_,tableData:k(C.value),fileName:U})),onAdd:Z,onBatchDelete:J,onRefresh:u},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:V(()=>[n(ae,{"search-config":I.value,onOnSearch:Q},null,8,["search-config"]),n(te,{remote:"",columns:_,data:S.value,loading:i.value,bordered:!1,"max-height":600,"scroll-x":1e3,pagination:d(m),"row-key":t=>t.id,"render-cell":d($),"checked-row-keys":r.value,"onUpdate:checkedRowKeys":X,"onUpdate:page":Y,"onUpdate:pageSize":ee},null,8,["data","loading","pagination","row-key","render-cell","checked-row-keys"])]),_:1}),n(O,{"show-form-modal":b.value,"onUpdate:showFormModal":e[8]||(e[8]=t=>b.value=t),"is-async-shut-down":N.value,"onUpdate:isAsyncShutDown":e[9]||(e[9]=t=>N.value=t),"is-show-modal-loading":y.value,"onUpdate:isShowModalLoading":e[10]||(e[10]=t=>y.value=t),"modal-title":d(c)("common.add"),"modal-form-config":L.value,"form-rules":B,onOnSubmit:W},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),n(O,{"show-form-modal":h.value,"onUpdate:showFormModal":e[11]||(e[11]=t=>h.value=t),"is-async-shut-down":E.value,"onUpdate:isAsyncShutDown":e[12]||(e[12]=t=>E.value=t),"is-show-modal-loading":w.value,"onUpdate:isShowModalLoading":e[13]||(e[13]=t=>w.value=t),"modal-title":d(c)("common.modify"),"modal-form-config":f.value,"form-rules":B,onOnSubmit:D},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{Ie as default};
