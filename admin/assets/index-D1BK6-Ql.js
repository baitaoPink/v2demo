import{_ as be}from"./modal-form.vue_vue_type_script_setup_true_lang-tU3-hIUf.js";import{_ as _e}from"./search-header-BEaDoZth.js";import{_ as he}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-C-DfQuFh.js";import{d as we,O as xe,r as o,U as J,V as Ne,o as Y,b as ee,f as n,w as _,h as d,a1 as z,W as Se,g as A,$ as i,a4 as ke,K as De,X as Me,B as M,N as Ce,Z as Ue,a6 as Fe}from"./index-ClXc60Q8.js";import{a as te,b as Ee,s as Oe,m as Le,d as ze,c as Ae}from"./money-setting-DEiMSuL7.js";import{u as Ie,N as ae}from"./custom-table-DLqvKnHZ.js";import{_ as Re,u as Te}from"./custom-upload-D71Q5maP.js";import{u as Be}from"./exportExcel-BkPY8vZC.js";import{_ as I}from"./Flex-CESa1CD9.js";import{_ as je}from"./DataTable-C2iu46cC.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-Ddf5h8QK.js";import"./Grid-xFIQOVry.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-DwRTykPn.js";import"./Spin-B3LvPL2m.js";import"./DatePicker-uVn2PEEJ.js";import"./TimePicker-Kfakx9-p.js";import"./Forward-BysZYGA1.js";import"./RadioGroup-C9SrcqWM.js";import"./Space-BoszUUx1.js";const qe={key:0,class:"image-mask"};function R(N){return typeof N=="function"||Object.prototype.toString.call(N)==="[object Object]"&&!Ue(N)}const T="货币管理列表.xlsx",Ge=we({name:"system-config_currency-management",__name:"index",setup(N){const{pagination:m,renderCell:le}=Ie(),S=xe(),{exportExcel:C,exportLoading:u}=Be(),{handleUpload:oe}=Te(),p=o(!1),U=o([]),B=o(),ne=o([{type:"Input",valueName:"name",label:"名称"},{type:"Input",valueName:"name_zh",label:"简称"},{type:"Select",valueName:"status",label:"是否隐藏",defaultOption:[{value:"0",label:"隐藏"},{value:"1",label:"显示"}]},{type:"Select",valueName:"type",label:"货币类型",defaultOption:[{value:0,label:"无"},{value:1,label:"法币"},{value:2,label:"数字货币"}]}]),j=o([]),c=o({}),k=o(0),h=o(!1),q=o(!0),v=o(!1),F=o({is_lock:1}),w=o(!1),G=o(!0),y=o(!1),V=o([{type:"Input",valueName:"name_zh",label:"货币名称",i18n:!0,disabled:!1},{type:"Input",valueName:"money_type",label:"货币标识",disabled:!1},{type:"Input",valueName:"name",label:"英文简称",disabled:!1},{type:"Select",valueName:"type",label:"货币类型",disabled:!1,defaultOption:[{value:1,label:"法币"},{value:2,label:"数字货币"}]},{type:"Input",valueName:"exchange_rate",label:"汇率",disabled:!1},{type:"Slot",valueName:"icon_url",label:"logo",slotName:"icon_url"},{type:"Input Number",valueName:"sort",label:"排序",disabled:!1},{type:"Radio",valueName:"is_default",label:"默认币种",radioGroupOption:[{value:1,label:"是",disabled:!1},{value:0,label:"否",disabled:!1}]},{type:"Radio",valueName:"status",label:"状态",radioGroupOption:[{value:1,label:"开启",disabled:!1},{value:0,label:"隐藏",disabled:!1}]}]),$=o([]),E=o([]),O=o([]),P={name_zh:[{required:!0,trigger:["blur"],validator:(t,e)=>e?e.length>50?new Error("货币名称不可超过50字符"):!0:new Error("请输入货币名称")}],money_type:[{required:!0,message:"请输入货币标识",trigger:["blur"]}],name:[{required:!0,trigger:["blur"],validator:(t,e)=>e?e.length>30?new Error("英文简称不可超过30字符"):!0:new Error("请输入英文简称")}],type:[{required:!0,message:"请选择货币类型",type:"number",trigger:["blur"]}],exchange_rate:[{required:!0,trigger:["blur"],validator:(t,e)=>e?e<=0?new Error("请输入大于0的数"):!0:new Error("请输入汇率")}],icon_url:[{required:!0,message:"请上传logo",trigger:["blur"],validator:()=>c.value.icon_url?!0:new Error("请上传logo")}]};async function r(){p.value=!0;const{data:t}=await te({...B.value,page:m.page,limit:m.pageSize});U.value=t.list,m.itemCount=t.count,p.value=!1}async function se(t){p.value=!0;const{response:e}=await ze(t);e.data.status===200&&(r(),S.success(i("common.deleteSuccess")))}async function K({file:t,onFinish:e,onError:a,onProgress:s}){v.value=h.value,y.value=w.value;const b=await oe({file:t,onFinish:e,onError:a,onProgress:s});b&&(c.value.icon_url=b),v.value=!1,y.value=!1}function D(t){k.value,Reflect.deleteProperty(c.value,t)}async function H(t){k.value=t;const{data:e}=await Ae(t);F.value=e,O.value.forEach(a=>{a.i18n&&(a.i18nValue=e[`tplang_${a.valueName}`]),e.is_lock===1?(a.valueName!=="exchange_rate"&&(a.disabled=!0),(a.valueName==="is_default"||a.valueName==="status")&&a.radioGroupOption&&(a.radioGroupOption[0].disabled=!0,a.radioGroupOption[1].disabled=!0)):(a.disabled=!1,a.radioGroupOption&&(a.radioGroupOption[0].disabled=!1,a.radioGroupOption[1].disabled=!1)),a.defaultValue=e[a.valueName]}),e.icon_url&&(E.value=[{id:"icon_url",name:"logo",url:e.icon_url,status:"finished"}],c.value.icon_url=e.icon_url),w.value=!0}const x=[{type:"selection"},{title:"货币名称",key:"name_zh",align:"center",width:"120"},{title:"货币标识",key:"money_type",align:"center",width:"200"},{title:"类型  （数字货币 法币）",key:"type_name",align:"center",width:"200"},{title:"英文简称",key:"name",align:"center",width:"200"},{title:"logo",key:"icon_url",align:"center",width:"100",render:t=>n(De,{width:"100",src:t.icon_url},null)},{title:"汇率",key:"exchange_rate",align:"center",width:"100"},{title:"状态",key:"status",align:"center",width:"100",render:t=>{const e=o(t.status===1);return n(Me,{value:e.value,"onUpdate:value":[a=>e.value=a,a=>{t.status=a?1:0,k.value=t.id,Q({...t,status:a})}]},null)}},{title:"更新时间",key:"update_time",align:"center",width:"180"},{title:"是否默认币种",key:"is_default",align:"center",width:"130",render:t=>({0:"无",1:"是",2:"否"})[t.is_default]},{title:"排序",key:"sort",align:"center",width:"120"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:t=>{let e,a;return n(I,{justify:"center"},{default:()=>[t.is_lock===1?n(I,{justify:"center"},{default:()=>[n(M,{type:"success",size:"small",onClick:H.bind(null,t.id)},R(e=i("common.modify"))?e:{default:()=>[e]}),n(ae,null,{default:()=>[i("common.confirmDelete")],trigger:()=>n(M,{size:"small",disabled:t.is_lock===1},{default:()=>[A("系统默认")]})})]}):n(I,{justify:"center"},{default:()=>[n(M,{type:"success",size:"small",disabled:t.is_lock===1,onClick:H.bind(null,t.id)},R(a=i("common.modify"))?a:{default:()=>[a]}),n(ae,{"onPositive-click":se.bind(null,t.id)},{default:()=>[i("common.confirmDelete")],trigger:()=>{let s;return n(M,{type:"error",size:"small",disabled:t.is_lock===1},R(s=i("common.delete"))?s:{default:()=>[s]})}})]})]})}}];async function ie(){var a;const{data:t}=await te(),e=(a=t.list)==null?void 0:a.map(s=>{const b={0:"无",1:"是",2:"否"};return{...s,status:s.status===1?"显示":"隐藏",is_default:b[s.is_default]}});C({tableColumns:x,tableData:e??[],fileName:T})}const f=o([]),X=o([]);function ue(t){B.value=t,m.page=1,r()}function re(t,e){f.value=t,X.value=e}function de(){h.value=!0}async function me(){p.value=!0;const{response:t}=await Ee({id:f.value.join(",")});t.data.status===200&&(r(),f.value=[],S.success(i("common.deleteSuccess")))}async function ce(t){v.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:a}=await Oe({...t,...e,status:t.status?1:0,icon_url:c.value.icon_url,...c.value});a.data.status===200&&(r(),S.success(i("common.addSuccess")),h.value=!1),D("icon_url"),v.value=!1}async function Q(t){y.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:a}=await Le(k.value,{...t,...e,status:t.status?1:0,...c.value});a.data.status===200&&(r(),S.success(i("common.modifySuccess")),w.value=!1),D("icon_url"),y.value=!1}function pe(t){m.page=t,r()}function fe(t){m.page=1,m.pageSize=t,r()}r(),$.value=J(V.value),O.value=J(V.value);const ge=o(x.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const a=he,s=_e,b=je,ve=Ce,W=Re,Z=be,ye=Ne("resize");return Y(),ee("div",null,[n(ve,{title:"货币管理列表"},{"header-extra":_(()=>[n(a,{"export-all-loading":d(u),"onUpdate:exportAllLoading":e[0]||(e[0]=l=>z(u)?u.value=l:null),"refresh-button-loading":p.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=l=>p.value=l),"export-selected-disabled":f.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=l=>f.value.length=l),"batch-delete-disabled":f.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=l=>f.value.length=l),"export-filter-loading":d(u),"onUpdate:exportFilterLoading":e[4]||(e[4]=l=>z(u)?u.value=l:null),"export-selected-loading":d(u),"onUpdate:exportSelectedLoading":e[5]||(e[5]=l=>z(u)?u.value=l:null),onExportAll:ie,onExportFilter:e[6]||(e[6]=l=>{d(C)({tableColumns:x,tableData:U.value.map(g=>{const L={0:"无",1:"是",2:"否"};return{...g,status:g.status===1?"显示":"隐藏",is_default:L[g.is_default]}}),fileName:T})}),onExportSelected:e[7]||(e[7]=l=>{d(C)({tableColumns:x,tableData:X.value.map(g=>{const L={0:"无",1:"是",2:"否"};return{...g,status:g.status===1?"显示":"隐藏",is_default:L[g.is_default]}}),fileName:T})}),onAdd:de,onBatchDelete:me,onRefresh:r},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:_(()=>[n(s,{"search-config":ne.value,onOnSearch:ue},null,8,["search-config"]),Se(n(b,{remote:"",columns:x,data:U.value,loading:p.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":ge.value,pagination:d(m),"row-key":l=>l.id,"render-cell":d(le),"onUpdate:checkedRowKeys":re,"onUpdate:page":pe,"onUpdate:pageSize":fe},null,8,["data","loading","scroll-x","pagination","row-key","render-cell"]),[[ye]])]),_:1}),n(Z,{"show-form-modal":h.value,"onUpdate:showFormModal":e[10]||(e[10]=l=>h.value=l),"is-async-shut-down":q.value,"onUpdate:isAsyncShutDown":e[11]||(e[11]=l=>q.value=l),"is-show-modal-loading":v.value,"onUpdate:isShowModalLoading":e[12]||(e[12]=l=>v.value=l),"is-show-modal-form-i18n":!0,"modal-title":d(i)("common.add"),"modal-form-config":$.value,"form-rules":P,onOnSubmit:ce},{icon_url:_(()=>[n(W,{"file-list":j.value,"onUpdate:fileList":e[8]||(e[8]=l=>j.value=l),"list-type":"image-card",max:1,accept:"image/*","custom-request":K,onRemove:e[9]||(e[9]=l=>D("icon_url"))},{default:_(()=>e[18]||(e[18]=[A(" 点击上传 ")])),_:1},8,["file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),n(Z,{"show-form-modal":w.value,"onUpdate:showFormModal":e[15]||(e[15]=l=>w.value=l),"is-async-shut-down":G.value,"onUpdate:isAsyncShutDown":e[16]||(e[16]=l=>G.value=l),"is-show-modal-loading":y.value,"onUpdate:isShowModalLoading":e[17]||(e[17]=l=>y.value=l),"is-show-modal-form-i18n":!0,"modal-title":d(i)("common.modify"),"modal-form-config":O.value,"form-rules":P,onOnSubmit:Q},{icon_url:_(()=>[F.value&&F.value.is_lock===1?(Y(),ee("div",qe)):ke("",!0),n(W,{"default-file-list":E.value,"onUpdate:defaultFileList":e[13]||(e[13]=l=>E.value=l),"list-type":"image-card","custom-request":K,max:1,accept:"image/*",onRemove:e[14]||(e[14]=l=>D("icon_url"))},{default:_(()=>e[19]||(e[19]=[A(" 点击上传 ")])),_:1},8,["default-file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}}),rt=Fe(Ge,[["__scopeId","data-v-be2424fe"]]);export{rt as default};
