import{_ as re}from"./modal-form.vue_vue_type_script_setup_true_lang-P1z5yclz.js";import{_ as de}from"./search-header-D_blBfvw.js";import{_ as ce}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CRfXQ-ba.js";import{d as me,r as o,O as fe,U as q,V as pe,o as ge,b as ve,f as l,w as d,h as p,B as U,g as x,W as $,$ as i,a8 as j,K as ye,Y as be,N as _e,Z as he}from"./index-CYDGqEQI.js";import{a as we,g as Se,e as ke,b as Me,d as Ce,c as Ne,f as Fe,h as Ue}from"./systen-configuration-CkAgXwg9.js";import{u as xe,N as De}from"./custom-table-B3DGB95j.js";import{_ as Le,u as Oe}from"./custom-upload-2G2myZ9i.js";import{_ as Re}from"./Flex-BZMv6Qv4.js";import{_ as Ve}from"./DataTable-CYp14RVL.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-B08Imzic.js";import"./Grid-D4YcV8OK.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-B3v3fzMP.js";import"./Spin-Ca-vK6CT.js";import"./DatePicker-BtnAIrHe.js";import"./TimePicker-BHOJ7N6u.js";import"./Forward-BP90BV3h.js";import"./RadioGroup-C6Ct6ciA.js";import"./Space-jg1obvb8.js";function E(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!he(g)}const et=me({name:"system-config_custom-info_service_manage",__name:"index",setup(g){const{pagination:u,renderCell:K}=xe(),m=o([]),D=o([]),f=fe(),{handleUpload:G}=Oe(),k=o(0),L=o({}),O=o([{type:"Input",valueName:"title",label:"名称",placeholder:"请输入名称"},{type:"Select",valueName:"category_code",label:"分类",placeholder:"请选择分类",selectLabelField:"name",selectValueField:"value"},{type:"Select",valueName:"status",label:"是否开启",defaultOption:[{value:1,label:"开启"},{value:2,label:"关闭"}]}]),H=[{type:"selection"},{title:"名称",key:"name",align:"center"},{title:"分类",key:"category_name",align:"center"},{title:"是否开启",key:"status",align:"center",render:t=>l(j,{type:t.status===2?"error":"success"},{default:()=>[t.status===2?"隐藏":"显示"]})},{title:"类型",key:"type",align:"center",render:t=>t.type===1?"内置":"非内置菜单"},{title:"logo",key:"icon_url",align:"center",render:t=>l(ye,{width:"100",src:t.icon_url},null)},{title:"链接类型",key:"link_type",align:"center",render:t=>l(j,{type:t.link_type===1?"primary":"success"},{default:()=>[t.link_type===1?"站内":"外链"]})},{title:"链接",key:"link",align:"center"},{title:"排序",key:"sort",align:"center"},{title:"创建时间",key:"create_time",align:"center"},{title:"修改时间",key:"update_time",align:"center"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:t=>{let e;return l(Re,{justify:"center"},{default:()=>[l(U,{type:"success",size:"small",onClick:Y.bind(null,t.id)},E(e=i("common.modify"))?e:{default:()=>[e]}),$(l("div",null,[l(De,{"onPositive-click":ae.bind(null,t.id)},{default:()=>[i("common.confirmDelete")],trigger:()=>{let n;return l(U,{type:"error",size:"small"},E(n=i("common.delete"))?n:{default:()=>[n]})}})]),[[be,t.type===2]])]})}}],R=o([]),r=o(!1),c=o({}),M=o([]),C=o([]),v=o(!1),V=o(!0),y=o(!1),b=o(!1),z=o(!0),_=o(!1),A=o([{type:"Input",valueName:"name",label:"名称",i18n:!0},{type:"Select",valueName:"category_code",label:"分类",placeholder:"请选择分类",selectLabelField:"name",selectValueField:"value"},{type:"Slot",valueName:"icon",slotName:"icon",label:"logo"},{type:"Radio",valueName:"link_type",label:"链接类型",radioGroupOption:[{label:"站内",value:1},{value:2,label:"外链"}]},{type:"Input",valueName:"link",label:"链接"},{type:"Input Number",valueName:"sort",label:"排序"},{type:"Switch",valueName:"status",label:"是否开启",switchChecked:1,switchUnchecked:2,switchCheckedText:"开启",switchUncheckedText:"关闭"}]),N=o([]),h=o([]),I={name:[{required:!0,message:"请输入名称",trigger:["blur"]}],category_code:[{required:!0,message:"请选择分类",trigger:["blur"]}],icon:[{required:!0,message:"请上传logo",trigger:["blur"],validator:()=>c.value.icon?!0:new Error("请上传logo")}]};async function Q(t){y.value=!0;const{response:e}=await we({...t,...c.value});e.data.status===200&&(s(),f.success(i("common.addSuccess")),v.value=!1),y.value=!1}function W(){w("icon"),M.value=[]}async function Y(t){k.value=t;const{data:e}=await Se(t);e&&(h.value.forEach(n=>{n.i18n&&(n.i18nValue=e.tplang_name),n.disabled=n.valueName!=="icon"&&e.type===1,n.valueName==="type"&&(n.disabled=!0),n.defaultValue=e[n.valueName]}),e.icon&&(C.value=[{id:"icon",name:"icon",url:e.icon_url,status:"finished"}]),c.value.icon=e.icon,b.value=!0)}async function Z(t){_.value=!0;const{response:e}=await ke(k.value,{...t,...c.value});e.data.status===200&&(s(),f.success(i("common.modifySuccess")),b.value=!1,w("icon")),_.value=!1}function J(t){L.value=t,u.page=1,s()}async function T({file:t,onFinish:e,onError:n,onProgress:F}){const S=await G({file:t,onFinish:e,onError:n,onProgress:F});S&&(c.value.icon=S)}function w(t){k.value,Reflect.deleteProperty(c.value,t)}function X(t,e){m.value=t,D.value=e}async function s(){r.value=!0;const{data:t}=await Me({page:u.page,limit:u.pageSize,...L.value});R.value=t.list,u.itemCount=t.count,r.value=!1}function ee(t){u.page=t,s()}function te(t){u.page=1,u.pageSize=t,s()}async function ae(t){r.value=!0;const{response:e}=await Ce(t);e.data.status===200&&(s(),f.success(i("common.deleteSuccess")))}function oe(){v.value=!0}async function le(){if(D.value.filter(e=>e.type===1).length)f.error("只可删除非内置菜单数据");else{r.value=!0;const{response:e}=await Ne({id:m.value.join(",")});e.data.status===200&&(s(),m.value=[],f.success(i("common.deleteSuccess")))}}async function ne(){const{data:t}=await Fe();O.value[1].defaultOption=t,N.value[1].defaultOption=t,h.value[1].defaultOption=t}async function se(){r.value=!0;const{response:t}=await Ue();t.data.status===200&&(s(),m.value=[],f.success("恢复成功"))}return s(),ne(),N.value=q(A.value),h.value=q(A.value),(t,e)=>{const n=ce,F=de,S=Ve,ie=_e,B=Le,P=re,ue=pe("resize");return ge(),ve("div",null,[l(ie,{title:"服务管理"},{"header-extra":d(()=>[l(n,{"refresh-button-loading":r.value,"onUpdate:refreshButtonLoading":e[0]||(e[0]=a=>r.value=a),"batch-delete-disabled":m.value.length,"onUpdate:batchDeleteDisabled":e[1]||(e[1]=a=>m.value.length=a),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,"slot-name":"bars",onAdd:oe,onBatchDelete:le,onRefresh:s},{bars:d(()=>[l(p(U),{size:"small",ghost:"",type:"success",onClick:se},{default:d(()=>e[12]||(e[12]=[x("一键恢复")])),_:1})]),_:1},8,["refresh-button-loading","batch-delete-disabled"])]),default:d(()=>[l(F,{"search-config":O.value,onOnSearch:J},null,8,["search-config"]),$(l(S,{remote:"",columns:H,data:R.value,loading:r.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":1e3,pagination:p(u),"row-key":a=>a.id,"render-cell":p(K),"onUpdate:checkedRowKeys":X,"onUpdate:page":ee,"onUpdate:pageSize":te},null,8,["data","loading","pagination","row-key","render-cell"]),[[ue]])]),_:1}),l(P,{"show-form-modal":v.value,"onUpdate:showFormModal":e[4]||(e[4]=a=>v.value=a),"is-async-shut-down":V.value,"onUpdate:isAsyncShutDown":e[5]||(e[5]=a=>V.value=a),"is-show-modal-loading":y.value,"onUpdate:isShowModalLoading":e[6]||(e[6]=a=>y.value=a),"is-show-modal-form-i18n":!0,"modal-title":p(i)("common.add"),"modal-form-config":N.value,"form-rules":I,onOnSubmit:Q,onOnClose:W},{icon:d(()=>[l(B,{"file-list":M.value,"onUpdate:fileList":e[2]||(e[2]=a=>M.value=a),"list-type":"image-card",max:1,accept:"image/*","custom-request":T,onRemove:e[3]||(e[3]=a=>w("icon"))},{default:d(()=>e[13]||(e[13]=[x(" 点击上传 ")])),_:1},8,["file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),l(P,{"show-form-modal":b.value,"onUpdate:showFormModal":e[9]||(e[9]=a=>b.value=a),"is-async-shut-down":z.value,"onUpdate:isAsyncShutDown":e[10]||(e[10]=a=>z.value=a),"is-show-modal-loading":_.value,"onUpdate:isShowModalLoading":e[11]||(e[11]=a=>_.value=a),"is-show-modal-form-i18n":!0,"modal-title":p(i)("common.modify"),"modal-form-config":h.value,"form-rules":I,onOnSubmit:Z},{icon:d(()=>[l(B,{"file-list":C.value,"onUpdate:fileList":e[7]||(e[7]=a=>C.value=a),"list-type":"image-card",max:1,accept:"image/*","custom-request":T,onRemove:e[8]||(e[8]=a=>w("icon"))},{default:d(()=>e[14]||(e[14]=[x(" 点击上传 ")])),_:1},8,["file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{et as default};
