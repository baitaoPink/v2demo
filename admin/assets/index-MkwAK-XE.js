import{_ as Ke}from"./modal-form.vue_vue_type_script_setup_true_lang-Dy9QZ-_Q.js";import{_ as Qe}from"./search-header-Bd_P8bYc.js";import{_ as We}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-Dgu6301U.js";import{d as Ye,O as Ze,r as s,V as Je,o as g,b as O,f as o,w as r,h as d,a1 as A,W as H,g as b,S as V,ac as j,Y as ce,e as i,B as K,t as z,$ as E,a8 as Q,U as W,cs as Y,N as Xe,bq as ea,Z as aa,c as me,a5 as la,x as ta}from"./index-BBCpP0n1.js";import{q as na,r as oa}from"./user-manage-Bjhd-ysC.js";import{s as ua}from"./systen-configuration-BXo5j3rG.js";import{n as ra,o as ve,p as sa,f as ia}from"./mentor-management-9ycqJ4m2.js";import{u as pa}from"./custom-table-CJkQvjHs.js";import{_ as da,u as ca}from"./custom-upload-DNH0sEWs.js";import{u as ma}from"./exportExcel-BAy9H5VN.js";import{_ as va}from"./Flex-Bs4QGOKB.js";import{_ as _a}from"./DataTable-fKfSlOiD.js";import{_ as fa}from"./Space-ClliFbbY.js";import{a as ya,_ as ga}from"./RadioGroup-bApoAqR8.js";import{b as ba}from"./multi-language-form.vue_vue_type_script_setup_true_lang-jF9EEona.js";import{_ as ha}from"./Grid-DHXffSDg.js";import{a as Na}from"./FormItem-BK_iw_zi.js";import{_ as xa}from"./Table-DtvcD53q.js";import"./DatePicker-CCmjyMFz.js";import"./TimePicker-DO5RqnqW.js";import"./Forward-C99TIi_5.js";import"./Spin-B2L8Uchv.js";import"./get-slot-Bk_rJcZu.js";const ka={class:"w-230px"},wa={class:"w-240px"},Ua={class:"w-230px"},Sa={class:"w-230px"},Ca={class:"w-230px"};function Oa(M){return typeof M=="function"||Object.prototype.toString.call(M)==="[object Object]"&&!aa(M)}const Z="导师列表.xlsx",Ja=Ye({name:"mentor-management_mentor-list",__name:"index",setup(M){const{pagination:y,renderCell:_e}=pa(),{handleUpload:fe}=ca(),{exportExcel:q,exportLoading:m}=ma(),U=Ze(),J=s([]),X=s([]),v=s(1),ye=[{label:"每日跟单",value:1},{label:"多日跟单",value:2}],h=s(0),ge=[{label:"通用类型",value:1},{label:"层级类型",value:2}],N=s(0),x=s(0),_=s([]),be=s([{type:"Input",valueName:"account",label:"登录名",placeholder:"请输入登录名"},{type:"Input",valueName:"account",label:"账号/姓名",placeholder:"请输入账号/姓名"},{type:"Input",valueName:"name",label:"导师名称",placeholder:"请输入导师名称"},{type:"Input",valueName:"level_name",label:"级别",placeholder:"请输入级别"},{type:"Datetime",valueName:"time",label:"申请时间",placeholder:"请选择申请时间",datetimeType:"datetimerange"}]),R=[{type:"selection"},{title:"账号/姓名",key:"user_account",align:"center",render:t=>o("div",null,[o("p",null,[t.user_account]),o("p",null,[t.real_name])])},{title:"备注",key:"remark",align:"center"},{title:"导师名称",key:"name",align:"center",width:"120",render:t=>`${t.name||""}(${t.market_type_name},${t.money_type})`},{title:"级别",key:"level_name",align:"center"},{title:"操盘经验",key:"experience",align:"center"},{title:"最低投资金额",key:"min_money",align:"center"},{title:"最高投资金额",key:"max_money",align:"center"},{title:"佣金比例",key:"divide_into",align:"center"},{title:"跟单类型",key:"type",align:"center",render:t=>t.type===1?"每日跟单":"多日跟单"},{title:"产品类型",key:"product_name",align:"center"},{title:"币种市场",key:"market_type_name",align:"center",render:t=>o("span",null,[t.market_type_name?t.market_type_name:t.market_type])},{title:"是否热门",key:"is_hot",align:"center",render:t=>t.is_hot===0?o(Q,{type:"info"},{default:()=>[b("无")]}):t.is_hot===1?o(Q,{type:"error"},{default:()=>[b("是")]}):o(Q,{type:"success"},{default:()=>[b("否")]})},{title:"创建时间",key:"create_time",align:"center"},{title:"操作",key:"action",align:"center",fixed:"right",render:t=>{let e;return o(va,{justify:"center"},{default:()=>[o(K,{type:"success",size:"small",onClick:De.bind(null,t.id,t.uid)},Oa(e=E("common.modify"))?e:{default:()=>[e]})]})}}],F=s([]),ee=s([]),$=s(!1),B=s([]),ae=s({}),he=["min_money","max_money","divide_into","total_revenue","monthly_revenue","position","max_rollback","win_rate","price"],Ne=["vips"],le=["tags"],xe=["divide_into","asset_scale","return_rate","pnl_ratio","win_rate","follow_user_pnl","avg_pnl","trader_pnl","week_order_number","day7_pnl_amount","day7_user_pnl_amount","day7_rollback_ratio","day7_return_ratio","day50_return_ratio","day30_rollback_ratio"],te=s(0),ne=s(0),k=s({}),L=s([]),T=s(!1),oe=s(!0),f=s(!1),D=s([{type:"Input",valueName:"account",label:"账号",disabled:!0},{type:"Slot",valueName:"avatar",label:"头像",slotName:"avatar"},{type:"Input",valueName:"product_name",label:"产品名称"},{type:"Input",valueName:"name",label:"讲师名称",i18n:!0},{type:"Input",valueName:"experience",label:"操盘经验"},{type:"Input",valueName:"explain",label:"个人名言",i18n:!0},{type:"Input Number",valueName:"divide_into",label:"佣金比例"},{type:"Input Number",valueName:"total_revenue",label:"总收益率"},{type:"Input Number",valueName:"monthly_revenue",label:"月收益率"},{type:"Input Number",valueName:"position",label:"仓位率"},{type:"Input Number",valueName:"max_rollback",label:"最大回撤率"},{type:"Input Number",valueName:"win_rate",label:"回报率"},{type:"Slot",valueName:"type",label:"跟单类型",slotName:"type"},{type:"Select",valueName:"category_code",label:"导师分类",placeholder:"请选择导师分类",defaultOption:[],selectLabelField:"name",selectValueField:"value"},{type:"Slot",valueName:"typeConfig",slotName:"typeConfig",gridGiSpan:24},{type:"Input Number",valueName:"stable_value",label:"稳定性指数"},{type:"Radio",valueName:"is_hot",label:"是否热门",radioGroupOption:[{label:"否",value:2},{label:"是",value:1}]},{type:"Tag Select",valueName:"tags",label:"标签",placeholder:"请输入标签，按空格确认",i18n:!0},{type:"Input Number",valueName:"follow_number",label:"跟单人数"},{type:"Input Number",valueName:"max_follow_number",label:"跟单最高人数"},{type:"Input Number",valueName:"price",label:"跟单所需金额"},{type:"Multiple Select",valueName:"vips",label:"跟单用户等级",placeholder:"请选择跟单用户等级",defaultOption:[],selectLabelField:"name",selectValueField:"value"},{type:"Switch",valueName:"status",label:"状态",switchChecked:1,switchUnchecked:0,switchCheckedText:"启用",switchUncheckedText:"禁用"},{type:"Select",valueName:"market_type_id",label:"股市类型",placeholder:"请选择股市类型",defaultOption:[],selectLabelField:"name",selectValueField:"id"},{type:"Slot",valueName:"statistics_data",label:"统计数据",slotName:"statistics_data",gridGiSpan:24}]),ke={avatar:[{required:!0,message:"请上传头像",trigger:["blur"],validator:()=>k.value.avatar?!0:new Error("请上传头像")}],vips:[{type:"array",required:!0,message:"请选择跟单用户等级",trigger:["blur"]}],market_type_id:[{type:"number",required:!0,message:"请选择股市类型",trigger:["blur"]}]},p=s({}),we=[{name:"分润",fields:"divide_into",placeholder:"请输入分润"},{name:"资产管理规模",fields:"asset_scale",placeholder:"请输入资产管理规模"},{name:"回报率",fields:"return_rate",placeholder:"请输入回报率"},{name:"盈亏比例",fields:"pnl_ratio",placeholder:"请输入盈亏比例"},{name:"胜率",fields:"win_rate",placeholder:"请输入胜率"},{name:"跟单用户盈亏",fields:"follow_user_pnl",placeholder:"请输入跟单用户盈亏"},{name:"每笔交易平均盈亏",fields:"avg_pnl",placeholder:"请输入每笔交易平均盈亏"},{name:"交易达人盈亏",fields:"trader_pnl",placeholder:"请输入交易达人盈亏"},{name:"累计收益率",type:"Input",fields:"accumulated_return_rate",placeholder:"请输入累计收益率，用英文逗号隔开"},{name:"累计收益额",type:"Input",fields:"daily_profit",placeholder:"请输入累计收益额，用英文逗号隔开"},{name:"每日盈亏",type:"Input",fields:"daily_pnl",placeholder:"请输入每日盈亏，用英文逗号隔开"}];function Ue(){_.value.forEach(t=>{t.partner_ids=null})}async function Se(t){f.value=!0;const e={};let a={};if(Object.keys(k.value).length===1&&(e.avatar=k.value.avatar),t.tags){const u=W(t.tags);for(const I in u)Object.hasOwn(u,I)&&(u[I]=u[I].join(","));e.tags=u}if(t.vips&&(e.vips=t.vips.join(",")),Object.keys(p.value).length&&(a={...p.value},a.accumulated_return_rate=Y(a.accumulated_return_rate),a.daily_profit=Y(a.daily_profit),a.daily_pnl=Y(a.daily_pnl)),v.value===1){if(typeof N.value!="number")return f.value=!1,U.error("请输入最低投资金额");if(typeof x.value!="number")return f.value=!1,U.error("请输入最高投资金额");if(x.value<N.value)return f.value=!1,U.error("最高投资金额不能小于最低投资金额");e.min_money=N.value,e.max_money=x.value}else if(v.value===2){if(!_.value.length)return f.value=!1,U.error("请配置跟买产品");if(!Object.values(_.value).some(u=>Object.values(u).includes(null)))e.product_type=h.value,e.product=W(_.value),h.value===1&&e.product.forEach(u=>{u.partner_ids=u.partner_ids.join(",")});else return f.value=!1,U.error("请配置跟买产品")}const{response:n}=await ra(te.value,{uid:ne.value,...t,...e,type:v.value,statistics_data:a});n.data.status===200&&(S(),U.success(E("common.modifySuccess")),T.value=!1),f.value=!1}function Ce(){v.value=1,p.value={},_.value=[],h.value=0,N.value=0,x.value=0,ue(),k.value={},L.value=[]}async function S(){$.value=!0;const{data:t}=await ve({page:y.page,limit:y.pageSize,...ae.value});B.value=t.list,y.itemCount=t.count,$.value=!1}function Oe(t){y.page=t,S()}function Fe(t){y.page=1,y.pageSize=t,S()}async function $e(){const{data:t}=await ve();q({tableColumns:R,tableData:P(t.list),fileName:Z})}function P(t){const e=W(t);return e.forEach(a=>{if(Reflect.has(a,"user_account")&&(a.user_account=`
      账号:${a.user_account?a.user_account:"/"};
      姓名:${a.real_name?a.real_name:"/"};`),Reflect.has(a,"name")&&(a.name=`${a.name||""}(${a.market_type_name},${a.money_type})`),Reflect.has(a,"type")&&(a.type=a.type===1?"每日跟单":"多日跟单"),Reflect.has(a,"market_type_name")&&(a.market_type_name=a.market_type_name?a.market_type_name:a.market_type),Reflect.has(a,"is_hot"))switch(a.is_hot){case 1:a.is_hot="无";break;case 2:a.is_hot="是";break;case 3:a.is_hot="否";break;default:a.is_hot="/";break}}),e}async function De(t,e){te.value=t,ne.value=e;const{data:a}=await sa(t);D.value.forEach(n=>{if(n.i18n&&le.includes(n.valueName)&&a[n.valueName])if(a[`tplang_${n.valueName}`]){n.i18nValue={};for(const u in a[`tplang_${n.valueName}`])Object.hasOwn(a[`tplang_${n.valueName}`],u)&&(n.i18nValue[u]=a[`tplang_${n.valueName}`][u].split(","))}else n.i18nValue=a[`tplang_${n.valueName}`];else n.i18n&&(n.i18nValue=a[`tplang_${n.valueName}`]);he.includes(n.valueName)&&(a[n.valueName]=Number(a[n.valueName])),Ne.includes(n.valueName)&&a[n.valueName]&&(a[n.valueName]=a[n.valueName].split(",").map(u=>Number(u))),le.includes(n.valueName)&&a[n.valueName]&&(a[n.valueName]=a[n.valueName].split(",")),n.defaultValue=a[n.valueName]}),a.avatar&&(L.value=[{id:"avatar",name:"头像",url:a.avatar,status:"finished"}],k.value.avatar=a.avatar),a.statistics_data&&(p.value=a.statistics_data,xe.forEach(n=>{p.value[n]=Number(p.value[n])})),a.product&&a.product.length&&a.product.forEach(n=>{_.value.push({day:n.day,partner_ids:a.product_type===1?n.partner_ids.split(",").map(u=>Number(u)):Number(n.partner_ids),min_money:Number(n.min_money),max_money:Number(n.max_money),commission_rate:Number(n.commission_rate)})}),v.value=a.type,N.value=Number(a.min_money),x.value=Number(a.max_money),h.value=a.product_type,T.value=!0}function Ie(){_.value.push({day:null,partner_ids:null,min_money:null,max_money:null,commission_rate:null})}function Ee(t){_.value.splice(t,1)}function Me(t){const e={...t};t.time&&(e.start_create_time=t.time[0],e.end_create_time=t.time[1],Reflect.deleteProperty(e,"time")),ae.value=e,y.page=1,S()}function Re(t,e){F.value=t,ee.value=e}async function Le({file:t,onFinish:e,onError:a,onProgress:n}){const u=await fe({file:t,onFinish:e,onError:a,onProgress:n});u&&(k.value.avatar=u)}function ue(){Reflect.deleteProperty(k.value,"avatar")}async function Te(){const{data:t}=await na();J.value=t,D.value[21].defaultOption=J.value}async function Ve(){const{data:t}=await ua();D.value[23].defaultOption=t.list}async function je(){const{data:t}=await oa();X.value=t}async function ze(){const{data:t}=await ia();D.value[13].defaultOption=t}return S(),Te(),Ve(),je(),ze(),(t,e)=>{const a=We,n=Qe,u=_a,I=Xe,qe=da,re=ga,se=fa,ie=ya,w=ea,G=ba,pe=ha,de=Na,Be=la,Pe=xa,Ge=ta,Ae=Ke,He=Je("resize");return g(),O("div",null,[o(I,{title:"导师列表"},{"header-extra":r(()=>[o(a,{"export-all-loading":d(m),"onUpdate:exportAllLoading":e[0]||(e[0]=l=>A(m)?m.value=l:null),"export-filter-loading":d(m),"onUpdate:exportFilterLoading":e[1]||(e[1]=l=>A(m)?m.value=l:null),"export-selected-loading":d(m),"onUpdate:exportSelectedLoading":e[2]||(e[2]=l=>A(m)?m.value=l:null),"refresh-button-loading":$.value,"onUpdate:refreshButtonLoading":e[3]||(e[3]=l=>$.value=l),"export-selected-disabled":F.value.length,"onUpdate:exportSelectedDisabled":e[4]||(e[4]=l=>F.value.length=l),"batch-delete-disabled":F.value.length,"onUpdate:batchDeleteDisabled":e[5]||(e[5]=l=>F.value.length=l),"is-export-all":!0,"is-export-filter":!0,"is-export-selected":!0,"is-batch-delete":!1,"is-add":!1,onExportAll:$e,onExportFilter:e[6]||(e[6]=l=>d(q)({tableColumns:R,tableData:P(B.value),fileName:Z})),onExportSelected:e[7]||(e[7]=l=>d(q)({tableColumns:R,tableData:P(ee.value),fileName:Z})),onRefresh:S},null,8,["export-all-loading","export-filter-loading","export-selected-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled"])]),default:r(()=>[o(n,{"search-config":be.value,onOnSearch:Me},null,8,["search-config"]),H(o(u,{remote:"",columns:R,data:B.value,pagination:d(y),loading:$.value,bordered:!1,style:{height:"560px"},"flex-height":"","scroll-x":2200,"row-key":l=>l.id,"render-cell":d(_e),"onUpdate:checkedRowKeys":Re,"onUpdate:page":Oe,"onUpdate:pageSize":Fe},null,8,["data","pagination","loading","row-key","render-cell"]),[[He]])]),_:1}),o(Ae,{"show-form-modal":T.value,"onUpdate:showFormModal":e[13]||(e[13]=l=>T.value=l),"is-async-shut-down":oe.value,"onUpdate:isAsyncShutDown":e[14]||(e[14]=l=>oe.value=l),"is-show-modal-loading":f.value,"onUpdate:isShowModalLoading":e[15]||(e[15]=l=>f.value=l),"is-show-modal-form-i18n":!0,"modal-title":d(E)("common.modify"),"width-class":"w-1200px","modal-form-config":D.value,"grid-gi-span":12,"form-rules":ke,onOnSubmit:Se,onOnClose:Ce},{avatar:r(()=>[o(qe,{"file-list":L.value,"onUpdate:fileList":e[8]||(e[8]=l=>L.value=l),"list-type":"image-card",max:1,accept:"image/*","custom-request":Le,onRemove:ue},{default:r(()=>e[16]||(e[16]=[b(" 点击上传 ")])),_:1},8,["file-list"])]),type:r(()=>[o(ie,{value:v.value,"onUpdate:value":e[9]||(e[9]=l=>v.value=l),name:"radiogroup"},{default:r(()=>[o(se,null,{default:r(()=>[(g(),O(V,null,j(ye,l=>o(re,{key:l.label,value:l.value},{default:r(()=>[b(z(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["value"])]),typeConfig:r(()=>[H(i("div",null,[o(de,{"label-width":"auto","label-placement":"left","show-require-mark":"",model:p.value},{default:r(()=>[o(pe,{cols:24,"x-gap":24},{default:r(()=>[o(G,{span:12,label:"最低投资金额",path:"min_money"},{default:r(()=>[o(w,{value:N.value,"onUpdate:value":e[10]||(e[10]=l=>N.value=l),clearable:"",validator:l=>l>=0,placeholder:"请输入最低投资金额"},null,8,["value","validator"])]),_:1}),o(G,{span:12,label:"最高投资金额",path:"max_money"},{default:r(()=>[o(w,{value:x.value,"onUpdate:value":e[11]||(e[11]=l=>x.value=l),clearable:"",validator:l=>l>=0,placeholder:"请输入最高投资金额"},null,8,["value","validator"])]),_:1})]),_:1})]),_:1},8,["model"])],512),[[ce,v.value===1]]),H(i("div",null,[e[18]||(e[18]=i("div",{class:"m-b-10px color-#1f2225"},"产品类型",-1)),o(ie,{value:h.value,"onUpdate:value":[e[12]||(e[12]=l=>h.value=l),Ue],name:"radiogroup"},{default:r(()=>[o(se,null,{default:r(()=>[(g(),O(V,null,j(ge,l=>o(re,{key:l.label,value:l.value},{default:r(()=>[b(z(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["value"]),e[19]||(e[19]=i("div",{class:"m-t-10px color-#1f2225"},"跟买产品",-1)),o(Pe,{class:"m-t-10px","single-line":!1},{default:r(()=>[e[17]||(e[17]=i("thead",null,[i("tr",null,[i("th",{class:"!text-align-center"},"交易日"),i("th",{class:"!text-align-center"},"层级"),i("th",{class:"!text-align-center"},"最小投入金额"),i("th",{class:"!text-align-center"},"最大投入金额"),i("th",{class:"!text-align-center"},"佣金比例"),i("th",{class:"!text-align-center"},"操作")])],-1)),i("tbody",null,[(g(!0),O(V,null,j(_.value,(l,C)=>(g(),O("tr",{key:C},[i("td",ka,[o(w,{value:l.day,"onUpdate:value":c=>l.day=c,clearable:"",placeholder:"交易日"},null,8,["value","onUpdate:value"])]),i("td",wa,[o(Be,{value:l.partner_ids,"onUpdate:value":c=>l.partner_ids=c,multiple:h.value===1,filterable:"",clearable:"",placeholder:"层级","label-field":"name","value-field":"value",options:X.value},null,8,["value","onUpdate:value","multiple","options"])]),i("td",Ua,[o(w,{value:l.min_money,"onUpdate:value":c=>l.min_money=c,clearable:"",placeholder:"最小投入金额"},null,8,["value","onUpdate:value"])]),i("td",Sa,[o(w,{value:l.max_money,"onUpdate:value":c=>l.max_money=c,clearable:"",placeholder:"最大投入金额"},null,8,["value","onUpdate:value"])]),i("td",Ca,[o(w,{value:l.commission_rate,"onUpdate:value":c=>l.commission_rate=c,clearable:"",placeholder:"佣金比例"},null,8,["value","onUpdate:value"])]),i("td",null,[o(d(K),{type:"error",size:"small",onClick:c=>Ee(C)},{default:r(()=>[b(z(d(E)("common.delete")),1)]),_:2},1032,["onClick"])])]))),128))])]),_:1}),e[20]||(e[20]=i("div",{class:"h-10px"},null,-1)),o(d(K),{type:"primary",size:"small",onClick:Ie},{default:r(()=>[b(z(d(E)("common.add")),1)]),_:1})],512),[[ce,v.value===2]])]),statistics_data:r(()=>[o(de,{"label-width":"auto",model:p.value},{default:r(()=>[o(pe,{cols:24,"x-gap":24},{default:r(()=>[(g(),O(V,null,j(we,l=>o(G,{key:l.fields,span:12,label:l.name,path:l.fields},{default:r(()=>[l.type==="Input"?(g(),me(Ge,{key:0,value:p.value[l.fields],"onUpdate:value":C=>p.value[l.fields]=C,clearable:"",placeholder:l.placeholder},null,8,["value","onUpdate:value","placeholder"])):(g(),me(w,{key:1,value:p.value[l.fields],"onUpdate:value":C=>p.value[l.fields]=C,clearable:"",placeholder:l.placeholder},null,8,["value","onUpdate:value","placeholder"]))]),_:2},1032,["label","path"])),64))]),_:1})]),_:1},8,["model"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{Ja as default};
