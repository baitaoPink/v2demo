import{_ as G}from"./modal-form.vue_vue_type_script_setup_true_lang-BGpCBuuL.js";import{_ as Q}from"./search-header-DKkxeb92.js";import{_ as W}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-Co_MiHfJ.js";import{d as X,O as q,r as l,V as J,o as Z,b as ee,f as a,w as r,h as c,B as y,g as m,W as B,a2 as te,a8 as T,Y as ae,N as le}from"./index-BGn2hxht.js";import{g as ne}from"./mentor-management-DSumvn2e.js";import{h as oe,i as ie,j as re}from"./review-Qs50SYRN.js";import{u as se,N as z}from"./custom-table-CkjRR_Ue.js";import{_ as S}from"./Flex-BOUMy5Qd.js";import{_ as ue}from"./DataTable-B20boM9S.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-BLS00VyW.js";import"./custom-upload-BnYTuu-H.js";import"./Grid-D6W4PgKj.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-hAQEuGNb.js";import"./Spin-CneC0ahg.js";import"./DatePicker-ByFFtn5f.js";import"./TimePicker-B2GQNCjg.js";import"./Forward-BMPR_CvR.js";import"./RadioGroup-QgSZfQqx.js";import"./Space-AspkDbzB.js";const ze=X({name:"documentation-management_review",__name:"index",setup(de){const{pagination:s,renderCell:M}=se(),p=q(),f=l(!1),x=l([]),g=l({user_type:"1"}),h=l(),N=l(""),v=l([{type:"Input",valueName:"order_no",label:"订单"},{type:"Input",valueName:"account_key",label:"账号/姓名"},{type:"Remote Select",valueName:"trader_id",label:"导师",selectLabelField:"name",selectValueField:"value",remoteSelectLoading:!1},{type:"Select",valueName:"user_type",label:"用户类型",defaultOption:[{label:"正式用户",value:1},{label:"试玩用户",value:2}]},{type:"Datetime",datetimeType:"datetimerange",valueName:"create_time",label:"创建时间（开始~结束）"},{type:"Select",valueName:"list_status",label:"状态",defaultOption:[{label:"全部",value:0},{label:"待审核",value:1},{label:"进行中",value:2},{label:"驳回",value:3}]}]);async function u(){var t;f.value=!0;const{data:e}=await oe({...g.value,create_time:Array.isArray((t=g.value)==null?void 0:t.create_time)&&g.value.create_time.length?g.value.create_time.map(i=>te(i==null?void 0:i.valueOf()).format("YYYY/MM/DD")).join("-"):"",page:s.page,limit:s.pageSize});x.value=e.list,s.itemCount=e.count,f.value=!1}const d=l(!1),b=l(!1),_=l(1),C=[{type:"selection"},{title:"ID",key:"id",align:"center",width:"60"},{title:"账号/姓名",key:"name",align:"center",width:"200",render:e=>a(S,null,{default:()=>[a("p",{class:"w-full text-center"},[e.account]),a("p",null,[e.name])]})},{title:"正式用户",key:"user_type",align:"center",width:"80",render:e=>a(T,{type:e.user_type===1?"success":"error"},{default:()=>[e.user_type===1?"是":"否"]})},{title:"市场",key:"market_type_name",align:"center",width:"150"},{title:"币种",key:"money_type_name",align:"center",width:"80"},{title:"订单号",key:"order_no",align:"center",width:"250"},{title:"导师",key:"trader_name",align:"center",width:"80"},{title:"导师佣金比例（%）",key:"commission_ratio",align:"center",width:"160"},{title:"购买金额",key:"money",align:"center",width:"100"},{title:"追加金额",key:"add_money",align:"center",width:"100"},{title:"周期（天）",key:"contract",align:"center",width:"100"},{title:"状态",key:"audit_status",align:"center",width:"100",render:e=>a(T,null,{default:()=>[e.audit_status_str]})},{title:"订单类型",key:"order_type_str",align:"center",width:"120"},{title:"开始时间",key:"create_time",align:"center",width:"180"},{title:"操作",key:"action",align:"center",width:100,fixed:"right",render:e=>B(a(S,{justify:"center"},{default:()=>[a(z,{negativeText:"拒绝","on-negative-click":()=>{e.audit_status===1?(h.value=e.id,d.value=!0,_.value=3):p.error("只可审核待审核的数据")},positiveText:"通过","onPositive-click":()=>{e.audit_status===1?(h.value=e.id,d.value=!0,_.value=2):p.error("只可审核待审核的数据")}},{default:()=>[m("确定审核订单吗？")],trigger:()=>a(y,{type:"success",size:"small"},{default:()=>[m("审核")]})})]}),[[ae,e.audit_status===1]])}],o=l([]),w=l([]),F=l([{type:"Input",inputType:"textarea",valueName:"remarks",label:"备注"}]),A=l(!1);function U(e){g.value=e,s.page=1,u()}function L(e,t){o.value=e,w.value=t}function j(e){s.page=e,u()}function R(e){s.page=1,s.pageSize=e,u()}async function $(e){const t=o.value.length?o.value.join(","):`${h.value}`,i={audit_status:`${_.value}`,remarks:e.remarks??""},{response:k}=o.value.length?await ie({...i,ids:t}):await re({...i,id:t});o.value=[],w.value=[],k.data.status===200&&(p.success("提交成功"),d.value=!1,u())}async function D(){v.value[2].remoteSelectLoading=!0;const{data:e}=await ne({name:N.value});v.value[2].defaultOption=e,v.value[2].remoteSelectLoading=!1}function I(e){e.keyName==="trader_id"&&(N.value=e.value,D())}function O(e){if(b.value=!1,!o.value.length){p.error("请选择要审核订单的数据");return}let t=!1;for(const i of w.value)if(i.audit_status!==1){t=!0;break}if(t){p.error("只能选择待审核的数据");return}_.value=e,d.value=!0}D(),u();const P=l(C.reduce((e,t)=>Number(e)+Number(t.width),0));return(e,t)=>{const i=S,k=W,V=Q,Y=ue,E=le,H=G,K=J("resize");return Z(),ee("div",null,[a(E,{title:"订单审核列表"},{"header-extra":r(()=>[a(k,{"refresh-button-loading":f.value,"onUpdate:refreshButtonLoading":t[3]||(t[3]=n=>f.value=n),"export-selected-disabled":o.value.length,"onUpdate:exportSelectedDisabled":t[4]||(t[4]=n=>o.value.length=n),"batch-delete-disabled":o.value.length,"onUpdate:batchDeleteDisabled":t[5]||(t[5]=n=>o.value.length=n),"slot-name":"audit","is-add":!1,"is-batch-delete":!1,"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,onRefresh:u},{audit:r(()=>[a(i,{justify:"center"},{default:r(()=>[a(c(z),{show:b.value,"onUpdate:show":t[2]||(t[2]=n=>b.value=n)},{trigger:r(()=>[a(c(y),{type:"info",size:"small",ghost:""},{default:r(()=>t[7]||(t[7]=[m("批量审核")])),_:1})]),action:r(()=>[a(c(y),{size:"small",onClick:t[0]||(t[0]=n=>O(3))},{default:r(()=>t[8]||(t[8]=[m("拒绝")])),_:1}),a(c(y),{size:"small",type:"primary",onClick:t[1]||(t[1]=n=>O(2))},{default:r(()=>t[9]||(t[9]=[m("通过")])),_:1})]),default:r(()=>[t[10]||(t[10]=m(" 确定批量审核订单吗？ "))]),_:1},8,["show"])]),_:1})]),_:1},8,["refresh-button-loading","export-selected-disabled","batch-delete-disabled"])]),default:r(()=>[a(V,{"search-config":v.value,onOnSearch:U,onOnRemoteSelectSearch:I},null,8,["search-config"]),B(a(Y,{remote:"",columns:C,data:x.value,loading:f.value,bordered:!1,style:{height:"560px"},"flex-height":"","scroll-x":P.value,pagination:c(s),"row-key":n=>n.id,"render-cell":c(M),"checked-row-keys":o.value,"onUpdate:checkedRowKeys":L,"onUpdate:page":j,"onUpdate:pageSize":R},null,8,["data","loading","scroll-x","pagination","row-key","render-cell","checked-row-keys"]),[[K]])]),_:1}),a(H,{"show-form-modal":d.value,"onUpdate:showFormModal":t[6]||(t[6]=n=>d.value=n),title:"审核",loading:A.value,"modal-form-config":F.value,onOnSubmit:$},null,8,["show-form-modal","loading","modal-form-config"])])}}});export{ze as default};
