import{_ as se}from"./modal-form.vue_vue_type_script_setup_true_lang-BJ69RLGj.js";import{_ as ie}from"./search-header-BxwkGrv3.js";import{_ as ue}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CEWz-Loh.js";import{d as re,O as de,r as l,U as O,V as ce,o as me,b as pe,f as n,w as V,h as d,a1 as M,W as fe,$ as c,X as j,B as P,N as ve,Z as ge}from"./index-DrEzliHY.js";import{g as R,b as he,s as be,e as ye,d as we,a as _e}from"./article-manage-K_2xA-kJ.js";import{u as xe,N as Se}from"./custom-table-YBGLKz8r.js";import{u as ke}from"./exportExcel-DmIPdUnp.js";import{_ as Ce}from"./Flex-DkQB4X0g.js";import{_ as De}from"./DataTable-BLC5kPHF.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-CddQKb4h.js";import"./custom-upload-xESAwsug.js";import"./Grid-ppKVTCkg.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-D43XudUj.js";import"./Spin-4EGh_M6p.js";import"./DatePicker-B2ToGdru.js";import"./TimePicker-CbQV1d7H.js";import"./Forward-RZ68qXfC.js";import"./RadioGroup-DfynhpqT.js";import"./Space-B3V6_u3T.js";function T(g){return typeof g=="function"||Object.prototype.toString.call(g)==="[object Object]"&&!ge(g)}const U="文章分类.xlsx",qe=re({name:"article-manage_classification-manage",__name:"index",setup(g){const{pagination:m,renderCell:$}=xe(),p=de(),{exportExcel:x,exportLoading:s}=ke(),i=l(!1),S=l([]),A=l({}),I=l([{type:"Input",valueName:"title",label:"分类名称",placeholder:"请输入分类名称"}]),h=l(0),b=l(!1),N=l(!0),y=l(!1),H=l({}),w=l(!1),E=l(!0),_=l(!1),F=l([{type:"Input",valueName:"name",label:"名称"},{type:"Select",valueName:"status",label:"状态",defaultOption:[{value:1,label:"开启"},{value:2,label:"关闭"}]},{type:"Select",valueName:"is_lock",label:"是否锁定",defaultOption:[{value:1,label:"锁定"},{value:2,label:"未锁定"}]}]),L=l([]),f=l([]),z={name:[{required:!0,message:"请输入名称",trigger:["blur"]}]};async function u(){i.value=!0;const{data:a}=await R({...A.value,page:m.page,limit:m.pageSize});S.value=a.list,m.itemCount=a.count,i.value=!1}async function K(a){if(a.is_lock===1){p.error("锁定状态不可删除");return}i.value=!0;const{response:e}=await we({id:a.id});e.data.status===200&&(u(),p.success(c("common.deleteSuccess")))}async function X(a){h.value=a;const{data:e}=await _e({id:a});H.value=e,f.value[0].defaultValue=e.name,f.value[1].defaultValue=e.status,f.value[2].defaultValue=e.is_lock,w.value=!0}const v=[{type:"selection"},{title:"Id",key:"id",align:"center",width:"100",ellipsis:{tooltip:!0}},{title:"分类名称",key:"name",align:"center",width:"100",ellipsis:{tooltip:!0}},{title:"是否锁定",key:"is_lock",align:"center",width:"100",render:a=>{const e=l(a.is_lock===1);return n(j,{value:e.value,"onUpdate:value":[o=>e.value=o,o=>{a.is_lock=o?1:2,h.value=a.id,D({...a,is_lock:o?1:2})}]},null)}},{title:"状态",key:"up_where",align:"center",width:"100",render:a=>{const e=l(a.status===1);return n(j,{value:e.value,"onUpdate:value":[o=>e.value=o,o=>{a.status=o?1:2,h.value=a.id,D({...a,status:o?1:2})}]},null)}},{title:"创建时间",key:"create_time",align:"center",width:"180"},{title:"操作",key:"action",align:"center",width:100,fixed:"right",render:a=>{let e;return n(Ce,{justify:"center"},{default:()=>[n(P,{type:"success",size:"small",onClick:X.bind(null,a.id)},T(e=c("common.modify"))?e:{default:()=>[e]}),n(Se,{"onPositive-click":K.bind(null,a)},{default:()=>[c("common.confirmDelete")],trigger:()=>{let o;return n(P,{type:"error",size:"small"},T(o=c("common.delete"))?o:{default:()=>[o]})}})]})}}];async function q(){const{data:a}=await R();x({tableColumns:v,tableData:k(a),fileName:U})}function k(a){const e=a;return e.forEach(o=>{o.up_where}),e}const r=l([]),C=l([]);function G(a){A.value=a,m.page=1,u()}function Q(a,e){r.value=a,C.value=e}function W(){b.value=!0}async function Z(){if(i.value=!0,r.value.length===0){p.error("请选择要删除的数据"),i.value=!1;return}if(C.value.some(e=>e.is_lock===1)){p.error("锁定状态不可删除"),i.value=!1;return}const{response:a}=await he({id:r.value.join(",")});a.data.status===200&&(u(),r.value=[],p.success(c("common.deleteSuccess")))}async function J(a){y.value=!0;const e={};a.up_where&&(e.up_where=a.up_where.join(","));const{response:o}=await be({...a,...e});o.data.status===200&&(u(),p.success(c("common.addSuccess")),b.value=!1),y.value=!1}async function D(a){_.value=!0;const e={};a.up_where&&(e.up_where=a.up_where.join(","));const{response:o}=await ye(h.value,{...a,...e});o.data.status===200&&(u(),p.success(c("common.modifySuccess"))),w.value=!1,_.value=!1}function Y(a){m.page=a,u()}function ee(a){m.page=1,m.pageSize=a,u()}u(),L.value=O(F.value),f.value=O(F.value);const ae=l(v.reduce((a,e)=>Number(a)+Number(e.width),0));return(a,e)=>{const o=ue,te=ie,oe=De,le=ve,B=se,ne=ce("resize");return me(),pe("div",null,[n(le,{title:"文章分类"},{"header-extra":V(()=>[n(o,{"export-all-loading":d(s),"onUpdate:exportAllLoading":e[0]||(e[0]=t=>M(s)?s.value=t:null),"refresh-button-loading":i.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=t=>i.value=t),"export-selected-disabled":r.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=t=>r.value.length=t),"batch-delete-disabled":r.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=t=>r.value.length=t),"export-filter-loading":d(s),"onUpdate:exportFilterLoading":e[4]||(e[4]=t=>M(s)?s.value=t:null),"export-selected-loading":d(s),"onUpdate:exportSelectedLoading":e[5]||(e[5]=t=>M(s)?s.value=t:null),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,onExportAll:q,onExportFilter:e[6]||(e[6]=t=>d(x)({tableColumns:v,tableData:k(S.value),fileName:U})),onExportSelected:e[7]||(e[7]=t=>d(x)({tableColumns:v,tableData:k(C.value),fileName:U})),onAdd:W,onBatchDelete:Z,onRefresh:u},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:V(()=>[n(te,{"search-config":I.value,onOnSearch:G},null,8,["search-config"]),fe(n(oe,{remote:"",columns:v,data:S.value,loading:i.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":ae.value,pagination:d(m),"row-key":t=>t.id,"render-cell":d($),"checked-row-keys":r.value,"onUpdate:checkedRowKeys":Q,"onUpdate:page":Y,"onUpdate:pageSize":ee},null,8,["data","loading","scroll-x","pagination","row-key","render-cell","checked-row-keys"]),[[ne]])]),_:1}),n(B,{"show-form-modal":b.value,"onUpdate:showFormModal":e[8]||(e[8]=t=>b.value=t),"is-async-shut-down":N.value,"onUpdate:isAsyncShutDown":e[9]||(e[9]=t=>N.value=t),"is-show-modal-loading":y.value,"onUpdate:isShowModalLoading":e[10]||(e[10]=t=>y.value=t),"modal-title":d(c)("common.add"),"modal-form-config":L.value,"form-rules":z,onOnSubmit:J},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),n(B,{"show-form-modal":w.value,"onUpdate:showFormModal":e[11]||(e[11]=t=>w.value=t),"is-async-shut-down":E.value,"onUpdate:isAsyncShutDown":e[12]||(e[12]=t=>E.value=t),"is-show-modal-loading":_.value,"onUpdate:isShowModalLoading":e[13]||(e[13]=t=>_.value=t),"modal-title":d(c)("common.modify"),"modal-form-config":f.value,"form-rules":z,onOnSubmit:D},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{qe as default};
