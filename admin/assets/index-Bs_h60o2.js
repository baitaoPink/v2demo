import{_ as Pe}from"./modal-form.vue_vue_type_script_setup_true_lang-P1z5yclz.js";import{_ as He}from"./delete-BRahhYjp.js";import{_ as Ke}from"./multi-language-form.vue_vue_type_script_setup_true_lang-B08Imzic.js";import{_ as Xe}from"./search-header-D_blBfvw.js";import{_ as Ge}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CRfXQ-ba.js";import{d as Qe,O as We,r as o,U as de,V as Ze,o as U,b as K,f as i,w as u,h as f,a1 as X,W as Je,g as V,c as ve,a4 as I,e as ce,B as T,$ as N,a3 as Ye,X as et,N as tt,a5 as at,Z as lt,a6 as ot}from"./index-CYDGqEQI.js";import{c as me,f as nt,h as it,i as ut,j as st,k as rt,l as dt}from"./article-manage-D_gJSc6C.js";import{g as vt}from"./mentor-management-BzYP9Ezn.js";import{u as ct,N as mt}from"./custom-table-B3DGB95j.js";import{u as ft}from"./exportExcel-C7iadLxj.js";import{_ as pt,u as gt}from"./custom-upload-2G2myZ9i.js";import{_ as yt}from"./Flex-BZMv6Qv4.js";import{_ as _t}from"./DataTable-CYp14RVL.js";import"./DatePicker-BtnAIrHe.js";import"./TimePicker-BHOJ7N6u.js";import"./Forward-BP90BV3h.js";import"./RadioGroup-C6Ct6ciA.js";import"./get-slot-Bk_rJcZu.js";import"./Grid-D4YcV8OK.js";import"./FormItem-B3v3fzMP.js";import"./Spin-Ca-vK6CT.js";import"./Space-jg1obvb8.js";const bt={key:1,class:"video-box"},wt=["src"],ht={key:1,class:"video-box"},Nt=["src"];function fe(O){return typeof O=="function"||Object.prototype.toString.call(O)==="[object Object]"&&!lt(O)}const G="文章分类.xlsx",xt=Qe({name:"article-manage_list-manage",__name:"index",setup(O){const{pagination:x,renderCell:pe}=ct(),A=We(),{handleUpload:Q}=gt(),{exportExcel:$,exportLoading:g}=ft(),S=o(!1),q=o([]),W=o({}),v=o([]),c=o([]),s=o({}),ge=o([{label:"全部",value:""},{label:"显示",value:1},{label:"隐藏",value:0}]),z=o([{type:"Input",valueName:"title",label:"文章标题",placeholder:"请输入文章标题"},{type:"Select",valueName:"category_id",label:"文章分类",placeholder:"请选择文章分类",defaultOption:[],selectFilter:!0},{type:"Select",valueName:"status",label:"状态",placeholder:"请选择状态",defaultOption:ge.value}]),k=o(0),y=o(!1),Z=o(!0),C=o(!1),ye=o({}),_=o(!1),J=o(!0),L=o(!1),Y=o([{type:"Input",valueName:"title",label:"文章标题"},{type:"Select",valueName:"lang_code",label:"语言"},{type:"Slot",valueName:"category_id",label:"文章分类",slotName:"category_id",selectFilter:!0},{type:"Input",valueName:"sub_title",label:"简略标题"},{type:"Input",valueName:"describe",inputType:"textarea",label:"摘要"},{type:"Slot",valueName:"content",slotName:"content",label:"内容"},{type:"Input Number",valueName:"sort",label:"排序"},{type:"Select",valueName:"status",label:"状态",defaultValue:1,defaultOption:[{value:1,label:"开启"},{value:0,label:"关闭"}]},{type:"Slot",valueName:"image",label:"封面",slotName:"image"}]),B=o([]),p=o(""),b=o(),M=o(""),n=o([]),r=o([]),ee={title:[{required:!0,message:"请输入文章标题",trigger:["blur"]}],category_id:[{required:!0,type:"number",trigger:["blur"],validator:()=>p.value?!0:new Error("请选择文章分类")}],lang_code:[{required:!0,message:"请选择语言",trigger:["blur"]}],sub_title:[{required:!0,message:"请输入简略标题",trigger:["blur"]}],content:[{required:!0,trigger:["blur"],validator:()=>b.value?!0:new Error("请输入内容")}],image:[{message:"请上传封面",trigger:["blur"],validator:()=>{const t=[1,18,4];return!s.value.image&&t.includes(Number(p.value))?new Error("请上传封面"):!0}}]};async function w(){S.value=!0;const{data:t}=await me({...W.value,page:x.page,limit:x.pageSize});q.value=t.list,x.itemCount=t.count,S.value=!1}async function _e(t){S.value=!0;const{response:e}=await rt({id:t});e.data.status===200&&(w(),A.success(N("common.deleteSuccess")))}async function be(t){k.value=t;const{data:e}=await dt({id:t});ye.value=e,r.value.forEach(l=>{l.defaultValue=e[l.valueName]}),e.image?(c.value=[{id:"image",name:"image",url:e.image,status:"finished"}],s.value.image=e.image||""):(c.value=[],s.value.image=""),e.video?(v.value=[{id:"video",name:"视频",url:e.video,status:"finished"}],s.value.video=e.video||""):(s.value.video="",v.value=[]),p.value=e.category_id,b.value=e.content||"",_.value=!0,P(e.category_id,e)}async function we(){const{data:t}=await nt(),e=t.map(l=>({value:l.value,label:l.name}));B.value=e,n.value.forEach((l,d)=>{l.valueName==="category_id"&&(n.value[d].defaultOption=e,r.value[d].defaultOption=e)}),z.value.forEach((l,d)=>{l.valueName==="category_id"&&(z.value[d].defaultOption=e)})}async function he(){var l;const{data:t}=await Ye(),e=(l=t.list)==null?void 0:l.map(d=>({value:d.file_name,label:d.language_name}));n.value.forEach((d,m)=>{d.valueName==="lang_code"&&(n.value[m].defaultOption=e,r.value[m].defaultOption=e)})}he(),we();const D=[{type:"selection"},{title:"ID",key:"id",align:"center",width:"50"},{title:"分类名称",key:"category_name",align:"center",width:"200"},{title:"语言",key:"lang_code",align:"center",width:"100"},{title:"标题",key:"title",align:"center",width:"200",ellipsis:{tooltip:!0}},{title:"简略标题",key:"sub_title",align:"center",width:"200",ellipsis:{tooltip:!0}},{title:"摘要",key:"describe",align:"center",width:"200",ellipsis:{tooltip:!0}},{title:"排序",key:"sort",align:"center",width:"100"},{title:"状态",key:"up_where",align:"center",width:"100",render:t=>{const e=o(t.status===1);return i(et,{value:e.value,"onUpdate:value":[l=>e.value=l,l=>{t.status=l?1:0,k.value=t.id,ae({...t,status:l})}]},null)}},{title:"创建时间",key:"create_time",align:"center",width:"180"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:t=>{let e;return i(yt,{justify:"center"},{default:()=>[i(T,{type:"success",size:"small",onClick:be.bind(null,t.id)},fe(e=N("common.modify"))?e:{default:()=>[e]}),i(mt,{"onPositive-click":_e.bind(null,t.id)},{default:()=>[N("common.confirmDelete")],trigger:()=>{let l;return i(T,{type:"error",size:"small"},fe(l=N("common.delete"))?l:{default:()=>[l]})}})]})}}];async function Ne(){const{data:t}=await me();$({tableColumns:D,tableData:j(t),fileName:G})}function j(t){const e=t;return e.forEach(l=>{l.up_where}),e}const h=o([]),te=o([]);function xe(t){W.value=t,x.page=1,w()}function Se(t,e){h.value=t,te.value=e}function ke(){y.value=!0,s.value.video="",s.value.image="",v.value=[],p.value="",b.value="",n.value.filter(l=>l.valueName==="stock_trader_id").length&&n.value.splice(3,1),n.value.filter(l=>l.valueName==="video").length&&n.value.pop(),c.value=[]}async function Ce(){S.value=!0;const{response:t}=await it({id:h.value.join(",")});t.data.status===200&&(w(),h.value=[],A.success(N("common.deleteSuccess")))}async function Le(t){C.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:l}=await ut({...t,...e,image:s.value.image,video:s.value.video,status:t.status?1:0,category_id:p.value||void 0,content:b.value});l.data.status===200&&(w(),A.success(N("common.addSuccess")),y.value=!1,c.value=[]),C.value=!1}function De(){M.value="",c.value=[]}async function ae(t){L.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:l}=await st(k.value,{...t,...e,image:s.value.image,status:t.status?1:0,video:s.value.video,category_id:p.value||void 0,content:b.value});l.data.status===200&&(w(),A.success(N("common.modifySuccess")),_.value=!1,c.value=[]),L.value=!1}function Fe(){M.value="",k.value=0}function F(t){Reflect.deleteProperty(s.value,t),v.value=[],s.value[t]=""}function Ue(t){Reflect.deleteProperty(s.value,t),c.value=[],s.value[t]=""}async function le({file:t,onFinish:e,onError:l,onProgress:d}){const m=await Q({file:t,onFinish:e,onError:l,onProgress:d});m&&(s.value.video=m,v.value=[{id:"video",name:"视频",url:m,status:"finished"}])}async function oe({file:t,onFinish:e,onError:l,onProgress:d}){C.value=y.value,L.value=_.value;const m=await Q({file:t,onFinish:e,onError:l,onProgress:d});m&&(s.value.image=m),C.value=!1,L.value=!1}async function E(){k.value?r.value[3].remoteSelectLoading=!0:n.value[3].remoteSelectLoading=!0;const{data:t}=await vt({name:M.value});console.log(n.value),n.value[3].defaultOption=t,r.value[3].defaultOption=t,k.value?r.value[3].remoteSelectLoading=!1:n.value[3].remoteSelectLoading=!1}function ne(t){t.keyName==="stock_trader_id"&&(M.value=t.value,E())}function Oe(t){x.page=t,w()}function Ae(t){x.page=1,x.pageSize=t,w()}function P(t,e){Me(t,e),Ie(t)}function Me(t,e){t===10||t===9?(Ee(),Re(e)):Ve()}function Ee(){y.value&&(n.value.filter(e=>e.valueName==="stock_trader_id").length||(n.value.splice(3,0,{type:"Remote Select",valueName:"stock_trader_id",label:"导师选择",selectLabelField:"name",selectValueField:"value",remoteSelectLoading:!1}),E()))}function Re(t){_.value&&(r.value.filter(l=>l.valueName==="stock_trader_id").length||(r.value.splice(3,0,{type:"Remote Select",valueName:"stock_trader_id",label:"导师选择",selectLabelField:"name",selectValueField:"value",remoteSelectLoading:!1,defaultValue:(t==null?void 0:t.stock_trader_id)||void 0}),E()))}function Ve(){y.value&&n.value.filter(e=>e.valueName==="stock_trader_id").length&&n.value.splice(3,1),_.value&&r.value.filter(e=>e.valueName==="stock_trader_id").length&&r.value.splice(3,1)}function Ie(t){t===10?(Te(),$e()):qe()}function Te(){y.value&&(n.value.filter(e=>e.valueName==="video").length||n.value.push({type:"Slot",valueName:"video",label:"视频",slotName:"video"}))}function $e(){_.value&&(r.value.filter(e=>e.valueName==="video").length||r.value.push({type:"Slot",valueName:"video",label:"视频",slotName:"video"}))}function qe(){y.value&&n.value.filter(e=>e.valueName==="video").length&&n.value.pop(),_.value&&r.value.filter(e=>e.valueName==="video").length&&r.value.pop()}w(),n.value=de(Y.value),r.value=de(Y.value),E();const ze=o(D.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const l=Ge,d=Xe,m=_t,Be=tt,ie=Ke,ue=at,R=pt,se=He,re=Pe,je=Ze("resize");return U(),K("div",null,[i(Be,{title:"文章列表"},{"header-extra":u(()=>[i(l,{"export-all-loading":f(g),"onUpdate:exportAllLoading":e[0]||(e[0]=a=>X(g)?g.value=a:null),"refresh-button-loading":S.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=a=>S.value=a),"export-selected-disabled":h.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=a=>h.value.length=a),"batch-delete-disabled":h.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=a=>h.value.length=a),"export-filter-loading":f(g),"onUpdate:exportFilterLoading":e[4]||(e[4]=a=>X(g)?g.value=a:null),"export-selected-loading":f(g),"onUpdate:exportSelectedLoading":e[5]||(e[5]=a=>X(g)?g.value=a:null),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,"checked-row-keys":h.value,onExportAll:Ne,onExportFilter:e[6]||(e[6]=a=>f($)({tableColumns:D,tableData:j(q.value),fileName:G})),onExportSelected:e[7]||(e[7]=a=>f($)({tableColumns:D,tableData:j(te.value),fileName:G})),onAdd:ke,onBatchDelete:Ce,onRefresh:w},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading","checked-row-keys"])]),default:u(()=>[i(d,{"search-config":z.value,onOnSearch:xe},null,8,["search-config"]),Je(i(m,{remote:"",columns:D,data:q.value,loading:S.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":ze.value,pagination:f(x),"row-key":a=>a.id,"render-cell":f(pe),"checked-row-keys":h.value,"onUpdate:checkedRowKeys":Se,"onUpdate:page":Oe,"onUpdate:pageSize":Ae},null,8,["data","loading","scroll-x","pagination","row-key","render-cell","checked-row-keys"]),[[je]])]),_:1}),i(re,{"show-form-modal":y.value,"onUpdate:showFormModal":e[14]||(e[14]=a=>y.value=a),"is-async-shut-down":Z.value,"onUpdate:isAsyncShutDown":e[15]||(e[15]=a=>Z.value=a),"is-show-modal-loading":C.value,"onUpdate:isShowModalLoading":e[16]||(e[16]=a=>C.value=a),"width-class":"w-750px","modal-title":f(N)("common.add"),"modal-form-config":n.value,"form-rules":ee,onOnSubmit:Le,onOnClose:De,onOnRemoteSelectSearch:ne},{content:u(()=>[i(ie,{"editor-content":b.value,"onUpdate:editorContent":e[8]||(e[8]=a=>b.value=a)},null,8,["editor-content"])]),category_id:u(()=>[i(ue,{value:p.value,"onUpdate:value":[e[9]||(e[9]=a=>p.value=a),P],"label-field":"label","value-field":"value",filterable:!0,options:B.value},null,8,["value","options"])]),stock_trader_id:u(()=>e[26]||(e[26]=[])),image:u(()=>[i(R,{"file-list":c.value,"onUpdate:fileList":e[10]||(e[10]=a=>c.value=a),"list-type":"image-card",max:1,"custom-request":oe,onRemove:e[11]||(e[11]=a=>F("image"))},{default:u(()=>e[27]||(e[27]=[V(" 点击上传 ")])),_:1},8,["file-list"])]),video:u(()=>{var a;return[v.value.length===0?(U(),ve(R,{key:0,max:1,"list-type":"image-card","custom-request":le,placeholder:"上传视频",accept:"video/*",onRemove:e[12]||(e[12]=H=>F("video"))},{default:u(()=>e[28]||(e[28]=[V(" 点击上传 ")])),_:1})):I("",!0),v.value.length>0?(U(),K("div",bt,[ce("video",{src:((a=v.value[0])==null?void 0:a.url)||void 0,controls:""},null,8,wt),i(f(T),{strong:"",circle:"",size:"small",type:"error",class:"delete-icon",onClick:e[13]||(e[13]=H=>F("video"))},{icon:u(()=>[i(se,{class:"text-icon"})]),_:1})])):I("",!0)]}),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),i(re,{"show-form-modal":_.value,"onUpdate:showFormModal":e[23]||(e[23]=a=>_.value=a),"is-async-shut-down":J.value,"onUpdate:isAsyncShutDown":e[24]||(e[24]=a=>J.value=a),"is-show-modal-loading":L.value,"onUpdate:isShowModalLoading":e[25]||(e[25]=a=>L.value=a),"width-class":"w-750px","modal-title":f(N)("common.modify"),"modal-form-config":r.value,"form-rules":ee,onOnSubmit:ae,onOnClose:Fe,onOnRemoteSelectSearch:ne},{content:u(()=>[i(ie,{"editor-content":b.value,"onUpdate:editorContent":e[17]||(e[17]=a=>b.value=a)},null,8,["editor-content"])]),category_id:u(()=>[i(ue,{value:p.value,"onUpdate:value":[e[18]||(e[18]=a=>p.value=a),P],"label-field":"label","value-field":"value",filterable:!0,options:B.value},null,8,["value","options"])]),stock_trader_id:u(()=>e[29]||(e[29]=[])),image:u(()=>[i(R,{"file-list":c.value,"onUpdate:fileList":e[19]||(e[19]=a=>c.value=a),"list-type":"image-card",max:1,"custom-request":oe,onRemove:e[20]||(e[20]=a=>Ue("image"))},{default:u(()=>e[30]||(e[30]=[V(" 点击上传 ")])),_:1},8,["file-list"])]),video:u(()=>{var a;return[v.value.length===0?(U(),ve(R,{key:0,max:1,"list-type":"image-card","custom-request":le,placeholder:"上传视频",accept:"video/*",onRemove:e[21]||(e[21]=H=>F("video"))},{default:u(()=>e[31]||(e[31]=[V(" 点击上传 ")])),_:1})):I("",!0),v.value.length>0?(U(),K("div",ht,[ce("video",{src:((a=v.value[0])==null?void 0:a.url)||void 0,controls:""},null,8,Nt),i(f(T),{strong:"",circle:"",size:"small",type:"error",class:"delete-icon",onClick:e[22]||(e[22]=H=>F("video"))},{icon:u(()=>[i(se,{class:"text-icon"})]),_:1})])):I("",!0)]}),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}}),Kt=ot(xt,[["__scopeId","data-v-98b89b14"]]);export{Kt as default};
