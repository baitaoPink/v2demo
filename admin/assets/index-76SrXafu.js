import{_ as re}from"./modal-form.vue_vue_type_script_setup_true_lang-BGpCBuuL.js";import{_ as de}from"./search-header-DKkxeb92.js";import{_ as ce}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-Co_MiHfJ.js";import{d as me,O as pe,r as o,U,V as fe,o as ge,b as ve,f as n,w as j,h as u,a1 as L,W as ye,$ as r,X as he,B as R,N as be,Z as we}from"./index-BGn2hxht.js";import{a as _e}from"./user-manage-DVc1X8GA.js";import{w as xe}from"./systen-configuration-D8RMvtUQ.js";import{e as ke}from"./money-setting-BXKiFnZQ.js";import{x as $,y as Ne,z as Se,A as De,B as Ce}from"./system-configuration-DE1VkhqW.js";import{u as Me,N as Ue}from"./custom-table-CkjRR_Ue.js";import{u as Le}from"./exportExcel-Bj9ZbbX3.js";import{_ as Ee}from"./Flex-BOUMy5Qd.js";import{_ as Oe}from"./DataTable-B20boM9S.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-BLS00VyW.js";import"./custom-upload-BnYTuu-H.js";import"./Grid-D6W4PgKj.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-hAQEuGNb.js";import"./Spin-CneC0ahg.js";import"./DatePicker-ByFFtn5f.js";import"./TimePicker-B2GQNCjg.js";import"./Forward-BMPR_CvR.js";import"./RadioGroup-QgSZfQqx.js";import"./Space-AspkDbzB.js";function P(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!we(y)}const E="股票列表.xlsx",at=me({name:"system-configuration_management",__name:"index",setup(y){const{pagination:d,renderCell:q}=Me(),h=pe(),{exportExcel:N,exportLoading:s}=Le(),c=o(!1),S=o([]),f=o("0"),O=o({is_agent:f.value}),H=o([{label:"全部",value:""},{label:"显示",value:"1"},{label:"隐藏",value:"2"}]),D=o([{type:"Input",valueName:"title",label:"股票名",placeholder:"请输入股票名"},{type:"Input",valueName:"code",label:"股票代码",placeholder:"请输入股票代码"},{type:"Input",valueName:"pinyin",label:"股票缩写",placeholder:"请输入股票缩写"},{type:"Input",valueName:"exchange",label:"交易所代码",placeholder:"请输入交易所代码"},{type:"Select",valueName:"status",label:"状态",placeholder:"请选择状态",defaultOption:H.value},{type:"Select",valueName:"market_type",label:"股票类型",placeholder:"请选择类型",selectFilter:!0}]),F=o(0),b=o(!1),A=o(!0),w=o(!1),K=o({}),_=o(!1),B=o(!0),x=o(!1),C=o([{type:"Input",valueName:"title",label:"股票名"},{type:"Select",valueName:"market_type",label:"股票类型",defaultOption:[],selectFilter:!0},{type:"Input",valueName:"code",label:"股票代码"},{type:"Input",valueName:"pinyin",label:"股票缩写"},{type:"Input",valueName:"exchange",label:"交易所代码"},{type:"Input",valueName:"info",label:"备注"},{type:"Switch",valueName:"status",label:"状态",switchCheckedText:"开启",switchUncheckedText:"关闭"}]),k=o([]),g=o([]),I={title:[{required:!0,message:"请输入股票名",trigger:["blur"]}],market_type:[{required:!0,message:"请选择股票类型",trigger:["blur"]}],code:[{required:!0,message:"请输入股票代码",trigger:["blur"]}],pinyin:[{required:!0,message:"请输入股票缩写",trigger:["blur"]}],exchange:[{required:!0,message:"请输入交易所代码",trigger:["blur"]}]};async function i(){c.value=!0;const{data:t}=await $({page:d.page,limit:d.pageSize,...O.value});S.value=t.list,d.itemCount=t.count,c.value=!1}function X(t){d.page=t,i()}function G(t){d.page=1,d.pageSize=t,i()}async function Q(t){c.value=!0;const{response:e}=await De(t,{id:t,is_agent:f.value});e.data.status===200&&(i(),h.success(r("common.deleteSuccess")))}async function W(t){F.value=t;const{data:e}=await Ce(t,{id:f.value});K.value=e,g.value.forEach(a=>{a.defaultValue=e[a.valueName],a.valueName==="status"&&(e[a.valueName]===1?a.defaultValue=!0:a.defaultValue=!1)}),_.value=!0}async function Z(){const{data:t}=await _e();C.value[5].defaultOption=t.map(e=>({label:e.name,value:`${e.value}`}))}Z();const v=[{type:"selection"},{title:"股票名",key:"title",align:"center",width:"280"},{title:"股票代码",key:"code",align:"center",width:"120"},{title:"股票缩写",key:"pinyin",align:"center",width:"300"},{title:"交易所代码",key:"exchange",align:"center",width:"280"},{title:"备注",key:"info",align:"center",width:"180",ellipsis:{tooltip:!0},render:t=>n("span",null,[t.info?t.info:""])},{title:"状态",key:"status",align:"center",width:"100",render:t=>{const e=o(t.status===1);return n(he,{value:e.value,"onUpdate:value":[a=>e.value=a,a=>{t.status=a?1:2,F.value=t.id,z({...t,status:a})}]},null)}},{title:"创建时间",key:"create_time",align:"center",width:"180"},{title:"更新时间",key:"update_time",align:"center",width:"180"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:t=>{let e;return n(Ee,{justify:"center"},{default:()=>[n(R,{type:"success",size:"small",onClick:W.bind(null,t.id)},P(e=r("common.modify"))?e:{default:()=>[e]}),n(Ue,{"onPositive-click":Q.bind(null,t.id)},{default:()=>[r("common.confirmDelete")],trigger:()=>{let a;return n(R,{type:"error",size:"small"},P(a=r("common.delete"))?a:{default:()=>[a]})}})]})}}];async function J(){const{data:t}=await $();N({tableColumns:v,tableData:M(t.list),fileName:E})}function M(t){const e=U(t);return e.forEach(a=>{Reflect.has(a,"status")&&(a.status=a.status===1?"开启":"关闭")}),e}const m=o([]),T=o([]);function Y(t){O.value=t,d.page=1,i()}function ee(t,e){m.value=t,T.value=e}function te(){b.value=!0}async function ae(){c.value=!0;const{response:t}=await xe({id:m.value.join(","),is_agent:f.value});t.data.status===200&&(i(),m.value=[],h.success(r("common.deleteSuccess")))}async function le(t){w.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:a}=await Ne({...t,...e,status:Number(t.status)===1?1:2,is_agent:f.value});a.data.status===200&&(i(),h.success(r("common.addSuccess"))),b.value=!1,w.value=!1}async function z(t){x.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const{response:a}=await Se(t.id,{...t,...e,status:Number(t.status)===1?1:2,is_agent:f.value});a.data.status===200&&(i(),h.success(r("common.modifySuccess"))),_.value=!1,x.value=!1}async function oe(){const{data:t}=await ke(),e=t.list.map(a=>({label:a.name,value:a.market_type}));D.value.forEach((a,p)=>{a.valueName==="market_type"&&(D.value[p].defaultOption=e)}),k.value.forEach((a,p)=>{a.valueName==="market_type"&&(k.value[p].defaultOption=e)}),g.value.forEach((a,p)=>{a.valueName==="market_type"&&(g.value[p].defaultOption=e)})}oe(),i(),k.value=U(C.value),g.value=U(C.value);const ne=o(v.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const a=ce,p=de,se=Oe,ie=be,V=re,ue=fe("resize");return ge(),ve("div",null,[n(ie,{title:"股票列表"},{"header-extra":j(()=>[n(a,{"export-all-loading":u(s),"onUpdate:exportAllLoading":e[0]||(e[0]=l=>L(s)?s.value=l:null),"refresh-button-loading":c.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=l=>c.value=l),"export-selected-disabled":m.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=l=>m.value.length=l),"batch-delete-disabled":m.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=l=>m.value.length=l),"export-filter-loading":u(s),"onUpdate:exportFilterLoading":e[4]||(e[4]=l=>L(s)?s.value=l:null),"export-selected-loading":u(s),"onUpdate:exportSelectedLoading":e[5]||(e[5]=l=>L(s)?s.value=l:null),onExportAll:J,onExportFilter:e[6]||(e[6]=l=>u(N)({tableColumns:v,tableData:M(S.value),fileName:E})),onExportSelected:e[7]||(e[7]=l=>u(N)({tableColumns:v,tableData:M(T.value),fileName:E})),onAdd:te,onBatchDelete:ae,onRefresh:i},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:j(()=>[n(p,{"search-config":D.value,onOnSearch:Y},null,8,["search-config"]),ye(n(se,{remote:"",columns:v,data:S.value,loading:c.value,bordered:!1,style:{height:"560px"},"flex-height":"","scroll-x":ne.value,pagination:u(d),"row-key":l=>l.id,"render-cell":u(q),"onUpdate:checkedRowKeys":ee,"onUpdate:page":X,"onUpdate:pageSize":G},null,8,["data","loading","scroll-x","pagination","row-key","render-cell"]),[[ue]])]),_:1}),n(V,{"show-form-modal":b.value,"onUpdate:showFormModal":e[8]||(e[8]=l=>b.value=l),"is-async-shut-down":A.value,"onUpdate:isAsyncShutDown":e[9]||(e[9]=l=>A.value=l),"is-show-modal-loading":w.value,"onUpdate:isShowModalLoading":e[10]||(e[10]=l=>w.value=l),"modal-title":u(r)("common.add"),"modal-form-config":k.value,"form-rules":I,onOnSubmit:le},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),n(V,{"show-form-modal":_.value,"onUpdate:showFormModal":e[11]||(e[11]=l=>_.value=l),"is-async-shut-down":B.value,"onUpdate:isAsyncShutDown":e[12]||(e[12]=l=>B.value=l),"is-show-modal-loading":x.value,"onUpdate:isShowModalLoading":e[13]||(e[13]=l=>x.value=l),"modal-title":u(r)("common.modify"),"modal-form-config":g.value,"form-rules":I,onOnSubmit:z},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{at as default};
