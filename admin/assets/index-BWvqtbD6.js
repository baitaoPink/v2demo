import{_ as Be}from"./modal-form.vue_vue_type_script_setup_true_lang-tU3-hIUf.js";import{_ as Ve}from"./search-header-BEaDoZth.js";import{_ as Ee}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-C-DfQuFh.js";import{d as ze,O as Te,r as l,U as $e,V as Pe,o as ae,b as te,f as o,w as u,W as le,h as p,g as c,$ as i,S as je,ac as Ge,Y as Ke,bm as He,a8 as q,K as oe,B as V,N as Qe,x as We,Z as Ye,t as Ze}from"./index-ClXc60Q8.js";import{M as Je,N as ne,O as Xe,P as ea,Q as aa}from"./user-manage-NDgjaMcm.js";import{u as ta}from"./custom-table-DLqvKnHZ.js";import{_ as la,u as oa}from"./custom-upload-D71Q5maP.js";import{_ as na}from"./Flex-CESa1CD9.js";import{_ as ua}from"./DataTable-C2iu46cC.js";import{_ as ia}from"./Space-BoszUUx1.js";import{a as sa,_ as ra}from"./RadioGroup-C9SrcqWM.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-Ddf5h8QK.js";import"./Grid-xFIQOVry.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-DwRTykPn.js";import"./Spin-B3LvPL2m.js";import"./DatePicker-uVn2PEEJ.js";import"./TimePicker-Kfakx9-p.js";import"./Forward-BysZYGA1.js";function E(S){return typeof S=="function"||Object.prototype.toString.call(S)==="[object Object]"&&!Ye(S)}const xa=ze({name:"user-manage_user-authentication",__name:"index",setup(S){const{pagination:r,renderCell:ue}=ta(),{handleUpload:z}=oa(),k=Te(),_=l(!1),T=l([]),$=l({type:"1"}),ie=l([{type:"Input",valueName:"account",label:"登录名",placeholder:"请输入登录名"},{type:"Input",valueName:"name",label:"账号/姓名",placeholder:"请输入账号/姓名"},{type:"Input",valueName:"id_card",label:"身份证号码",placeholder:"请输入身份证号码"},{type:"Select",valueName:"type",label:"用户类型",defaultOption:[{value:"1",label:"正式用户"},{value:"2",label:"试玩用户"}]},{type:"Select",valueName:"status",label:"状态",defaultOption:[{value:"0",label:"待审核"},{value:"1",label:"审核通过"},{value:"2",label:"审核不通过"}]}]),se=["remark","status"],d=l(0),g=l({}),h=l([]),N=l([]),M=l([]),F=l([]),U=l(!1),P=l(!0),C=l(!1),B=l(!1),j=l(!1),G=l(!1),x=l(!1),K=l(!0),L=l(!1),A=l(!1),H=l(!0),D=l(!1),Q=l(""),W=l([{type:"Remote Select",valueName:"uid",label:"用户",selectLabelField:"name",selectValueField:"value",remoteSelectLoading:!1},{type:"Input",valueName:"name",label:"姓名"},{type:"Input Number",valueName:"mobile",label:"手机号"},{type:"Input",valueName:"id_card",label:"身份证"},{type:"Slot",valueName:"front_id_img",label:"身份证正面",slotName:"front_id_img"},{type:"Slot",valueName:"back_id_img",label:"身份证反面",slotName:"back_id_img"},{type:"Input",valueName:"remark",label:"备注"}]),b=l([]),Y=l([{type:"Select",valueName:"account",label:"登录名"},{type:"Input",valueName:"name",label:"账号/姓名"},{type:"Input",valueName:"id_card",label:"身份证"},{type:"Slot",valueName:"front_id_img",label:"身份证正面",slotName:"front_id_img"},{type:"Slot",valueName:"back_id_img",label:"身份证反面",slotName:"back_id_img"},{type:"Radio",valueName:"status",label:"审核状态",radioGroupOption:[{label:"待审核",value:0,disabled:!0},{label:"审核通过",value:1,disabled:!0},{label:"审核不通过",value:2,disabled:!0}]}]),Z={uid:[{type:"number",required:!0,message:"请选择用户",trigger:["blur"]}],name:[{required:!0,message:"请输入姓名",trigger:["blur"]}],mobile:[{type:"number",required:!0,message:"请输入手机号",trigger:["blur"]}],id_card:[{required:!0,message:"请输入身份证号",trigger:["blur"]}],front_id_img:[{required:!0,message:"请上传身份证正面",trigger:["blur"],validator:()=>d.value?M.value.length?!0:new Error("请上传身份证正面"):h.value.length?!0:new Error("请上传身份证正面")}],back_id_img:[{required:!0,message:"请上传身份证反面",trigger:["blur"],validator:()=>d.value?F.value.length?!0:new Error("请上传身份证反面"):N.value.length?!0:new Error("请上传身份证反面")}]},v=l(0),re=[{label:"审核通过",value:1},{label:"审核不通过",value:2}],y=l(""),J=l([{type:"Slot",valueName:"status",label:"审核状态",slotName:"status"},{type:"Slot",valueName:"remark",slotName:"remark"}]),de={status:[{type:"number",required:!0,message:"请选择状态",trigger:["blur"],validator:()=>v.value?!0:new Error("请选择审核状态")}]},X=l([{type:"Input",valueName:"remark",label:"备注"}]),me={remark:[{required:!0,message:"请输入备注",trigger:["blur"]}]};async function m(){_.value=!0;const{data:a}=await Je({page:r.page,limit:r.pageSize,...$.value});T.value=a.list,r.itemCount=a.count,_.value=!1}function ce(a){r.page=a,m()}function fe(a){r.page=1,r.pageSize=a,m()}async function pe(a){d.value=a;const{data:e}=await aa(a);Y.value.forEach(n=>{se.includes(n.valueName)||(n.disabled=!0),n.defaultValue=e[n.valueName]}),M.value=[{id:"front_id_img",name:"身份证正面",url:e.front_id_img_url,status:"finished"}],F.value=[{id:"back_id_img",name:"身份证反面",url:e.back_id_img_url,status:"finished"}],B.value=!0}function ge(a,e){d.value=a,J.value[0].defaultValue=e,x.value=!0}async function ve(a){L.value=!0;const e={};y.value&&(e.remark=y.value);const{response:n}=await ne(d.value,{...a,...e,status:v.value});n.data.status===200&&(m(),k.success(i("common.modifySuccess")),x.value=!1),L.value=!1}function _e(){v.value=0,y.value=""}function be(a,e){d.value=a,X.value[0].defaultValue=e,A.value=!0}async function ye(a){D.value=!0;const{response:e}=await ne(d.value,{...a});e.data.status===200&&(m(),k.success(i("common.modifySuccess")),A.value=!1),D.value=!1}const we=[{title:"ID",key:"uid",align:"center"},{title:"账号/姓名",key:"create_time",align:"center",render:a=>o("div",null,[o("p",null,[a.account]),o("p",null,[a.name])])},{title:"身份证号码",key:"id_card",align:"center"},{title:"正式用户",key:"is_trial",align:"center",render:a=>o(q,{type:a.is_trial===1?"error":"success"},{default:()=>[a.is_trial===1?"否":"是"]})},{title:"身份证正面",key:"front_id_img",align:"center",render:a=>o(oe,{width:"100",src:a.front_id_img_url},null)},{title:"身份证反面",key:"back_id_img",align:"center",render:a=>o(oe,{width:"100",src:a.back_id_img_url},null)},{title:"状态",key:"status",align:"center",render:a=>xe(a.status)},{title:"提交时间",key:"create_time",align:"center"},{title:"审核时间",key:"apply_time",align:"center"},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:a=>{let e,n,s;return o(na,{justify:"center"},{default:()=>[o(V,{type:"primary",size:"small",onClick:pe.bind(null,a.id)},E(e=i("common.details"))?e:{default:()=>[e]}),o("div",null,[a.status===0?o(V,{type:"success",size:"small",onClick:ge.bind(null,a.id,a.status)},E(n=i("common.examine"))?n:{default:()=>[n]}):""]),o(V,{type:"warning",size:"small",onClick:be.bind(null,a.id,a.remark)},E(s=i("common.remark"))?s:{default:()=>[s]})]})}}],w=l([]),Se=l([]);function ke(a){$.value=a,r.page=1,m()}function he(a,e){w.value=a,Se.value=e}function Ne(){U.value=!0}async function Me(a){if(Object.keys(g.value).length!==2){k.error("请上传身份证");return}C.value=!0;const{response:e}=await Xe({status:1,...a,...g.value});e.data.status===200&&(m(),k.success(i("common.addSuccess")),U.value=!1),C.value=!1}function Fe(){R("front_id_img"),R("back_id_img"),h.value=[],N.value=[]}async function Ue({file:a,onFinish:e,onError:n,onProgress:s}){const f=await z({file:a,onFinish:e,onError:n,onProgress:s});f&&(g.value.front_id_img=f)}async function Ce({file:a,onFinish:e,onError:n,onProgress:s}){const f=await z({file:a,onFinish:e,onError:n,onProgress:s});f&&(g.value.back_id_img=f)}function R(a){d.value,Reflect.deleteProperty(g.value,a)}function xe(a){switch(a){case 0:return o(q,{type:"info"},{default:()=>[c("待审核")]});case 1:return o(q,{type:"success"},{default:()=>[c("审核通过")]});case 2:return o(q,{type:"error"},{default:()=>[c("审核不通过")]});default:return""}}async function ee(){b.value[0].remoteSelectLoading=!0;const a={name:Q.value,search_type:"identification"},{data:e}=await ea({...a});W.value[0].defaultOption=e,b.value[0].defaultOption=e,b.value[0].remoteSelectLoading=!1}function Le(a){a.keyName==="uid"&&(Q.value=a.value,ee())}return m(),b.value=$e(W.value),ee(),(a,e)=>{const n=Ee,s=Ve,f=ua,Ae=Qe,O=la,I=Be,De=ra,Re=ia,Oe=sa,Ie=We,qe=Pe("resize");return ae(),te("div",null,[o(Ae,{title:"用户认证列表"},{"header-extra":u(()=>[o(n,{"refresh-button-loading":_.value,"onUpdate:refreshButtonLoading":e[0]||(e[0]=t=>_.value=t),"export-selected-disabled":w.value.length,"onUpdate:exportSelectedDisabled":e[1]||(e[1]=t=>w.value.length=t),"batch-delete-disabled":w.value.length,"onUpdate:batchDeleteDisabled":e[2]||(e[2]=t=>w.value.length=t),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,"is-batch-delete":!1,onAdd:Ne,onRefresh:m},null,8,["refresh-button-loading","export-selected-disabled","batch-delete-disabled"])]),default:u(()=>[o(s,{"search-config":ie.value,onOnSearch:ke},null,8,["search-config"]),le(o(f,{remote:"",columns:we,data:T.value,pagination:p(r),loading:_.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":2e3,"row-key":t=>t.id,"render-cell":p(ue),"onUpdate:checkedRowKeys":he,"onUpdate:page":ce,"onUpdate:pageSize":fe},null,8,["data","pagination","loading","row-key","render-cell"]),[[qe]])]),_:1}),o(I,{"show-form-modal":U.value,"onUpdate:showFormModal":e[7]||(e[7]=t=>U.value=t),"is-async-shut-down":P.value,"onUpdate:isAsyncShutDown":e[8]||(e[8]=t=>P.value=t),"is-show-modal-loading":C.value,"onUpdate:isShowModalLoading":e[9]||(e[9]=t=>C.value=t),"modal-title":p(i)("common.add"),"modal-form-config":b.value,"form-rules":Z,onOnSubmit:Me,onOnClose:Fe,onOnRemoteSelectSearch:Le},{front_id_img:u(()=>[o(O,{"file-list":h.value,"onUpdate:fileList":e[3]||(e[3]=t=>h.value=t),"list-type":"image-card",max:1,accept:"image/*","custom-request":Ue,onRemove:e[4]||(e[4]=t=>R("front_id_img"))},{default:u(()=>e[23]||(e[23]=[c(" 点击上传 ")])),_:1},8,["file-list"])]),back_id_img:u(()=>[o(O,{"file-list":N.value,"onUpdate:fileList":e[5]||(e[5]=t=>N.value=t),"list-type":"image-card",max:1,accept:"image/*","custom-request":Ce,onRemove:e[6]||(e[6]=t=>R("back_id_img"))},{default:u(()=>e[24]||(e[24]=[c(" 点击上传 ")])),_:1},8,["file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),o(I,{"show-form-modal":B.value,"onUpdate:showFormModal":e[12]||(e[12]=t=>B.value=t),"is-async-shut-down":j.value,"onUpdate:isAsyncShutDown":e[13]||(e[13]=t=>j.value=t),"is-show-modal-loading":G.value,"onUpdate:isShowModalLoading":e[14]||(e[14]=t=>G.value=t),"modal-title":p(i)("common.details"),"modal-form-config":Y.value,"form-rules":Z},{front_id_img:u(()=>[o(O,{"default-file-list":M.value,"onUpdate:defaultFileList":e[10]||(e[10]=t=>M.value=t),"list-type":"image-card",max:1,accept:"image/*",disabled:""},{default:u(()=>e[25]||(e[25]=[c(" 点击上传 ")])),_:1},8,["default-file-list"])]),back_id_img:u(()=>[o(O,{"default-file-list":F.value,"onUpdate:defaultFileList":e[11]||(e[11]=t=>F.value=t),"list-type":"image-card",max:1,accept:"image/*",disabled:""},{default:u(()=>e[26]||(e[26]=[c(" 点击上传 ")])),_:1},8,["default-file-list"])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),o(I,{"show-form-modal":x.value,"onUpdate:showFormModal":e[17]||(e[17]=t=>x.value=t),"is-async-shut-down":K.value,"onUpdate:isAsyncShutDown":e[18]||(e[18]=t=>K.value=t),"is-show-modal-loading":L.value,"onUpdate:isShowModalLoading":e[19]||(e[19]=t=>L.value=t),"modal-title":p(i)("common.examine"),"modal-form-config":J.value,"form-rules":de,onOnSubmit:ve,onOnClose:_e},{status:u(()=>[o(Oe,{value:v.value,"onUpdate:value":e[15]||(e[15]=t=>v.value=t),name:"radiogroup"},{default:u(()=>[o(Re,null,{default:u(()=>[(ae(),te(je,null,Ge(re,t=>o(De,{key:t.label,value:t.value},{default:u(()=>[c(Ze(t.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["value"])]),remark:u(()=>[le(o(Ie,{value:y.value,"onUpdate:value":e[16]||(e[16]=t=>y.value=t),"allow-input":p(He),placeholder:"请输入不通过原因",clearable:""},null,8,["value","allow-input"]),[[Ke,v.value===2]])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"]),o(I,{"show-form-modal":A.value,"onUpdate:showFormModal":e[20]||(e[20]=t=>A.value=t),"is-async-shut-down":H.value,"onUpdate:isAsyncShutDown":e[21]||(e[21]=t=>H.value=t),"is-show-modal-loading":D.value,"onUpdate:isShowModalLoading":e[22]||(e[22]=t=>D.value=t),"modal-title":p(i)("common.remark"),"modal-form-config":X.value,"form-rules":me,onOnSubmit:ye},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])])}}});export{xa as default};
