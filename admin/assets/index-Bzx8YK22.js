import{_ as H}from"./modal-form.vue_vue_type_script_setup_true_lang-Dy9QZ-_Q.js";import{_ as K}from"./search-header-Bd_P8bYc.js";import{_ as O}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-Dgu6301U.js";import{d as j,r as l,V as q,o as G,b as Q,f as s,w as f,h as r,a1 as h,W,e as o,g as u,t as v,B as X,N as J}from"./index-BBCpP0n1.js";import{i as k}from"./system-manage-DUsqzjl5.js";import{u as Y}from"./custom-table-CJkQvjHs.js";import{u as Z}from"./exportExcel-BAy9H5VN.js";import{_ as ee}from"./Flex-Bs4QGOKB.js";import{_ as te}from"./DataTable-fKfSlOiD.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-jF9EEona.js";import"./custom-upload-DNH0sEWs.js";import"./Grid-DHXffSDg.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-BK_iw_zi.js";import"./Spin-B2L8Uchv.js";import"./DatePicker-CCmjyMFz.js";import"./TimePicker-DO5RqnqW.js";import"./Forward-C99TIi_5.js";import"./RadioGroup-bApoAqR8.js";import"./Space-ClliFbbY.js";const ae={class:"color-gray"},le={class:"mt-2"},oe={class:"color-gray"},ne={class:"mt-2"},se={class:"color-gray"},ie={class:"mt-2"},re={class:"color-gray"},de={class:"mt-2"},ue={class:"color-gray"},w="系统日志列表.xlsx",Le=j({name:"system-manage_system-log",__name:"index",setup(pe){const{pagination:i,renderCell:U}=Y(),{exportExcel:b,exportLoading:n}=Z(),p=l(!1),_=l([]),N=l(),I=l([{type:"Input",valueName:"model_where",label:"表记录ID"},{type:"Input",valueName:"name",label:"操作人"},{type:"Datetime",datetimeType:"datetimerange",valueName:"date",label:"操作时间范围"},{type:"Input",valueName:"model",label:"数据表"},{type:"Select",valueName:"type",label:"操作类型",defaultOption:[{value:0,label:"全部"},{value:1,label:"新增数据"},{value:2,label:"修改数据"},{value:3,label:"删除数据"}]},{type:"Input",valueName:"after",label:"数据内容"}]),y=l(!1),D=l(!0),S=l(!1),d=l({}),E=l([{type:"Slot",valueName:"currentInfo",slotName:"currentInfo"}]);async function m(){p.value=!0;const{data:t}=await k({...N.value,page:i.page,limit:i.pageSize});_.value=t.list,i.itemCount=t.count,p.value=!1}const c=[{type:"selection"},{title:"数据表",key:"model",align:"center",width:"100"},{title:"表记录ID",key:"model_where",align:"center",width:"100"},{title:"IP",key:"last_ip",align:"center",width:"100",render:t=>t.before?t.before.last_ip:""},{title:"地区",key:"area_code",align:"center",width:"100",render:t=>t.before?t.before.area_code:""},{title:"备注",key:"remark",align:"center",width:"100",ellipsis:{tooltip:!0}},{title:"添加时间",key:"create_time",align:"center",width:"100"},{title:"操作",key:"action",align:"center",width:"100",render:t=>s(ee,{justify:"center"},{default:()=>[s(X,{type:"success",size:"small",quaternary:!0,iconPlacement:"right",onClick:()=>{y.value=!0,d.value=t}},{default:()=>[u("查看详情")]})]})}];async function B(){const{data:t}=await k();b({tableColumns:c,tableData:t.list,fileName:w})}const g=l([]),C=l([]);function L(t){N.value=t,i.page=1,m()}function T(t,e){g.value=t,C.value=e}function z(t){i.page=t,m()}function M(t){i.page=1,i.pageSize=t,m()}m();const F=l(c.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const P=O,R=K,A=te,x=J,V=H,$=q("resize");return G(),Q("div",null,[s(x,{title:"系统日志列表"},{"header-extra":f(()=>[s(P,{"export-all-loading":r(n),"onUpdate:exportAllLoading":e[0]||(e[0]=a=>h(n)?n.value=a:null),"refresh-button-loading":p.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=a=>p.value=a),"export-selected-disabled":g.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=a=>g.value.length=a),"batch-delete-disabled":g.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=a=>g.value.length=a),"export-filter-loading":r(n),"onUpdate:exportFilterLoading":e[4]||(e[4]=a=>h(n)?n.value=a:null),"export-selected-loading":r(n),"onUpdate:exportSelectedLoading":e[5]||(e[5]=a=>h(n)?n.value=a:null),"is-add":!1,"is-batch-delete":!1,onExportAll:B,onExportFilter:e[6]||(e[6]=a=>r(b)({tableColumns:c,tableData:_.value,fileName:w})),onExportSelected:e[7]||(e[7]=a=>r(b)({tableColumns:c,tableData:C.value,fileName:w})),onRefresh:m},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:f(()=>[s(R,{"search-config":I.value,onOnSearch:L},null,8,["search-config"]),W(s(A,{remote:"",columns:c,data:_.value,loading:p.value,bordered:!1,style:{height:"560px"},"flex-height":"","scroll-x":F.value,pagination:r(i),"row-key":a=>a.id,"render-cell":r(U),"onUpdate:checkedRowKeys":T,"onUpdate:page":z,"onUpdate:pageSize":M},null,8,["data","loading","scroll-x","pagination","row-key","render-cell"]),[[$]]),s(V,{"show-form-modal":y.value,"onUpdate:showFormModal":e[8]||(e[8]=a=>y.value=a),"is-async-shut-down":D.value,"onUpdate:isAsyncShutDown":e[9]||(e[9]=a=>D.value=a),"is-show-modal-loading":S.value,"onUpdate:isShowModalLoading":e[10]||(e[10]=a=>S.value=a),"modal-title":"操作内容","modal-form-config":E.value,"bottom-visible":!1},{currentInfo:f(()=>[o("div",null,[e[11]||(e[11]=u(" 账号 ")),o("p",ae,v(d.value.user_account),1)]),o("div",le,[e[12]||(e[12]=u(" 用户名 ")),o("p",oe,v(d.value.real_name),1)]),o("div",ne,[e[13]||(e[13]=u(" 数据表 ")),o("p",se,v(d.value.model),1)]),o("div",ie,[e[14]||(e[14]=u(" 操作前 ")),s(x,{class:"mt-2"},{default:f(()=>[o("p",re,v(d.value.before||"暂无"),1)]),_:1})]),o("div",de,[e[15]||(e[15]=u(" 操作后 ")),s(x,{class:"mt-2"},{default:f(()=>[o("p",ue,v(d.value.after),1)]),_:1})])]),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-form-config"])]),_:1})])}}});export{Le as default};
