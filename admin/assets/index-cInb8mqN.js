import{_ as ne}from"./modal-form.vue_vue_type_script_setup_true_lang-BJ69RLGj.js";import{_ as se}from"./search-header-BxwkGrv3.js";import{_ as ue}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-CEWz-Loh.js";import{d as ie,O as re,r as o,V as de,o as pe,b as ce,f as r,w as D,h as d,a1 as M,W as me,$ as T,B as A,g as fe,N as ge,Z as ye}from"./index-DrEzliHY.js";import{s as z,o as ve,t as _e,u as be,v as he}from"./systen-configuration-DdSkwAQ2.js";import{e as xe}from"./money-setting-D2q6Le-o.js";import{s as we}from"./system-configuration-CNHioD-k.js";import{u as ke}from"./custom-table-YBGLKz8r.js";import{u as Ne}from"./exportExcel-DmIPdUnp.js";import{_ as Se}from"./Flex-DkQB4X0g.js";import{_ as Ce}from"./DataTable-BLC5kPHF.js";import{_ as De}from"./Spin-4EGh_M6p.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-CddQKb4h.js";import"./custom-upload-xESAwsug.js";import"./Grid-ppKVTCkg.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-D43XudUj.js";import"./DatePicker-B2ToGdru.js";import"./TimePicker-CbQV1d7H.js";import"./Forward-RZ68qXfC.js";import"./RadioGroup-DfynhpqT.js";import"./Space-B3V6_u3T.js";function Me(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!ye(_)}const U="股市管理列表.xlsx",Ze=ie({name:"system-config_stock-list",__name:"index",setup(_){const{pagination:u,renderCell:B}=ke(),E=re(),{exportExcel:w,exportLoading:i}=Ne(),p=o(!1),g=o([]),k=o("1"),O=o({is_agent:k.value}),R=o([{label:"全部",value:""},{label:"显示",value:"1"},{label:"隐藏",value:"0"}]),N=o([{type:"Input",valueName:"name",label:"名称",placeholder:"请输入名称"},{type:"Input",valueName:"country_name",label:"国家",placeholder:"请输入国家"},{type:"Select",valueName:"status",label:"状态",placeholder:"请选择状态",defaultOption:R.value},{type:"Select",valueName:"market_type",label:"股票类型",placeholder:"请选择股票类型",selectFilter:!0}]),F=o(0),$=o(!1),j=o({}),b=o(!1),L=o(!0),h=o(!1),S=o(!1),m=o([{type:"Input",valueName:"name",label:"名称"},{type:"Input",valueName:"country_name",label:"国家",disabled:!0},{type:"Select",valueName:"money_type_id",label:"币种",selectFilter:!0,disabled:!0},{type:"Switch",valueName:"status",label:"状态",switchCheckedText:"开启",switchUncheckedText:"关闭",disabled:!1},{type:"Select",valueName:"is_default",label:"是否默认",defaultOption:[{value:1,label:"是"},{value:2,label:"否"}]}]),I={name:[{required:!0,message:"请输入名称",trigger:["blur"]}],country_name:[{required:!0,message:"请输入国家",trigger:["blur"]}],money_type_id:[{required:!0,message:"请选择币种",type:"number",trigger:["blur"]}]};async function f(){p.value=!0;const{data:t}=await z();g.value=t.list,u.itemCount=t.count,p.value=!1}async function P(){p.value=!0;const{data:t}=await be({...O.value,page:u.page,limit:u.pageSize});g.value=t.list,u.itemCount=t.count,p.value=!1}async function q(t){var n;F.value=t;const e=(n=g.value.find(s=>s.id===t))==null?void 0:n.is_default,{data:l}=await he(t,{id:k.value});j.value=l,m.value.forEach(s=>{s.defaultValue=l[s.valueName],s.valueName==="status"&&(l[s.valueName]===1?s.defaultValue=!0:s.defaultValue=!1),s.valueName==="is_default"&&(s.defaultValue=e)}),b.value=!0}async function H(){const{data:t}=await ve(),e=t.map(l=>({label:l.name,value:l.id,money_type:l.money_type}));m.value.forEach((l,n)=>{l.valueName==="money_type_id"&&(m.value[n].defaultOption=e)})}H();const y=[{type:"selection"},{title:"名称",key:"name",align:"center",width:"200"},{title:"国家",key:"country_name",align:"center",width:"200"},{title:"货币",key:"money_type",align:"center",width:"200"},{title:"状态",key:"status",align:"center",width:"100",render:t=>t.status===1?"开启":"关闭"},{title:"创建时间",key:"create_time",align:"center",width:"180"},{title:"更新时间",key:"update_time",align:"center",width:"180"},{title:"是否默认股市",key:"is_default",align:"center",width:"130",render:t=>({0:"无",1:"是",2:"否"})[t.is_default]},{title:"操作",key:"action",align:"center",width:300,fixed:"right",render:t=>{let e;return r(Se,{justify:"center"},{default:()=>[r(A,{type:"success",size:"small",onClick:q.bind(null,t.id)},Me(e=T("common.modify"))?e:{default:()=>[e]}),r(A,{type:"success",size:"small",onClick:J.bind(null,t.id)},{default:()=>[fe("更新")]})]})}}];async function K(){var l;const{data:t}=await z(),e=(l=t.list)==null?void 0:l.map(n=>{const s={0:"无",1:"是",2:"否"};return{...n,status:n.status===1?"开启":"关闭",is_default:s[n.is_default]}});w({tableColumns:y,tableData:e??[],fileName:U})}const v=o([]),V=o([]);function G(t){O.value=t,u.page=1,P()}function Q(t,e){v.value=t,V.value=e}function W(){$.value=!0}async function X(t){h.value=!0;const e={};t.up_where&&(e.up_where=t.up_where.join(","));const l=m.value[2].defaultOption?m.value[2].defaultOption:[];let n="";l.forEach(x=>{t.money_type_id===x.value&&(n=x.money_type)});const{response:s}=await _e(F.value,{...t,...e,status:t.status?1:0,is_agent:k.value,money_type:n});s.data.status===200&&(f(),E.success(T("common.modifySuccess")),b.value=!1),h.value=!1}async function Z(){const{data:t}=await xe();N.value.forEach((e,l)=>{e.valueName==="market_type"&&(N.value[l].defaultOption=t.list.map(n=>({label:n.name,value:n.market_type})))})}async function J(t){S.value=!0;const{response:e}=await we({id:t});e.data.status===200&&(f(),E.success("更新成功")),S.value=!1}Z();function Y(t){u.page=t,f()}function ee(t){u.page=1,u.pageSize=t,f()}f();const te=o(y.reduce((t,e)=>Number(t)+Number(e.width),0));return(t,e)=>{const l=ue,n=se,s=Ce,x=ge,ae=ne,le=De,oe=de("resize");return pe(),ce("div",null,[r(le,{show:S.value},{default:D(()=>[r(x,{title:"股市管理"},{"header-extra":D(()=>[r(l,{"export-all-loading":d(i),"onUpdate:exportAllLoading":e[0]||(e[0]=a=>M(i)?i.value=a:null),"refresh-button-loading":p.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=a=>p.value=a),"export-selected-disabled":v.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=a=>v.value.length=a),"batch-delete-disabled":v.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=a=>v.value.length=a),"export-filter-loading":d(i),"onUpdate:exportFilterLoading":e[4]||(e[4]=a=>M(i)?i.value=a:null),"export-selected-loading":d(i),"onUpdate:exportSelectedLoading":e[5]||(e[5]=a=>M(i)?i.value=a:null),"is-batch-delete":!1,"is-add":!1,onExportAll:K,onExportFilter:e[6]||(e[6]=a=>{d(w)({tableColumns:y,tableData:g.value.map(c=>{const C={0:"无",1:"是",2:"否"};return{...c,status:c.status===1?"开启":"关闭",is_default:C[c.is_default]}}),fileName:U})}),onExportSelected:e[7]||(e[7]=a=>{d(w)({tableColumns:y,tableData:V.value.map(c=>{const C={0:"无",1:"是",2:"否"};return{...c,status:c.status===1?"开启":"关闭",is_default:C[c.is_default]}}),fileName:U})}),onAdd:W,onRefresh:f},null,8,["export-all-loading","refresh-button-loading","export-selected-disabled","batch-delete-disabled","export-filter-loading","export-selected-loading"])]),default:D(()=>[r(n,{"search-config":N.value,onOnSearch:G},null,8,["search-config"]),me(r(s,{remote:"",columns:y,data:g.value,loading:p.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":te.value,pagination:d(u),"row-key":a=>a.id,"render-cell":d(B),"onUpdate:checkedRowKeys":Q,"onUpdate:page":Y,"onUpdate:pageSize":ee},null,8,["data","loading","scroll-x","pagination","row-key","render-cell"]),[[oe]])]),_:1}),r(ae,{"show-form-modal":b.value,"onUpdate:showFormModal":e[8]||(e[8]=a=>b.value=a),"is-async-shut-down":L.value,"onUpdate:isAsyncShutDown":e[9]||(e[9]=a=>L.value=a),"is-show-modal-loading":h.value,"onUpdate:isShowModalLoading":e[10]||(e[10]=a=>h.value=a),"modal-title":d(T)("common.modify"),"modal-form-config":m.value,"form-rules":I,onOnSubmit:X},null,8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-title","modal-form-config"])]),_:1},8,["show"])])}}});export{Ze as default};
