import{_ as G}from"./modal-form.vue_vue_type_script_setup_true_lang-BGpCBuuL.js";import{_ as Q}from"./search-header-DKkxeb92.js";import{_ as W}from"./table-header-button-group.vue_vue_type_script_setup_true_lang-Co_MiHfJ.js";import{d as X,r as n,O as Y,f as s,a8 as J,V as Z,o as ee,b as te,w as d,h as N,B as ae,g as le,W as ne,e as oe,N as se,a5 as re}from"./index-BGn2hxht.js";import{i as ie,j as ue}from"./user-manage-DVc1X8GA.js";import{o as $}from"./systen-configuration-D8RMvtUQ.js";import{u as de}from"./custom-table-CkjRR_Ue.js";import{_ as me}from"./Flex-BOUMy5Qd.js";import{_ as pe}from"./DataTable-B20boM9S.js";import"./multi-language-form.vue_vue_type_script_setup_true_lang-BLS00VyW.js";import"./custom-upload-BnYTuu-H.js";import"./Grid-D6W4PgKj.js";import"./get-slot-Bk_rJcZu.js";import"./FormItem-hAQEuGNb.js";import"./Spin-CneC0ahg.js";import"./DatePicker-ByFFtn5f.js";import"./TimePicker-B2GQNCjg.js";import"./Forward-BMPR_CvR.js";import"./RadioGroup-QgSZfQqx.js";import"./Space-AspkDbzB.js";const ze=X({name:"fund-management_fund-list",__name:"index",setup(ce){const{pagination:i,renderCell:O}=de(),c=n(!1),C=n([]),D=n({is_trial:"0"}),h=n([]),m=n({}),z=Y(),b=n([{type:"Input",valueName:"search_key_user",label:"账号/姓名",placeholder:"请输入账号/姓名"},{type:"Input",valueName:"uid",label:"用户ID",placeholder:"请输入用户ID"},{type:"Select",valueName:"is_trial",label:"用户类型",defaultOption:[{value:"0",label:"正式用户"},{value:"1",label:"试玩用户"}]},{type:"Select",valueName:"money_type_id",label:"币种类型"}]),w=n([]),T=n(1e3),k=n(!0),y=n(!1);function B(t){i.page=t,p()}function I(t){i.page=1,i.pageSize=t,p()}const u=n([{title:"用户UID",key:"uid",align:"center",width:100},{title:"账号/姓名",key:"user",align:"center",render:t=>s("div",null,[s("p",null,[t.user.account]),s("p",null,[t.user.real_name])]),width:120},{title:"正式用户",key:"is_trial",align:"center",width:100,render:t=>s(J,{type:t.user.is_trial===1?"error":"success"},{default:()=>[t.user.is_trial===1?"否":"是"]})},{title:"是否隐藏",key:"status",align:"center",render:t=>t.status===1?"否":"是",width:120}]),M=n([{type:"Select",valueName:"pm",label:"操作资金类型",defaultOption:[{value:"1",label:"增加余额"},{value:"2",label:"扣除余额"},{value:"3",label:"彩金增加"}]},{type:"Slot",valueName:"moneyType",slotName:"moneyType",label:"货币类型"},{type:"Input",inputType:"textarea",valueName:"account_list_text",label:"会员信息格式",placeholder:"多个账号请换行。账号|操作金额|备注，如13000000000|100|管理员彩金增加。"},{type:"Slot",valueName:"tips",slotName:"tips",label:"注意"}]),A={pm:[{type:"string",required:!0,message:"请选择操作资金类型",trigger:["blur"]}],moneyType:[{type:"string",required:!0,message:"请选择货币类型",trigger:["blur"],validator:()=>Object.keys(m.value).length===2?!0:new Error("请选择货币类型")}],account_list_text:[{type:"string",required:!0,message:"请输入会员信息",trigger:["blur"]}]},F=n([{type:"Input",inputType:"textarea",valueName:"account_list_text"}]),f=n([]),R=n([]),_=n(!1),x=n(!1);function g(t){const e=new Date(t);let l=e.getMonth()+1;l=l<10?`0${l}`:l;let a=e.getDate();return a=a<10?`0${a}`:a,`${e.getFullYear().toString()}/${l}/${a}`}function L(t){if(t.create_time){const e=g(t.create_time[0]),l=g(t.create_time[1]);t.create_time=`${e}-${l}`}if(t.audit_time){const e=g(t.audit_time[0]),l=g(t.audit_time[1]);t.audit_time=`${e}-${l}`}D.value=t,i.page=1,p()}async function p(){c.value=!0;const{data:t}=await ie({page:i.page,limit:i.pageSize,...D.value}),e=w.value.map(a=>({title:a,key:a,align:"center",width:120,render:r=>r[`${a}`]||0}));u.value=u.value.filter(a=>"key"in a&&String(a.key).includes("balance_")?"title"in a&&typeof a.title=="string"&&w.value.includes(a.title):!0);let l=[...u.value.slice(0,4),...e,...u.value.slice(4)];l=l.filter((a,r,S)=>"title"in a&&S.findIndex(v=>"title"in v&&v.title===a.title)===r),u.value.length=0,u.value.push(...l),T.value=u.value.reduce((a,r)=>Number(a)+Number(r.width),0),C.value=t.list,i.itemCount=t.count,c.value=!1}function P(t,e){f.value=t,R.value=e}function V(t,e){t?(m.value.money_type=e==null?void 0:e.money_type,m.value.money_type_id=e==null?void 0:e.id):(Reflect.deleteProperty(m.value,"money_type"),Reflect.deleteProperty(m.value,"money_type_id"))}async function E(t){y.value=!0;const{response:e}=await ue({...t,...m.value});e.data.status===200&&(Array.isArray(e.data.data)&&e.data.data.length===0?z.success("操作成功"):(F.value[0].defaultValue=e.data.data,x.value=!0),p(),_.value=!1),y.value=!1}async function j(){const{data:t}=await $({status:1}),e=t.sort((l,a)=>l.sort-a.sort);b.value.forEach((l,a)=>{l.valueName==="money_type_id"&&(b.value[a].defaultOption=e.map(r=>(w.value.push(r.money_type),{label:r.name,value:r.id})))}),p()}async function q(){const{data:t}=await $();t.forEach(e=>{e.money_type==="USD"&&h.value.push({id:e.id,name_zh:`${e.name_zh}(${e.name})`,money_type:e.money_type})}),M.value[1].defaultOption=h.value}return j(),q(),(t,e)=>{const l=me,a=W,r=Q,S=pe,v=se,H=re,U=G,K=Z("resize");return ee(),te("div",null,[s(v,{title:"资金列表"},{"header-extra":d(()=>[s(a,{"refresh-button-loading":c.value,"onUpdate:refreshButtonLoading":e[1]||(e[1]=o=>c.value=o),"export-selected-disabled":f.value.length,"onUpdate:exportSelectedDisabled":e[2]||(e[2]=o=>f.value.length=o),"batch-delete-disabled":f.value.length,"onUpdate:batchDeleteDisabled":e[3]||(e[3]=o=>f.value.length=o),"is-export-all":!1,"is-export-filter":!1,"is-export-selected":!1,"is-batch-delete":!1,"is-add":!1,"slot-name":"addButton",onRefresh:p},{addButton:d(()=>[s(l,{justify:"center"},{default:d(()=>[s(N(ae),{type:"success",size:"small",ghost:"",onClick:e[0]||(e[0]=()=>{_.value=!0})},{default:d(()=>e[8]||(e[8]=[le(" 批量资金操作 ")])),_:1})]),_:1})]),_:1},8,["refresh-button-loading","export-selected-disabled","batch-delete-disabled"])]),default:d(()=>[s(r,{"search-config":b.value,onOnSearch:L},null,8,["search-config"]),ne(s(S,{remote:"",columns:u.value,data:C.value,pagination:N(i),loading:c.value,bordered:!1,style:{height:"620px"},"flex-height":"","scroll-x":T.value,"row-key":o=>o.id,"render-cell":N(O),"onUpdate:checkedRowKeys":P,"onUpdate:page":B,"onUpdate:pageSize":I},null,8,["columns","data","pagination","loading","scroll-x","row-key","render-cell"]),[[K]])]),_:1}),s(U,{"show-form-modal":_.value,"onUpdate:showFormModal":e[4]||(e[4]=o=>_.value=o),"is-async-shut-down":k.value,"onUpdate:isAsyncShutDown":e[5]||(e[5]=o=>k.value=o),"is-show-modal-loading":y.value,"onUpdate:isShowModalLoading":e[6]||(e[6]=o=>y.value=o),"modal-title":"批量资金操作","modal-form-config":M.value,"form-rules":A,onOnSubmit:E},{moneyType:d(()=>[s(H,{"label-field":"name_zh","value-field":"id",filterable:"",clearable:"",options:h.value,"onUpdate:value":V},null,8,["options"])]),tips:d(()=>e[9]||(e[9]=[oe("div",{class:"color-red"},"账号|操作金额|备注。如13000000000|100|管理员彩金增加。",-1)])),_:1},8,["show-form-modal","is-async-shut-down","is-show-modal-loading","modal-form-config"]),s(U,{"show-form-modal":x.value,"onUpdate:showFormModal":e[7]||(e[7]=o=>x.value=o),"modal-title":"操作账号异常记录","modal-form-config":F.value},null,8,["show-form-modal","modal-form-config"])])}}});export{ze as default};
